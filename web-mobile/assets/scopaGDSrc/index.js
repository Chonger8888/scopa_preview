window.__require=function t(e,a,o){function i(n,s){if(!a[n]){if(!e[n]){var c=n.split("/");if(c=c[c.length-1],!e[c]){var d="function"==typeof __require&&__require;if(!s&&d)return d(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+n+"'")}n=c}var l=a[n]={exports:{}};e[n][0].call(l.exports,function(t){return i(e[n][1][t]||t)},l,l.exports,t,e,a,o)}return a[n].exports}for(var r="function"==typeof __require&&__require,n=0;n<o.length;n++)i(o[n]);return i}({CMD_ScopaMsgDefine:[function(t,e,a){"use strict";cc._RF.push(e,"bc4bcm9rdpPt6SIMa2hFwNt","CMD_ScopaMsgDefine"),Object.defineProperty(a,"__esModule",{value:!0}),a.SCOPA_GAME_STATUS=a.SCOPA_ACTION_TYPE=a.SCOPA_SETTLE_GOLD_TYPE=a.SCOPA_CONST=a.MESSAGE_CS_SCOPA_SUB_ID=a.MESSAGE_SC_SCOPA_SUB_ID=a.LOGIC_MAIN_MSG=a.MSG_CS_SCOPA_UserEat=a.MSG_CS_SCOPA_UserPlay=a.MSG_SC_SCOPA_GamePlay=a.MSG_SCOPAUserGameInfo=a.MSG_SC_SCOPA_GameResult=a.MSG_SCOPAUserSettleInfo=a.MSG_SC_SCOPA_GetSurplusCard=a.MSG_SC_SCOPA_EatCardList=a.MSG_SC_SCOPA_OPResult=a.MSG_SC_SCOPA_PlayResult=a.MSG_SC_SCOPA_InformUserOP=a.MSG_CARDS=a.MSG_SC_SCOPA_SendHandCard=a.MSG_SC_SCOPA_GameStartData=void 0;var o=function(){function t(){this.dwCardNum=0}return t.encode=function(t,e){return void 0===e&&(e=protobuf.Writer.create()),null!=t.dwCardNum&&e.uint32(8).uint32(t.dwCardNum),e},t.decode=function(e,a){for(var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwCardNum=o.uint32();break;default:o.skipType(7&s)}}return r},t}();a.MSG_SC_SCOPA_GameStartData=o;var i=function(){function t(){this.dwChairID=0,this.dwCardNum=0,this.dwCardData=protobuf.util.emptyArray,this.dwTableCardNum=0,this.dwTableCardData=protobuf.util.emptyArray,this.dwSurplusNum=0}return t.encode=function(t,e){if(void 0===e&&(e=protobuf.Writer.create()),null!=t.dwChairID&&e.uint32(8).uint32(t.dwChairID),null!=t.dwCardNum&&e.uint32(16).uint32(t.dwCardNum),void 0!==t.dwCardData&&t.dwCardData.length)for(var a=0,o=t.dwCardData;a<o.length;a++){var i=o[a];e.uint32(24).uint32(i)}if(null!=t.dwTableCardNum&&e.uint32(32).uint32(t.dwTableCardNum),void 0!==t.dwTableCardData&&t.dwTableCardData.length)for(var r=0,n=t.dwTableCardData;r<n.length;r++)i=n[r],e.uint32(40).uint32(i);return null!=t.dwSurplusNum&&e.uint32(48).uint32(t.dwSurplusNum),e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;for(r.dwCardData=[],r.dwTableCardData=[];o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwChairID=o.uint32();break;case 2:r.dwCardNum=o.uint32();break;case 3:if(2==(7&s))for(var c=o.uint32()+o.pos;o.pos<c;)r.dwCardData.push(o.uint32());else r.dwCardData.push(o.uint32());break;case 4:r.dwTableCardNum=o.uint32();break;case 5:if(2==(7&s))for(c=o.uint32()+o.pos;o.pos<c;)r.dwTableCardData.push(o.uint32());else r.dwTableCardData.push(o.uint32());break;case 6:r.dwSurplusNum=o.uint32();break;default:o.skipType(7&s)}}return r},t}();a.MSG_SC_SCOPA_SendHandCard=i;var r=function(){function t(){this.dwCardNum=0,this.dwCardData=protobuf.util.emptyArray}return t.encode=function(t,e){if(void 0===e&&(e=protobuf.Writer.create()),null!=t.dwCardNum&&e.uint32(8).uint32(t.dwCardNum),void 0!==t.dwCardData&&t.dwCardData.length)for(var a=0,o=t.dwCardData;a<o.length;a++){var i=o[a];e.uint32(16).uint32(i)}return e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;for(r.dwCardData=[];o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwCardNum=o.uint32();break;case 2:if(2==(7&s))for(var c=o.uint32()+o.pos;o.pos<c;)r.dwCardData.push(o.uint32());else r.dwCardData.push(o.uint32());break;default:o.skipType(7&s)}}return r},t}();a.MSG_CARDS=r;var n=function(){function t(){this.dwChairID=0,this.dwOppTime=0}return t.encode=function(t,e){return void 0===e&&(e=protobuf.Writer.create()),null!=t.dwChairID&&e.uint32(8).uint32(t.dwChairID),null!=t.dwOppTime&&e.uint32(16).uint32(t.dwOppTime),e},t.decode=function(e,a){for(var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwChairID=o.uint32();break;case 2:r.dwOppTime=o.uint32();break;default:o.skipType(7&s)}}return r},t}();a.MSG_SC_SCOPA_InformUserOP=n;var s=function(){function t(){this.dwError=0,this.dwChairID=0,this.dwOutCard=0,this.dwGetCardData=protobuf.util.emptyArray}return t.encode=function(t,e){if(void 0===e&&(e=protobuf.Writer.create()),null!=t.dwError&&e.uint32(8).uint32(t.dwError),null!=t.dwChairID&&e.uint32(16).uint32(t.dwChairID),null!=t.dwOutCard&&e.uint32(24).uint32(t.dwOutCard),void 0!==t.dwGetCardData&&t.dwGetCardData.length)for(var a=0,o=t.dwGetCardData;a<o.length;a++){var i=o[a];e.uint32(32).uint32(i)}return e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;for(r.dwGetCardData=[];o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwError=o.uint32();break;case 2:r.dwChairID=o.uint32();break;case 3:r.dwOutCard=o.uint32();break;case 4:if(2==(7&s))for(var c=o.uint32()+o.pos;o.pos<c;)r.dwGetCardData.push(o.uint32());else r.dwGetCardData.push(o.uint32());break;default:o.skipType(7&s)}}return r},t}();a.MSG_SC_SCOPA_PlayResult=s;var c=function(){function t(){this.dwChairID=0,this.dwOutCard=0,this.dwGetCardData=protobuf.util.emptyArray,this.bScopa=!1,this.dwMultiplyNum=0}return t.encode=function(t,e){if(void 0===e&&(e=protobuf.Writer.create()),null!=t.dwChairID&&e.uint32(8).uint32(t.dwChairID),null!=t.dwOutCard&&e.uint32(16).uint32(t.dwOutCard),void 0!==t.dwGetCardData&&t.dwGetCardData.length)for(var a=0,o=t.dwGetCardData;a<o.length;a++){var i=o[a];e.uint32(24).uint32(i)}return null!=t.bScopa&&e.uint32(32).bool(t.bScopa),null!=t.dwMultiplyNum&&e.uint32(40).uint32(t.dwMultiplyNum),e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;for(r.dwGetCardData=[];o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwChairID=o.uint32();break;case 2:r.dwOutCard=o.uint32();break;case 3:if(2==(7&s))for(var c=o.uint32()+o.pos;o.pos<c;)r.dwGetCardData.push(o.uint32());else r.dwGetCardData.push(o.uint32());break;case 4:r.bScopa=o.bool();break;case 5:r.dwMultiplyNum=o.uint32();break;default:o.skipType(7&s)}}return r},t}();a.MSG_SC_SCOPA_OPResult=c;var d=function(){function t(){this.dwOutCard=0,this.dwEatCardData=void 0}return t.encode=function(t,e){void 0===e&&(e=protobuf.Writer.create()),null!=t.dwOutCard&&e.uint32(8).uint32(t.dwOutCard);for(var a=0,o=t.dwEatCardData;a<o.length;a++){var i=o[a];null!=i&&r.encode(i,e.uint32(18).fork()).ldelim()}return e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,n=new t,s=!1;for(n.dwEatCardData=[];o.pos<i&&!s;){var c=o.uint32();switch(c>>>3){case 0:s=!0;break;case 1:n.dwOutCard=o.uint32();break;case 2:n.dwEatCardData.push(r.decode(o,o.uint32()));break;default:o.skipType(7&c)}}return n},t}();a.MSG_SC_SCOPA_EatCardList=d;var l=function(){function t(){this.dwChairID=0,this.dwCardData=protobuf.util.emptyArray}return t.encode=function(t,e){if(void 0===e&&(e=protobuf.Writer.create()),null!=t.dwChairID&&e.uint32(8).uint32(t.dwChairID),void 0!==t.dwCardData&&t.dwCardData.length)for(var a=0,o=t.dwCardData;a<o.length;a++){var i=o[a];e.uint32(16).uint32(i)}return e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;for(r.dwCardData=[];o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwChairID=o.uint32();break;case 2:if(2==(7&s))for(var c=o.uint32()+o.pos;o.pos<c;)r.dwCardData.push(o.uint32());else r.dwCardData.push(o.uint32());break;default:o.skipType(7&s)}}return r},t}();a.MSG_SC_SCOPA_GetSurplusCard=l;var p=function(){function t(){this.dwChairID=0,this.dwGold=0,this.dwScore=0,this.dwCardnum=0,this.dwColorFen=0,this.bHaveCoins7=!1,this.dwCoinsNum=0,this.dwScopaNum=0,this.dwCardData=protobuf.util.emptyArray,this.bPC=!1,this.dwCupNum=0,this.dwExpLevel=0}return t.encode=function(t,e){if(void 0===e&&(e=protobuf.Writer.create()),null!=t.dwChairID&&e.uint32(8).uint32(t.dwChairID),null!=t.dwGold&&e.uint32(16).int32(t.dwGold),null!=t.dwScore&&e.uint32(24).uint32(t.dwScore),null!=t.dwCardnum&&e.uint32(32).uint32(t.dwCardnum),null!=t.dwColorFen&&e.uint32(40).uint32(t.dwColorFen),null!=t.bHaveCoins7&&e.uint32(48).bool(t.bHaveCoins7),null!=t.dwCoinsNum&&e.uint32(56).uint32(t.dwCoinsNum),null!=t.dwScopaNum&&e.uint32(64).uint32(t.dwScopaNum),void 0!==t.dwCardData&&t.dwCardData.length)for(var a=0,o=t.dwCardData;a<o.length;a++){var i=o[a];e.uint32(72).uint32(i)}return null!=t.bPC&&e.uint32(80).bool(t.bPC),null!=t.dwCupNum&&e.uint32(88).uint32(t.dwCupNum),null!=t.dwExpLevel&&e.uint32(96).uint32(t.dwExpLevel),e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;for(r.dwCardData=[];o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwChairID=o.uint32();break;case 2:r.dwGold=o.int32();break;case 3:r.dwScore=o.uint32();break;case 4:r.dwCardnum=o.uint32();break;case 5:r.dwColorFen=o.uint32();break;case 6:r.bHaveCoins7=o.bool();break;case 7:r.dwCoinsNum=o.uint32();break;case 8:r.dwScopaNum=o.uint32();break;case 9:if(2==(7&s))for(var c=o.uint32()+o.pos;o.pos<c;)r.dwCardData.push(o.uint32());else r.dwCardData.push(o.uint32());break;case 10:r.bPC=o.bool();break;case 11:r.dwCupNum=o.uint32();break;case 12:r.dwExpLevel=o.uint32();break;default:o.skipType(7&s)}}return r},t}();a.MSG_SCOPAUserSettleInfo=p;var h=function(){function t(){this.dwWinnerChairID=0,this.dwRematchTime=0,this.tabUserSettleInfoList=void 0,this.dwMultiplyNum=0,this.dwCappingChairID=0}return t.encode=function(t,e){void 0===e&&(e=protobuf.Writer.create()),null!=t.dwWinnerChairID&&e.uint32(8).uint32(t.dwWinnerChairID),null!=t.dwRematchTime&&e.uint32(16).uint32(t.dwRematchTime);for(var a=0,o=t.tabUserSettleInfoList;a<o.length;a++){var i=o[a];null!=i&&p.encode(i,e.uint32(26).fork()).ldelim()}return null!=t.dwMultiplyNum&&e.uint32(32).uint32(t.dwMultiplyNum),null!=t.dwCappingChairID&&e.uint32(40).uint32(t.dwCappingChairID),e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;for(r.tabUserSettleInfoList=[];o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwWinnerChairID=o.uint32();break;case 2:r.dwRematchTime=o.uint32();break;case 3:r.tabUserSettleInfoList.push(p.decode(o,o.uint32()));break;case 4:r.dwMultiplyNum=o.uint32();break;case 5:r.dwCappingChairID=o.uint32();break;default:o.skipType(7&s)}}return r},t}();a.MSG_SC_SCOPA_GameResult=h;var u=function(){function t(){this.dwChairID=0,this.dwScopaNum=0,this.dwScopaData=protobuf.util.emptyArray,this.dwGetCardNum=0,this.dwGetCardData=protobuf.util.emptyArray,this.bHaveCoins7=!1,this.dwCardnum=0,this.tabHandCardData=protobuf.util.emptyArray}return t.encode=function(t,e){if(void 0===e&&(e=protobuf.Writer.create()),null!=t.dwChairID&&e.uint32(8).uint32(t.dwChairID),null!=t.dwScopaNum&&e.uint32(16).uint32(t.dwScopaNum),void 0!==t.dwScopaData&&t.dwScopaData.length)for(var a=0,o=t.dwScopaData;a<o.length;a++){var i=o[a];e.uint32(24).uint32(i)}if(null!=t.dwGetCardNum&&e.uint32(32).uint32(t.dwGetCardNum),void 0!==t.dwGetCardData&&t.dwGetCardData.length)for(var r=0,n=t.dwGetCardData;r<n.length;r++)i=n[r],e.uint32(40).uint32(i);if(null!=t.bHaveCoins7&&e.uint32(48).bool(t.bHaveCoins7),null!=t.dwCardnum&&e.uint32(56).uint32(t.dwCardnum),void 0!==t.tabHandCardData&&t.tabHandCardData.length)for(var s=0,c=t.tabHandCardData;s<c.length;s++)i=c[s],e.uint32(64).uint32(i);return e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;for(r.dwScopaData=[],r.dwGetCardData=[],r.tabHandCardData=[];o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwChairID=o.uint32();break;case 2:r.dwScopaNum=o.uint32();break;case 3:if(2==(7&s))for(var c=o.uint32()+o.pos;o.pos<c;)r.dwScopaData.push(o.uint32());else r.dwScopaData.push(o.uint32());break;case 4:r.dwGetCardNum=o.uint32();break;case 5:if(2==(7&s))for(c=o.uint32()+o.pos;o.pos<c;)r.dwGetCardData.push(o.uint32());else r.dwGetCardData.push(o.uint32());break;case 6:r.bHaveCoins7=o.bool();break;case 7:r.dwCardnum=o.uint32();break;case 8:if(2==(7&s))for(c=o.uint32()+o.pos;o.pos<c;)r.tabHandCardData.push(o.uint32());else r.tabHandCardData.push(o.uint32());break;default:o.skipType(7&s)}}return r},t}();a.MSG_SCOPAUserGameInfo=u;var C=function(){function t(){this.dwCurrentChairID=0,this.dwOppTime=0,this.dwCardnum=0,this.dwCardData=protobuf.util.emptyArray,this.dwSurplusNum=0,this.tabUserGameInfoList=void 0,this.dwMultiplyNum=0}return t.encode=function(t,e){if(void 0===e&&(e=protobuf.Writer.create()),null!=t.dwCurrentChairID&&e.uint32(8).uint32(t.dwCurrentChairID),null!=t.dwOppTime&&e.uint32(16).uint32(t.dwOppTime),null!=t.dwCardnum&&e.uint32(24).uint32(t.dwCardnum),void 0!==t.dwCardData&&t.dwCardData.length)for(var a=0,o=t.dwCardData;a<o.length;a++){var i=o[a];e.uint32(32).uint32(i)}null!=t.dwSurplusNum&&e.uint32(40).uint32(t.dwSurplusNum);for(var r=0,n=t.tabUserGameInfoList;r<n.length;r++)null!=(i=n[r])&&u.encode(i,e.uint32(50).fork()).ldelim();return null!=t.dwMultiplyNum&&e.uint32(56).uint32(t.dwMultiplyNum),e},t.decode=function(e,a){var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;for(r.dwCardData=[],r.tabUserGameInfoList=[];o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwCurrentChairID=o.uint32();break;case 2:r.dwOppTime=o.uint32();break;case 3:r.dwCardnum=o.uint32();break;case 4:if(2==(7&s))for(var c=o.uint32()+o.pos;o.pos<c;)r.dwCardData.push(o.uint32());else r.dwCardData.push(o.uint32());break;case 5:r.dwSurplusNum=o.uint32();break;case 6:r.tabUserGameInfoList.push(u.decode(o,o.uint32()));break;case 7:r.dwMultiplyNum=o.uint32();break;default:o.skipType(7&s)}}return r},t}();a.MSG_SC_SCOPA_GamePlay=C;var f=function(){function t(){this.dwChairID=0,this.dwOutCard=0}return t.encode=function(t,e){return void 0===e&&(e=protobuf.Writer.create()),null!=t.dwChairID&&e.uint32(8).uint32(t.dwChairID),null!=t.dwOutCard&&e.uint32(16).uint32(t.dwOutCard),e},t.decode=function(e,a){for(var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwChairID=o.uint32();break;case 2:r.dwOutCard=o.uint32();break;default:o.skipType(7&s)}}return r},t}();a.MSG_CS_SCOPA_UserPlay=f;var y=function(){function t(){this.dwChairID=0,this.dwOutCard=0,this.chEatCardData=protobuf.util.newBuffer([])}return t.encode=function(t,e){return void 0===e&&(e=protobuf.Writer.create()),null!=t.dwChairID&&e.uint32(8).uint32(t.dwChairID),null!=t.dwOutCard&&e.uint32(16).uint32(t.dwOutCard),null!=t.chEatCardData&&e.uint32(26).bytes(t.chEatCardData),e},t.decode=function(e,a){for(var o=e instanceof Uint8Array?new protobuf.Reader(e):e,i=void 0===a?o.len:o.pos+a,r=new t,n=!1;o.pos<i&&!n;){var s=o.uint32();switch(s>>>3){case 0:n=!0;break;case 1:r.dwChairID=o.uint32();break;case 2:r.dwOutCard=o.uint32();break;case 3:r.chEatCardData=o.bytes();break;default:o.skipType(7&s)}}return r},t}();a.MSG_CS_SCOPA_UserEat=y,a.LOGIC_MAIN_MSG={MSG_GAMELOGIC_MAIN_ID:0,UNRECOGNIZED:-1},a.MESSAGE_SC_SCOPA_SUB_ID={MSGID_SC_SCOPA_GAME_START_DATA:1e3,MSGID_SC_SCOPA_SEND_HAND_CARD:1001,MSGID_SC_SCOPA_GAME_RESET_CARD:1002,MSGID_SC_SCOPA_INFORM_USEROP:1003,MSGID_SC_SCOPA_PLAY_RESULT:1004,MSGID_SC_SCOPA_OP_RESULT:1005,MSGID_SC_SCOPA_EATCARD_LIST:1006,MSGID_SC_SCOPA_GET_SURPLUS_CARD:1007,MSGID_SC_SCOPA_GAME_RESULT:1008,MSGID_SC_SCOPA_GAMESCENCE_PLAY:1009,MSGID_SC_SCOPA_GAMESCENCE_FREE:1010,UNRECOGNIZED:-1},a.MESSAGE_CS_SCOPA_SUB_ID={MSGID_CS_SCOPA_USER_PLAY:2001,MSGID_CS_SCOPA_USER_EAT:2002,UNRECOGNIZED:-1},a.SCOPA_CONST={SCOPA_GAME_PLAYER:2,SCOPA_SEND_TABLE_CARD_COUNT:4,SCOPA_SEND_HAND_CARD_COUNT:3,SCOPA_PLAY_ALL_ROUND:6,SCOPA_CARD_NUM:40,UNRECOGNIZED:-1},a.SCOPA_SETTLE_GOLD_TYPE={SCOPA_FIXATION_TYPE:1,SCOPA_D_VALUE_TYPE:2,UNRECOGNIZED:-1},a.SCOPA_ACTION_TYPE={MSG_SCOPA_ACTION_OUTCARD:1,MSG_SCOPA_ACTION_GETCARD:2,UNRECOGNIZED:-1},a.SCOPA_GAME_STATUS={MSG_SCOPA_GAME_STATUS_FREE:1,MSG_SCOPA_GAME_STATUS_SEND_CARD:2,MSG_SCOPA_GAME_STATUS_OUT_CARD:3,UNRECOGNIZED:-1},cc._RF.pop()},{}],ScopaGDFlow:[function(t,e,a){"use strict";cc._RF.push(e,"a59e5GWWKZHOYUjggqt0xqe","ScopaGDFlow");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(a,"__esModule",{value:!0}),a.ScopaGDFlow=void 0;var r=t("./../../../script/app/module/tables/TableSkinMgr"),n=t("./../../../script/lib/utils/ComUtils"),s=t("../../gameBaseSrc/controller/goldGame/BaseGoldGameFlow"),c=t("../../gameBaseSrc/model/GameEvent"),d=t("../../gameBaseSrc/model/ScopaConstant"),l=t("../../../script/app/const/AudioFile"),p=t("../../../script/app/event/Notify"),h=t("../../../script/app/const/game/GameConstant"),u=t("../../../script/app/model/AdDataProxy"),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.addSendCardFlow=function(t){this.taskFlow.addTask(this.processSendCard,this,t),this.taskFlow.addTask(this.processSendCardEnd,this)},e.prototype.processSendCardEnd=function(){return this.dispatch(c.GameEvent.Desk.REMAIN_CARD_NUM_CHANGE,this.logicHander.getPlayData().curCardStackNum),500},e.prototype.handleScopa=function(t,e,a){this.dispatch(c.GameEvent.GameTips.SCOPA,{playScopa:!0,beishu:e,tableId:a}),1==t?this.dispatch(p.Notify.Base.PLAY_EFFECT,{path:l.AudioFile.Game.SCOPA_1}):2==t?this.dispatch(p.Notify.Base.PLAY_EFFECT,{path:l.AudioFile.Game.SCOPA_2}):this.dispatch(p.Notify.Base.PLAY_EFFECT,{path:l.AudioFile.Game.SCOPA_3})},e.prototype.addSettebelloFlow=function(){this.taskFlow.addTask(this.processSettebello,this)},e.prototype.processSettebello=function(){return this.dispatch(c.GameEvent.Popup.SETTEBELLO,{settebello:!0}),833.3},e.prototype.addInformOpFlow=function(){var t=this.logicHander.getPlayData(),e={curOpViewId:t.curOperateViewId,remainTime:t.curOpRemainTime,maxTime:t.opTimeMax,bRun:!0};this.taskFlow.addTask(this.processInformOp,this,e)},e.prototype.processInformOp=function(t){return this.dispatch(c.GameEvent.HandCard.INFORM_PLAYER_OP,{curOperateViewId:t.curOpViewId}),this.dispatch(c.GameEvent.Player.SET_TIMER,{viewId:t.curOpViewId,remainTime:t.remainTime,maxTime:t.maxTime,bRun:!0}),0},e.prototype.addOutCardFlow=function(){var t=this.logicHander.getPlayData(),e=t.curProvideViewId,a={viewId:t.curProvideViewId,outCardData:t.curProvideCard,handCardDatas:t.allHandCardDatas[e],throwCardIndex:t.throwCardIndex};this.taskFlow.addTask(this.processOutCard,this,a)},e.prototype.processOutCard=function(t){return this.dispatch(c.GameEvent.HandCard.PLAYER_OUT_CARD_RESULT,t),0===t.viewId?1e3*(d.ScopaConstant.UP_OUT_CARD_TIME+d.ScopaConstant.THROW_OUT_CARD_TIME):1e3*d.ScopaConstant.THROW_OUT_CARD_TIME},e.prototype.addEatCardFlow=function(t,e){void 0===e&&(e=0),this.taskFlow.addTask(this.processDelayTime,this,e),this.taskFlow.addTask(this.processRmEatCards,this,n.ComUtils.clone(t)),this.taskFlow.addTask(this.processAddEatCards,this,n.ComUtils.clone(t))},e.prototype.processRmEatCards=function(t){var e=this.logicHander.getPlayData();this.dispatch(c.GameEvent.OutCard.UPDATE_DATA,e.outCardDatas),this.dispatch(c.GameEvent.OutCard.DELELE_EAT_CARDS,t);var a=r.TableSkinMgr.getTableId();return t.bScopa&&(this.handleScopa(e.playerScopaCount[e.curOperateViewId],t.iMultpNum,a),this.dispatch(c.GameEvent.Desk.BEI_SHU_CHANGE,t)),t.bSettebello&&(this.dispatch(c.GameEvent.Popup.SETTEBELLO,{settebello:!0,bScopa:t.bScopa,tableId:a}),this.dispatch(p.Notify.Base.PLAY_EFFECT,{path:l.AudioFile.Game.SETTEBELLO})),1e3*(t.delayTime+d.ScopaConstant.EAT_CARD_RUN_TIME)||0},e.prototype.processAddEatCards=function(t){return this.dispatch(c.GameEvent.EatCard.MOVE_TO_DESK,t),0},e.prototype.processUpdateEatCard=function(){var t=this.logicHander.getPlayData();return this.dispatch(c.GameEvent.EatCard.SCENE_PLAYING,t.getEatCardInfo()),0},e.prototype.addEatSurplusCardFlow=function(t){t.bSurplus=!0,this.taskFlow.addTask(this.processRmSurplusCards,this,t),this.taskFlow.addTask(this.processAddEatCards,this,t)},e.prototype.processRmSurplusCards=function(t){return this.dispatch(c.GameEvent.OutCard.DELELE_EAT_CARDS,t),t.bSettebello&&(this.dispatch(c.GameEvent.Popup.SETTEBELLO,{settebello:!0,bScopa:!1}),this.dispatch(p.Notify.Base.PLAY_EFFECT,{path:l.AudioFile.Game.SETTEBELLO})),1e3*d.ScopaConstant.EAT_CARD_RUN_TIME},e.prototype.addGameEndFlow=function(){this.taskFlow.clear(),this.taskFlow.addTask(this.processBeforeShowResultView,this),this.taskFlow.addTask(this.processShowAllEatCard,this),this.taskFlow.addTask(this.processScreenShot,this),this.taskFlow.addTask(this.processShowGameResult,this),this.taskFlow.addTask(this.processAfterShowResultView,this)},e.prototype.processShowAllEatCard=function(){var t=this.logicHander.getPlayData();return this.dispatch(c.GameEvent.OutCard.SHOW_EAT_CARDS,t.getAllEatCards()),1280},e.prototype.processScreenShot=function(){return this.dispatch(p.Notify.Base.REQ_SCREEN_SHOT,h.GameConstant.RoomPlayStatus.gameEnd),500},e.prototype.processShowGameResult=function(){var t=this.logicHander.getPlayData();return this.dispatch(c.GameEvent.Popup.GAME_ONCE_RESULT,t.curResult),this.dispatch(p.Notify.AD.SHOW_BANNER,u.BannerType.SETTLE),this.dispatch(p.Notify.AD.OPEN_CP_GG,u.ChaPingType.GAME_SETTLE),3e3},e.prototype.addResetCardFlow=function(){this.taskFlow.addTask(this.processResetCards,this)},e.prototype.processResetCards=function(){return this.dispatch(c.GameEvent.Com.REDEAL_CARD),this.dispatch(c.GameEvent.GameTips.REDEAL),1230},e}(s.BaseGoldGameFlow);a.ScopaGDFlow=C,cc._RF.pop()},{"../../../script/app/const/AudioFile":void 0,"../../../script/app/const/game/GameConstant":void 0,"../../../script/app/event/Notify":void 0,"../../../script/app/model/AdDataProxy":void 0,"../../gameBaseSrc/controller/goldGame/BaseGoldGameFlow":void 0,"../../gameBaseSrc/model/GameEvent":void 0,"../../gameBaseSrc/model/ScopaConstant":void 0,"./../../../script/app/module/tables/TableSkinMgr":void 0,"./../../../script/lib/utils/ComUtils":void 0}],ScopaGDGameMsg:[function(t,e,a){"use strict";cc._RF.push(e,"e9888vJXgdEWJ+k8nzyCKoq","ScopaGDGameMsg");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(a,"__esModule",{value:!0}),a.ScopaGDGameMsg=void 0;var r=t("./CMD_ScopaMsgDefine"),n=t("../../../script/plugin/pb/protofile/GlobalMsgDef"),s=t("../../gameBaseSrc/model/goldGame/CMD_GameMsg"),c=t("../../../script/lib/network/struct/StructProtocol"),d=t("../../../script/lib/external/ByteArray");(function(t){t.logicMainId=r.LOGIC_MAIN_MSG.MSG_GAMELOGIC_MAIN_ID,t.gameMainId=n.MAIN_MSG_ID.MAIN_MSG_GAME_MSG_ID;var e=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t),this.data=r.MSG_SC_SCOPA_GameStartData.decode(t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GAME_START_DATA,a}(c.StructProtocol);t.MSG_SC_SCOPA_GameStartData=e;var a=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t),this.data=r.MSG_SC_SCOPA_SendHandCard.decode(t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_SEND_HAND_CARD,a}(c.StructProtocol);t.MSG_SC_SCOPA_SendHandCard=a;var o=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GAME_RESET_CARD,a}(c.StructProtocol);t.MSG_SC_SCOPA_ResetCard=o;var l=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t),this.data=r.MSG_SC_SCOPA_InformUserOP.decode(t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_INFORM_USEROP,a}(c.StructProtocol);t.MSG_SC_SCOPA_InformUserOP=l;var p=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t),this.data=r.MSG_SC_SCOPA_PlayResult.decode(t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_PLAY_RESULT,a}(c.StructProtocol);t.MSG_SC_SCOPA_OutResult=p;var h=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t),this.data=r.MSG_SC_SCOPA_OPResult.decode(t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_OP_RESULT,a}(c.StructProtocol);t.MSG_SC_SCOPA_OPResult=h;var u=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t),this.data=r.MSG_SC_SCOPA_EatCardList.decode(t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_EATCARD_LIST,a}(c.StructProtocol);t.MSG_SC_SCOPA_EatCardList=u;var C=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t),this.data=r.MSG_SC_SCOPA_GetSurplusCard.decode(t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GET_SURPLUS_CARD,a}(c.StructProtocol);t.MSG_SC_SCOPA_GetSurplusCard=C;var f=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t),this.data=r.MSG_SC_SCOPA_GameResult.decode(t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GAME_RESULT,a}(c.StructProtocol);t.MSG_SC_SCOPA_GameResult=f;var y=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.decodeRaw=function(t){e.prototype.decodeRaw.call(this,t),this.data=r.MSG_SC_SCOPA_GamePlay.decode(t)},a.ProtocolId=t.logicMainId+"-"+r.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GAMESCENCE_PLAY,a}(c.StructProtocol);t.MSG_SC_SCOPA_GamePlay=y;var S=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.encode=function(){var t=e.prototype.encode.call(this),a=r.MSG_CS_SCOPA_UserPlay.encode(this.data).finish();return null!=this.head&&(this.head.byGameData=a,this.head.dwSubID=r.MESSAGE_CS_SCOPA_SUB_ID.MSGID_CS_SCOPA_USER_PLAY,a=s.MSG_CS_GameData.encode(this.head).finish()),null!=this.head1&&(this.head1.byGameData=a,a=n.Msg_GameHead.encode(this.head1).finish()),t.writeBytes(new d.ByteArray(a)),t},a.ProtocolId=t.gameMainId+"-"+s.GAME_SUB_MSG.MSGID_SCS_DESK_GAMEDATA,a}(c.StructProtocol);t.MSG_CS_SCOPA_UserPlay=S;var v=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return i(a,e),a.prototype.getID=function(){return a.ProtocolId},a.prototype.encode=function(){var t=e.prototype.encode.call(this),a=r.MSG_CS_SCOPA_UserEat.encode(this.data).finish();return null!=this.head&&(this.head.byGameData=a,this.head.dwSubID=r.MESSAGE_CS_SCOPA_SUB_ID.MSGID_CS_SCOPA_USER_EAT,a=s.MSG_CS_GameData.encode(this.head).finish()),null!=this.head1&&(this.head1.byGameData=a,a=n.Msg_GameHead.encode(this.head1).finish()),t.writeBytes(new d.ByteArray(a)),t},a.ProtocolId=t.gameMainId+"-"+s.GAME_SUB_MSG.MSGID_SCS_DESK_GAMEDATA,a}(c.StructProtocol);t.MSG_CS_SCOPA_UserEat=v})(a.ScopaGDGameMsg||(a.ScopaGDGameMsg={})),cc._RF.pop()},{"../../../script/lib/external/ByteArray":void 0,"../../../script/lib/network/struct/StructProtocol":void 0,"../../../script/plugin/pb/protofile/GlobalMsgDef":void 0,"../../gameBaseSrc/model/goldGame/CMD_GameMsg":void 0,"./CMD_ScopaMsgDefine":"CMD_ScopaMsgDefine"}],ScopaGDLogicHandler:[function(t,e,a){"use strict";cc._RF.push(e,"3aa99CZcJ1MLLQsbOrYzc7s","ScopaGDLogicHandler");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(a,"__esModule",{value:!0}),a.ScopaGDLogicHandler=void 0;var r=t("../../../script/plugin/pb/protofile/GlobalMsgDef"),n=t("../model/CMD_ScopaMsgDefine"),s=t("../../gameBaseSrc/model/goldGame/CMD_GameMsg"),c=t("./../model/ScopaRoomData"),d=t("./../../../script/lib/utils/ComUtils"),l=t("./../../../script/app/const/Global"),p=t("../../../script/app/const/game/GameConstant"),h=t("../../../script/app/event/Notify"),u=t("../../../script/lib/utils/Logger"),C=t("../../gameBaseSrc/controller/LogicBaseHandler"),f=t("../../gameBaseSrc/model/GameEvent"),y=t("../model/ScopaGDPlayData"),S=t("./ScopaGDFlow"),v=t("../../../script/app/module/buryPoint/BuryPointUtils"),m=t("../../../script/app/module/buryPoint/BuryPoint"),_=t("../../gameBaseSrc/model/ScopaConstant"),g=t("../../gameBaseSrc/alg/ScopaLogic"),E=t("../../../script/app/event/GuiEvent"),I=function(t){function e(){var e=t.call(this)||this;return e.gameFlow=new S.ScopaGDFlow(e),e.playData=new y.ScopaGDPlayData(e),e.roomData=new c.ScopaGDRoomData(l.Global.getHuskyGameInfo(l.gHuskyGameType.SCOPA_GOLD).name),e}return i(e,t),e.prototype.getName=function(){return"ScopaGDLogicHandler"},e.prototype.destory=function(){this.handler.clear(),this.removeEvent(null),t.prototype.destory.call(this)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEvent(f.GameEvent.Msg.SEND_OUTCARD,this.sendGameOutCardMsg),this.addEvent(f.GameEvent.Msg.SEND_OPERATTION,this.sendGameOperateMsg),this.addEvent(f.GameEvent.OperateEvent.NEXT_GAME,this.onNextGame),this.addEvent(h.Notify.Base.UPDATE_USERINFO,this.onUpdateUserInfo),this.addEvent(f.GameEvent.OperateEvent.CLICK_EATCARD,this.onClickEatCard),this.addEvent(f.GameEvent.OperateEvent.TRUST,this.onTrust),this.addEvent(f.GameEvent.OperateEvent.OUT_CARD_SELF,this.onOutCardSelf),this.addEvent(f.GameEvent.OperateEvent.CLICK_RULE_HELP,this.onClickRuleHelp)},e.prototype.protocolConfig=function(){return[{protocol:n.MSG_SC_SCOPA_GameStartData,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GAME_START_DATA,cb:this.onGameStartData},{protocol:n.MSG_SC_SCOPA_SendHandCard,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_SEND_HAND_CARD,cb:this.onSendHandCard},{protocol:null,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GAME_RESET_CARD,cb:this.onResetCard},{protocol:n.MSG_SC_SCOPA_InformUserOP,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_INFORM_USEROP,cb:this.onInformUserOp},{protocol:n.MSG_SC_SCOPA_PlayResult,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_PLAY_RESULT,cb:this.onOutCardResult},{protocol:n.MSG_SC_SCOPA_OPResult,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_OP_RESULT,cb:this.onOpertateResult},{protocol:n.MSG_SC_SCOPA_EatCardList,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_EATCARD_LIST,cb:this.onInformPlayerChooseEatCard},{protocol:n.MSG_SC_SCOPA_GetSurplusCard,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GET_SURPLUS_CARD,cb:this.onGetSurplusCard},{protocol:n.MSG_SC_SCOPA_GameResult,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GAME_RESULT,cb:this.onGameOnceResult},{protocol:n.MSG_SC_SCOPA_GamePlay,subid:n.MESSAGE_SC_SCOPA_SUB_ID.MSGID_SC_SCOPA_GAMESCENCE_PLAY,cb:this.onGameScenePlay}]},e.prototype.getMainID=function(){return n.LOGIC_MAIN_MSG.MSG_GAMELOGIC_MAIN_ID},e.prototype.getSendSubId=function(){return s.GAME_SUB_MSG.MSGID_SCS_DESK_GAMEDATA},e.prototype.getSendMainId=function(){return r.MAIN_MSG_ID.MAIN_MSG_GAME_MSG_ID},e.prototype.getGameMsgHead=function(){var t=new r.Msg_GameHead;return t.strUUID=this.userData.sessionId,t},e.prototype.getGameLogicHead=function(){var t=new s.MSG_CS_GameData;return t.dwMainID=n.LOGIC_MAIN_MSG.MSG_GAMELOGIC_MAIN_ID,t},e.prototype.sendGameOutCardMsg=function(t){var e=new n.MSG_CS_SCOPA_UserPlay;e.dwChairID=this.roomData.getMyBaseInfo().chairId,e.dwOutCard=t.outCard,this.sendMsg(e,n.MESSAGE_CS_SCOPA_SUB_ID.MSGID_CS_SCOPA_USER_PLAY),u.Logger.info("\u53d1\u9001\u51fa\u724c\u6d88\u606f =========>",t.outCard)},e.prototype.sendGameOperateMsg=function(t){var e=new n.MSG_CS_SCOPA_UserEat;e.dwChairID=this.roomData.getMyBaseInfo().chairId,e.dwOutCard=t.outCard,e.chEatCardData=d.ComUtils.objToU8(t.eatCards||[]),this.sendMsg(e,n.MESSAGE_CS_SCOPA_SUB_ID.MSGID_CS_SCOPA_USER_EAT),u.Logger.info("\u53d1\u9001\u64cd\u4f5c\u6d88\u606f =========>",JSON.stringify(e))},e.prototype.onGameReplayMsg=function(t){var e=t.id,a=t.body;e&&a&&this.handle(e,a)},e.prototype.onGameStartData=function(t,e){void 0===e&&(e=!0);var a=t.data;this.getPlayData().gameStart(a),e&&(this.gameData.isInGame=!0,g.ScopaLogic.isAScopa=this.roomData.isAScopa,v.BuryPointUtils.send(m.BuryPoint.Debug.Game.GameStart),this.getGameFlow().addGameStartFlow())},e.prototype.onSendHandCard=function(t,e){void 0===e&&(e=!0);var a=t.data,o=this.getRoomData(),i=o.getViewIdByChairId(a.dwChairID);o.bankerViewId=i,o.setPlayStatus(p.GameConstant.RoomPlayStatus.playing),this.getPlayData().sendCard(a),e&&this.getGameFlow().addSendCardFlow(i)},e.prototype.onResetCard=function(t,e){void 0===e&&(e=!0),e&&this.getGameFlow().addResetCardFlow()},e.prototype.onInformUserOp=function(t,e){void 0===e&&(e=!0);var a=t.data;this.getPlayData().informPlayerOperate(a),e&&this.getGameFlow().addInformOpFlow()},e.prototype.onOutCardResult=function(t,e){void 0===e&&(e=!0);var a=t.data,o=this.getPlayData();if(o.playerOutCardResult(a),e){var i=this.getRoomData().getViewIdByChairId(a.dwChairID);0===a.dwError?(this.getGameFlow().addOutCardFlow(),this.dispatch(f.GameEvent.Player.SET_TIMER,{viewId:i,remainTime:0,maxTime:o.opTimeMax,bRun:!1})):(u.Logger.info("onOpertateResult \u51fa\u724c\u7ed3\u679c  \u91cd\u7f6e\u4e4b\u524d\u51fa\u53bb\u7684\u724c"),v.BuryPointUtils.send(m.BuryPoint.Debug.Game.OutCardError,""+JSON.stringify(a)),this.dispatch(f.GameEvent.HandCard.UPDATE_DATA,{viewId:i,handCardDatas:o.allHandCardDatas[i],throwCardIndex:o.throwCardIndex}),this.dispatch(cc.js.formatStr(f.GameEvent.HandCard.REFREASH,i),i),this.dispatch(f.GameEvent.OutCard.SCENE_PLAYING,o.outCardDatas),2!==a.dwError&&this.dispatch(f.GameEvent.HandCard.INFORM_PLAYER_OP,{curOperateViewId:i}))}},e.prototype.onOpertateResult=function(t,e){void 0===e&&(e=!0);var a=t.data,o=this.getPlayData();if(o.playerOperateResult(a),e){var i=o.curOperateViewId;this.dispatch(f.GameEvent.Player.OP_TIMEOUT,{viewId:i,time:0}),this.dispatch(f.GameEvent.Player.SET_TIMER,{viewId:i,remainTime:0,maxTime:o.opTimeMax,bRun:!1});var r=!1;0===i&&o.selfOpEatCards&&o.selfOpEatCards.outCardData>0&&(o.curOpEatCard&&o.curOpEatCard.equals(o.selfOpEatCards)?r=!0:(this.getGameFlow().stop(),this.dispatch(f.GameEvent.HandCard.UPDATE_DATA,{viewId:i,handCardDatas:o.allHandCardDatas[i],throwCardIndex:o.throwCardIndex}),this.dispatch(cc.js.formatStr(f.GameEvent.HandCard.REFREASH,i),i),this.dispatch(f.GameEvent.OutCard.SCENE_PLAYING,o.outCardDatas))),a.dwGetCardData.length>0&&!r&&this.getGameFlow().addEatCardFlow(o.curOpEatCard),o.selfOpEatCards.clear()}},e.prototype.onInformPlayerChooseEatCard=function(t,e){void 0===e&&(e=!0);var a=t.data,o=this.getPlayData();o.informPlayerChooseEatCard(a),e&&(this.dispatch(f.GameEvent.OpView.CHOOSE_CARD,{outCardData:o.curProvideCard,eatOptions:o.chooseEatGroup}),this.dispatch(f.GameEvent.HandCard.SCENE_PLAYING,{allHandCardDatas:o.allHandCardDatas}),this.dispatch(f.GameEvent.OutCard.SCENE_PLAYING,o.outCardDatas))},e.prototype.onGetSurplusCard=function(t,e){void 0===e&&(e=!0);var a=t.data,o=this.getPlayData();o.playerGetSurplusCard(a),e&&this.getGameFlow().addEatSurplusCardFlow(o.curOpEatCard)},e.prototype.onGameOnceResult=function(t,e){var a=this;void 0===e&&(e=!0);var o=t.data,i=this.getPlayData(),r=i.gameResult(o);if(e){this.gameData.isInGame=!1,this.getRoomData().roomPlayStatus=p.GameConstant.RoomPlayStatus.gameEnd,this.gameData.exsitGameInfo={gameID:0,gameType:0,queryTime:0},r&&this.dispatch(h.Notify.Other.REQ_BRANKRUPT_INFO),this.dispatch(f.GameEvent.Desk.DESK_CLEAR_TIMER),this.dispatch(f.GameEvent.Player.SET_TIMER,{viewId:i.curOperateViewId,remainTime:0,maxTime:i.opTimeMax,bRun:!1}),this.dispatch(f.GameEvent.Base.GAME_RESULT),this.dispatch(f.GameEvent.Voice.STOP_MUSIC_BG),this.dispatch(f.GameEvent.Chat.CLEAR);var n=this.getPlayData().curResult;n.ourSidePlayers.forEach(function(t){a.dispatch(f.GameEvent.Player.UPDATE_USERS_INFO,{userId:t.userId,level:t.level})}),n.otherSidePlayers.forEach(function(t){a.dispatch(f.GameEvent.Player.UPDATE_USERS_INFO,{userId:t.userId,level:t.level})}),1==this.getRoomData().loginFinish?this.getGameFlow().addGameEndFlow():(this.dispatch(f.GameEvent.HandCard.SCENE_PLAYING,{allHandCardDatas:i.allHandCardDatas}),this.dispatch(f.GameEvent.EatCard.SCENE_PLAYING,i.getEatCardInfo()),this.dispatch(f.GameEvent.Popup.GAME_ONCE_RESULT,this.getPlayData().curResult))}},e.prototype.onGameScenePlay=function(t,e){void 0===e&&(e=!0);var a=t.data;this.getGameFlow().stop();var o=this.getRoomData();g.ScopaLogic.isAScopa=o.isAScopa;var i=this.getPlayData();if(i.gameScenePlaying(a),e){o.setPlayStatus(p.GameConstant.RoomPlayStatus.playing),this.dispatch(f.GameEvent.GameTips.PLAYER_STATUS_CLEAR),this.dispatch(f.GameEvent.GameTips.CLEAR),this.dispatch(f.GameEvent.Desk.WAIT_MENU_CLEAR),this.dispatch(f.GameEvent.Desk.DESKINFO_TRANSPARENT,!0),this.dispatch(f.GameEvent.Desk.UPDATE_DESKINFO,{deskCfg:o.getDeskInfo(),roomCfg:o.getRoomInfo(),iMultpNum:a.dwMultiplyNum}),this.dispatch(f.GameEvent.Desk.DESKINFO_TRANSPARENT,!0),this.dispatch(f.GameEvent.Desk.REMAIN_CARD_NUM_CHANGE,i.curCardStackNum),this.dispatch(f.GameEvent.Desk.DESK_REMAIN_TIME_RESET,i.curOpRemainTime),this.dispatch(f.GameEvent.HandCard.SCENE_PLAYING,{allHandCardDatas:i.allHandCardDatas,curDisplayMode:o.getCardDisplayMode()}),this.dispatch(f.GameEvent.OutCard.SCENE_PLAYING,i.outCardDatas),this.dispatch(f.GameEvent.EatCard.SCENE_PLAYING,i.getEatCardInfo());var r=i.curOperateViewId;this.dispatch(f.GameEvent.HandCard.SET_CAN_TOUCH,0===r),r>-1&&(this.dispatch(f.GameEvent.HandCard.INFORM_PLAYER_OP,{curOperateViewId:r}),this.dispatch(f.GameEvent.Player.SET_TIMER,{viewId:r,remainTime:i.curOpRemainTime,maxTime:i.opTimeMax,bRun:!0}))}},e.prototype.onNextGame=function(){var t=this,e=this.getRoomData();e.leftPlayerIdList.forEach(function(e){t.dispatch(f.GameEvent.Player.STATUS_CHANGE,{userId:e,status:p.GameConstant.RoomUserStatus.GetOut})}),e.removeLeftPlayer(),e.roomPlayStatus=p.GameConstant.RoomPlayStatus.waiting,this.dispatch(f.GameEvent.Player.STATUS_CHANGE,{userId:e.getUserIdByViewId(0),status:p.GameConstant.RoomUserStatus.Ready}),this.dispatch(f.GameEvent.Desk.WAIT_MENU_CLEAR),this.dispatch(f.GameEvent.Com.READY_NEXT_CLEAR),this.dispatch(f.GameEvent.Desk.DESKINFO_TRANSPARENT,!1),this.dispatch(f.GameEvent.Desk.UPDATE_DESKINFO,{deskCfg:e.getDeskInfo(),roomCfg:e.getRoomInfo()}),!0===e.isTimeOut||1==e.isConnectBreak?this.dispatch(f.GameEvent.Com.RECONNECT):this.dispatch(f.GameEvent.Player.MOVE,{bMoveToMid:!0})},e.prototype.onUpdateUserInfo=function(t){if(t){var e=this.roomData.getPlayerByUserId(t.userId);e&&(e.name=t.userName,e.sex=t.gender,e.headURL=t.wxHeadUrl,this.dispatch(f.GameEvent.Player.UPDATE_ROOM_USERINFO,e))}},e.prototype.onClickEatCard=function(t){this.playData.ourScoreDetail&&this.dispatch(f.GameEvent.Popup.REALTIME_SCORE,{worldPos:t,ourScoreDetail:d.ComUtils.clone(this.playData.ourScoreDetail),otherScoreDetail:d.ComUtils.clone(this.playData.otherScoreDetail)})},e.prototype.onTrust=function(t){void 0===t&&(t=!1),this.dispatch(f.GameEvent.Msg.SEND_TRUST_STATUS,{isTrust:t,chairId:this.roomData.myBaseInfo.chairId})},e.prototype.onOutCardSelf=function(){var t=this.getPlayData().selfOpEatCards;t&&t.deleteCards.length>0&&(g.ScopaLogic.isAScopa&&g.ScopaLogic.isA(t.outCardData)&&u.Logger.info("[viewId=0]\u81ea\u5df1\u51fa\u724c\u4e86 \u51fa\u4e86A this.selfOpEatCards.deleteCards="+t.deleteCards+" msg.bScopa="+t.bScopa),this.getGameFlow().addEatCardFlow(t,1e3*_.ScopaConstant.THROW_OUT_CARD_TIME))},e.prototype.onClickRuleHelp=function(){var t=[],e=this.getRoomData();e.isAScopa&&t.push(p.GameConstant.RuleType.A_SCOPA),e.isSettleNormal()||t.push(p.GameConstant.RuleType.BigWin),e.isWild()&&t.push(p.GameConstant.RuleType.DoubleUp),this.dispatch(E.GuiEvent.PopMsg.DISPLAY_RULE_TIPS,{ruleTypes:t})},e}(C.LogicBaseHandler);a.ScopaGDLogicHandler=I,cc._RF.pop()},{"../../../script/app/const/game/GameConstant":void 0,"../../../script/app/event/GuiEvent":void 0,"../../../script/app/event/Notify":void 0,"../../../script/app/module/buryPoint/BuryPoint":void 0,"../../../script/app/module/buryPoint/BuryPointUtils":void 0,"../../../script/lib/utils/Logger":void 0,"../../../script/plugin/pb/protofile/GlobalMsgDef":void 0,"../../gameBaseSrc/alg/ScopaLogic":void 0,"../../gameBaseSrc/controller/LogicBaseHandler":void 0,"../../gameBaseSrc/model/GameEvent":void 0,"../../gameBaseSrc/model/ScopaConstant":void 0,"../../gameBaseSrc/model/goldGame/CMD_GameMsg":void 0,"../model/CMD_ScopaMsgDefine":"CMD_ScopaMsgDefine","../model/ScopaGDPlayData":"ScopaGDPlayData","./../../../script/app/const/Global":void 0,"./../../../script/lib/utils/ComUtils":void 0,"./../model/ScopaRoomData":"ScopaRoomData","./ScopaGDFlow":"ScopaGDFlow"}],ScopaGDPlayData:[function(t,e,a){"use strict";cc._RF.push(e,"09807XXFAhNgImOTd2zSUlj","ScopaGDPlayData");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(a,"__esModule",{value:!0}),a.ScopaGDPlayData=a.ScopaGameResult=a.ScopaPlayerInfo=a.ScopaPlayerScoreDetail=void 0;var r=t("./../../../script/lib/utils/Logger"),n=t("./../../../script/lib/utils/ComUtils"),s=t("../../../script/app/const/game/GameConstant"),c=t("../../gameBaseSrc/model/BasePlayData"),d=t("../../gameBaseSrc/model/RoomPlayerInfo"),l=t("../../gameBaseSrc/alg/ScopaLogic"),p=t("../../gameBaseSrc/model/ScopaConstant"),h=function(){function t(){this.viewId=-1,this.userGold=0,this.score=0,this.cardNum=0,this.ColorFenMax=0,this.coins7=0,this.coinsNum=0,this.scopaCount=0,this.cardDatas=[],this.fbScore=0,this.dwCupNum=0}return t.prototype.clear=function(){this.viewId=0,this.userGold=0,this.cardNum=0,this.score=0,this.ColorFenMax=0,this.coins7=0,this.coinsNum=0,this.scopaCount=0,this.cardDatas=[],this.dwCupNum=0},t}();a.ScopaPlayerScoreDetail=h;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bPC=!1,e}return i(e,t),e}(d.RoomPlayerInfo);a.ScopaPlayerInfo=u;var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ourSidePlayers=[],e.otherSidePlayers=[],e.cupNum=0,e}return i(e,t),e}(c.BaseGameResult);a.ScopaGameResult=C;var f=function(t){function e(e){var a=t.call(this,"ScopaGD")||this;return a.logic=e,a.curOpEatCard=new c.ScopaOpEatCard,a.selfOpEatCards=new c.ScopaOpEatCard,a.clear(),a}return i(e,t),e.prototype.clear=function(){t.prototype.clear.call(this),this.playerEatCardList=[[],[],[],[]],this.playerScopaList=[[],[],[],[]],this.chooseEatGroup=[[],[],[],[]],this.playerScopaCount=[0,0,0,0],this.bPlayerSettebello=[!1,!1,!1,!1],this.winerViewId=-1,this.sendToDeskDatas=[],this.throwCardIndex=-2,this.curOpEatCard&&this.curOpEatCard.clear(),this.selfOpEatCards&&this.selfOpEatCards.clear(),this.ourScoreDetail=null,this.otherScoreDetail=null},e.prototype.handCardCompare=function(){return 0},e.prototype.isViewIdIsOurSide=function(t){return 2==this.logic.getRoomData().maxPlayerNum?0==t:0==(1&t)},e.prototype.isMySideWin=function(){return 2==this.logic.getRoomData().maxPlayerNum?0===this.winerViewId:0==(1&this.winerViewId)},e.prototype.isCardCanOut=function(t){if(l.ScopaLogic.isAScopa&&l.ScopaLogic.isA(t))return!0;var e=l.ScopaLogic.bytesToLocal(this.outCardDatas),a=l.ScopaLogic.getCardValue(t),o=l.ScopaLogic.findSumEqualToVaule(e,a);return l.LocalCardSt.put(e),e=null,!(o.length>1)},e.prototype.isLastCard=function(){if(0===this.curCardStackNum){for(var t=0,e=0,a=this.allHandCardDatas;e<a.length;e++){var o=a[e];if(o&&(t+=o.length)>1)break}if(1===t)return!0}return!1},e.prototype.getThrowCardIndex=function(t,e){var a=[];if(this.outCardDatas.forEach(function(t){t>0&&a.push(t)}),l.ScopaLogic.isAScopa&&l.ScopaLogic.isA(t)&&a.length>0){e&&this.selfThrowCardResult(a,t);var o=l.PosState.MergePos;return 1==a.length&&(o=this.getCardItemIndexByData(a[0])),o}a.length=0;var i=l.ScopaLogic.bytesToLocal(this.outCardDatas),r=l.ScopaLogic.getCardValue(t),n=!1,s=l.PosState.NotFoundPos,c=l.ScopaLogic.findSameValueCards(i,r);if(1===c.length&&(n=!0,s=this.getCardItemIndexByData(c[0].o),a=[this.outCardDatas[s]]),!1===n){var d=l.ScopaLogic.findSumEqualToVaule(i,r);if(d.length>0&&(d.length>1||d[0].length>1?(n=!0,s=l.PosState.MergePos):1===d[0].length&&(n=!0,s=this.getCardItemIndexByData(d[0][0].o),a=[this.outCardDatas[s]]),1===d.length&&d[0].length>1))for(var p=0,h=d[0];p<h.length;p++){var u=h[p];a.push(u.o)}}return e&&n&&this.selfThrowCardResult(a,t),l.LocalCardSt.put(i),i=null,n?s:this.getUIEmptyPosIndex()},e.prototype.selfThrowCardResult=function(t,e){if(this.selfOpEatCards.clear(),!(t.length<=0)){var a=!1;l.ScopaLogic.isScopa(this.outCardDatas,e)&&!1===this.isLastCard()&&(a=!0);var o=l.ScopaLogic.isSettebello(t)||e===l.ScopaLogic.COINS_7,i=1,r=this.playerScopaCount[0];if(this.logic.getRoomData().isWild()){for(var n=0,s=0,c=this.playerScopaCount;s<c.length;s++)n+=c[s];a&&n++,i=Math.pow(2,n)}a&&r++;var d,h=t.length;d=h>=2?p.ScopaConstant.MERGE_EAT_DELAY_TIME*(h-1)+p.ScopaConstant.MERGE_EAT_RUN_TIME:1==h?.33+p.ScopaConstant.EAT_CARD_RUN_TIME:p.ScopaConstant.MERGE_EAT_RUN_TIME,this.selfOpEatCards.viewId=0,this.selfOpEatCards.deleteCards=t.sort(function(t,e){return t-e}),this.selfOpEatCards.bScopa=a,this.selfOpEatCards.bSettebello=o,this.selfOpEatCards.outCardData=e,this.selfOpEatCards.bSurplus=!1,this.selfOpEatCards.scopaCount=r,this.selfOpEatCards.bOurSide=!0,this.selfOpEatCards.delayTime=d,this.selfOpEatCards.iMultpNum=i||1}},e.prototype.getCardItemIndexByData=function(t){for(var e=-2,a=this.outCardDatas,o=a.length,i=0;i<o;i++)if(a[i]==t){e=i;break}return e},e.prototype.getUIEmptyPosIndex=function(){for(var t=this.outCardDatas.length,e=0;e<t;e++)if(0===this.outCardDatas[e])return e;return 8===t?l.PosState.MergePos:t},e.prototype.addEatCardDatasByViewId=function(t,e,a){for(var o=0;o<a;o++)this.playerEatCardList[t].push(e[o])},e.prototype.addScopaCardDataByViewId=function(t,e,a){for(var o=0;o<a;o++)this.playerScopaList[t].push(e[o]),this.playerScopaCount[t]++},e.prototype.getAllEatCards=function(){var t=this.curResult,e=[];return e[0]=t.ourGameResult.cardDatas,e[1]=t.otherGameResult.cardDatas,e},e.prototype.getEatCardInfo=function(){for(var t=[0,0],e=[[],[]],a=[0,0],o=0;o<4;o++){var i=this.isViewIdIsOurSide(o)?0:1;t[i]+=this.playerEatCardList[o].length;for(var r=0,n=this.playerScopaList[o];r<n.length;r++){var s=n[r];e[i].push(s)}a[i]+=this.playerScopaCount[o]}return{normalCardList:t,scopaCardList:e,scopaCount:a}},e.prototype.regPlayerScore=function(){this.ourScoreDetail||(this.ourScoreDetail=new h),this.otherScoreDetail||(this.otherScoreDetail=new h),this.ourScoreDetail.clear(),this.otherScoreDetail.clear();for(var t=[0,16,12,13,14,15,18,21,10,10,10],e=p.ScopaConstant.CardColor,a=0;a<4;a++){var o=0,i=0,r=this.playerEatCardList[a];if(r.length>0){for(var n=[0,0,0,0],s=l.ScopaLogic.bytesToLocal(r),c=0,d=s;c<d.length;c++){var u=d[c];u.c===e.Coins&&o++,n[u.c]<t[u.l]&&(n[u.c]=t[u.l])}for(var C=0,f=n;C<f.length;C++)i+=f[C];l.LocalCardSt.put(s),s=null}this.isViewIdIsOurSide(a)?(this.ourScoreDetail.coinsNum+=o,this.ourScoreDetail.ColorFenMax+=i,this.ourScoreDetail.cardNum+=r.length,this.ourScoreDetail.scopaCount+=this.playerScopaCount[a]||0,this.ourScoreDetail.coins7+=this.bPlayerSettebello[a]?1:0):(this.otherScoreDetail.coinsNum+=o,this.otherScoreDetail.ColorFenMax+=i,this.otherScoreDetail.cardNum+=r.length,this.otherScoreDetail.scopaCount+=this.playerScopaCount[a]||0,this.otherScoreDetail.coins7+=this.bPlayerSettebello[a]?1:0)}},e.prototype.gameStart=function(t){this.clear(),this.logic.getPlayData().cardTotalNum=t.dwCardNum},e.prototype.resetCard=function(){this.clear()},e.prototype.sendCard=function(t){this.curOperateViewId=this.logic.getRoomData().getViewIdByChairId(t.dwChairID),this.curCardStackNum=t.dwSurplusNum,this.sendCardCount=3;for(var e=this.logic.getRoomData().getMaxPlayerNum(),a=0;a<e;a++){var o=a+1,i=this.logic.getRoomData().getViewIdByChairId(o);0==i?(this.setHandCardData(0,t.dwCardData,t.dwCardNum),this.sortHandCardDatas(i)):this.initHandCardData0(i,t.dwCardNum)}for(this.handCardDisplayMode[0]=s.GameConstant.HandCardMode.DISPLAY,a=0;a<t.dwTableCardNum;a++)this.addDeskOutCard(t.dwTableCardData[a]);this.sendToDeskDatas=n.ComUtils.clone(t.dwTableCardData),this.deleteUnknowCardDatas(this.allHandCardDatas[0])},e.prototype.informPlayerOperate=function(t){this.curOperateViewId=this.logic.getRoomData().getViewIdByChairId(t.dwChairID),this.curOpRemainTime=t.dwOppTime,this.chooseEatGroup=[]},e.prototype.playerOutCardResult=function(t){if(0===t.dwError){var e=this.logic.getRoomData().getViewIdByChairId(t.dwChairID);this.curProvideViewId=e,this.curOperateViewId=e,this.curProvideCard=t.dwOutCard,this.deleteOneHandCardByData(e,this.curProvideCard),this.throwCardIndex=this.getThrowCardIndex(this.curProvideCard,!1),-1===this.throwCardIndex&&1==t.dwGetCardData.length&&(this.throwCardIndex=this.getCardItemIndexByData(t.dwGetCardData[0])),this.curProvideCard&&this.addDeskOutCard(this.curProvideCard)}},e.prototype.playerOperateResult=function(t){var e=this.logic.getRoomData().getViewIdByChairId(t.dwChairID);if(e<=-1)r.Logger.error("playerOperateResult viewId error");else{this.curProvideViewId=e,this.curOperateViewId=e,this.curProvideCard=t.dwOutCard;var a=t.dwGetCardData.length;t.bScopa&&this.addScopaCardDataByViewId(this.curProvideViewId,[t.dwOutCard],1),a>0&&(this.addEatCardDatasByViewId(this.curProvideViewId,t.dwGetCardData,a),this.addEatCardDatasByViewId(this.curProvideViewId,[t.dwOutCard],1));var o=!1;if(a>0){var i=n.ComUtils.clone(t.dwGetCardData);i.push(t.dwOutCard),this.deleteDeskOutCard(i);var s=l.ScopaLogic.COINS_7;i.forEach(function(t){t===s&&(o=!0)}),o&&(this.bPlayerSettebello[this.curProvideViewId]=!0)}var c;c=a>=2?p.ScopaConstant.MERGE_EAT_DELAY_TIME*(a-1)+p.ScopaConstant.MERGE_EAT_RUN_TIME:1==a?.33+p.ScopaConstant.EAT_CARD_RUN_TIME:p.ScopaConstant.MERGE_EAT_RUN_TIME,this.curOpEatCard.clear(),this.curOpEatCard.viewId=e,this.curOpEatCard.deleteCards=n.ComUtils.clone(t.dwGetCardData).sort(function(t,e){return t-e}),this.curOpEatCard.bScopa=t.bScopa,this.curOpEatCard.outCardData=t.dwOutCard,this.curOpEatCard.bSurplus=!1,this.curOpEatCard.scopaCount=this.playerScopaCount[e],this.curOpEatCard.bOurSide=this.isViewIdIsOurSide(e),this.curOpEatCard.delayTime=c,this.curOpEatCard.iMultpNum=t.dwMultiplyNum,this.curOpEatCard.bSettebello=o,this.regPlayerScore(),l.ScopaLogic.isAScopa&&l.ScopaLogic.isA(t.dwOutCard)&&r.Logger.info("[viewId="+e+"]\u73a9\u5bb6\u64cd\u4f5c\u7ed3\u679c \u51fa\u4e86A this.curOpEatCard.deleteCards="+this.curOpEatCard.deleteCards+" msg.bScopa="+t.bScopa)}},e.prototype.informPlayerChooseEatCard=function(t){this.curProvideViewId=0,this.curProvideCard=t.dwOutCard,this.chooseEatGroup=[];for(var e=0;e<t.dwEatCardData.length;e++)this.chooseEatGroup[e]=n.ComUtils.clone(t.dwEatCardData[e].dwCardData)},e.prototype.playerGetSurplusCard=function(t){var e=this.logic.getRoomData().getViewIdByChairId(t.dwChairID);this.curProvideViewId=e,this.curOperateViewId=e,this.addEatCardDatasByViewId(e,t.dwCardData,t.dwCardData.length),this.deleteDeskOutCard(t.dwCardData);var a=!1,o=l.ScopaLogic.COINS_7;t.dwCardData.forEach(function(t){t===o&&(a=!0)}),this.curOpEatCard.clear(),this.curOpEatCard.viewId=e,this.curOpEatCard.deleteCards=n.ComUtils.clone(t.dwCardData).sort(function(t,e){return t-e}),this.curOpEatCard.bScopa=!1,this.curOpEatCard.outCardData=0,this.curOpEatCard.bSurplus=!0,this.curOpEatCard.scopaCount=this.playerScopaCount[e],this.curOpEatCard.bOurSide=this.isViewIdIsOurSide(e),this.curOpEatCard.bSettebello=a,this.curOpEatCard.delayTime=0,this.curOpEatCard.iMultpNum=1},e.prototype.gameResult=function(t){var e=this.logic.getRoomData(),a=e.getViewIdByChairId.bind(e);this.winerViewId=a(t.dwWinnerChairID);var o=new C;o.rematchTime=t.dwRematchTime,this.curResult=o,-1===this.winerViewId?o.endStatus=s.GameConstant.GameEndStatus.DRAW:0===this.winerViewId?o.endStatus=s.GameConstant.GameEndStatus.WIN:o.endStatus=s.GameConstant.GameEndStatus.LOST;for(var i=0,r=0,n=t.tabUserSettleInfoList,c=e.getMaxPlayerNum(),d=!1,l=0;l<c;l++){var p=n[l];if(p){var u=a(p.dwChairID);0===u&&p.bPC&&(d=!0);var f=new h;f.viewId=u,f.score=p.dwScore,f.cardNum=p.dwCardnum,f.ColorFenMax=p.dwColorFen,f.coins7=p.bHaveCoins7?1:0,f.coinsNum=p.dwCoinsNum,f.scopaCount=p.dwScopaNum,f.userGold=p.dwGold,f.cardDatas=p.dwCardData,f.dwCupNum=p.dwCupNum;var y=e.getPlayerByViewId(u);y.bPC=p.bPC,y.level=p.dwExpLevel,0===u?(o.ourGameResult=f,o.ourSidePlayers.push(y)):(o.otherGameResult=f,o.otherSidePlayers.push(y)),this.isViewIdIsOurSide(u)?i+=p.dwScore:r+=p.dwScore}}var S=e.isWild(),v=t.dwMultiplyNum,m=e.isSettleNormal();return 0==S&&m?o.strBeiShu="":S&&m?o.strBeiShu=v>1?"BET "+e.getBaseScore()+" X"+v:"BET "+e.getBaseScore():!1===S&&!1===m?o.strBeiShu=i!=r?"BET "+e.getBaseScore()+" X("+i+"-"+r+")":"BET "+e.getBaseScore():S&&!1===m&&(o.strBeiShu=v>1?"BET "+e.getBaseScore()+" X("+i+"-"+r+")X"+v:"BET "+e.getBaseScore()+" X("+i+"-"+r+")"),o.cappedViewId=e.getViewIdByChairId(t.dwCappingChairID),d},e.prototype.gameScenePlaying=function(t){this.clear(),this.handCardDisplayMode[0]=s.GameConstant.HandCardMode.DISPLAY;var e=this.logic.getRoomData();this.curOperateViewId=e.getViewIdByChairId(t.dwCurrentChairID),this.curOpRemainTime=t.dwOppTime,this.curCardStackNum=t.dwSurplusNum;for(var a=0;a<t.dwCardnum;a++)this.addDeskOutCard(t.dwCardData[a]);var o=t.tabUserGameInfoList.length;for(a=0;a<o;a++){var i=t.tabUserGameInfoList[a];if(!i)break;var r=e.getViewIdByChairId(i.dwChairID);this.addScopaCardDataByViewId(r,i.dwScopaData,i.dwScopaNum),this.addEatCardDatasByViewId(r,i.dwGetCardData,i.dwGetCardNum),this.bPlayerSettebello[r]=i.bHaveCoins7,0==r?(this.setHandCardData(0,i.tabHandCardData,i.dwCardnum),this.sortHandCardDatas(r)):this.initHandCardData0(r,i.dwCardnum)}this.regPlayerScore()},e}(c.BasePlayData);a.ScopaGDPlayData=f,cc._RF.pop()},{"../../../script/app/const/game/GameConstant":void 0,"../../gameBaseSrc/alg/ScopaLogic":void 0,"../../gameBaseSrc/model/BasePlayData":void 0,"../../gameBaseSrc/model/RoomPlayerInfo":void 0,"../../gameBaseSrc/model/ScopaConstant":void 0,"./../../../script/lib/utils/ComUtils":void 0,"./../../../script/lib/utils/Logger":void 0}],ScopaGDScene:[function(t,e,a){"use strict";cc._RF.push(e,"e3341mQETlJqpx0uTqQV8x9","ScopaGDScene");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.ScopaScene=void 0;var n=t("../../../script/app/event/Notify"),s=t("../../gameBaseSrc/controller/goldGame/GoldDeskHandler"),c=t("../../gameBaseSrc/controller/goldGame/GoldLoginMsgHandler"),d=t("../../gameBaseSrc/model/GameEvent"),l=t("../../gameBaseSrc/view/goldGame/GoldGameScene"),p=t("../controller/ScopaGDLogicHandler"),h=t("../controller/ScopaVoice"),u=cc._decorator,C=u.ccclass,f=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onDestroy=function(){this.goldDeskHandler&&(this.dispatch(n.Notify.Gate.RM_HANDLER,this.goldDeskHandler),this.goldDeskHandler.destory(),this.goldDeskHandler=null),this.loginMsgHandler&&(this.dispatch(n.Notify.Gate.RM_HANDLER,this.loginMsgHandler),this.loginMsgHandler.clear(),this.loginMsgHandler=null),t.prototype.onDestroy.call(this)},e.prototype.getSceneName=function(){return"ScopaGDScene"},e.prototype.initHandler=function(){t.prototype.initHandler.call(this),this.logicHandler=new p.ScopaGDLogicHandler,this.goldDeskHandler=new s.GoldDeskHandler(this.logicHandler),this.loginMsgHandler=new c.GoldLoginMsgHandler(this.logicHandler),this.dispatch(n.Notify.Gate.ADD_HANDLER,this.goldDeskHandler),this.dispatch(n.Notify.Gate.ADD_HANDLER,this.loginMsgHandler),this.initHandlerFinished=!0,this.tryLoginGame()},e.prototype.initVoice=function(){this.gameVoice=new h.ScopaVoice,t.prototype.initVoice.call(this)},e.prototype.onChangeDeskEvent=function(){this.dispatch(d.GameEvent.Msg.SEND_CHANGE_DESK)},e.prototype.onChangeLanguage=function(e){t.prototype.onChangeLanguage.call(this,e)},e.prototype.onPreLoadResultRes=function(){t.prototype.onPreLoadResultRes.call(this)},r([C],e)}(l.GoldGameScene));a.ScopaScene=f,cc._RF.pop()},{"../../../script/app/event/Notify":void 0,"../../gameBaseSrc/controller/goldGame/GoldDeskHandler":void 0,"../../gameBaseSrc/controller/goldGame/GoldLoginMsgHandler":void 0,"../../gameBaseSrc/model/GameEvent":void 0,"../../gameBaseSrc/view/goldGame/GoldGameScene":void 0,"../controller/ScopaGDLogicHandler":"ScopaGDLogicHandler","../controller/ScopaVoice":"ScopaVoice"}],ScopaGDUIConfig:[function(t,e,a){"use strict";cc._RF.push(e,"5e00dHFP7FPO5c8QN87xZDi","ScopaGDUIConfig");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(a,"__esModule",{value:!0}),a.ScopaBundleConfig=a.ScopaGDUIConfig=void 0;var r=t("../../../script/app/config/ResConfig"),n=t("../../../script/app/const/Global"),s=t("../../../script/lib/manager/ResManager"),c=t("../../gameBaseSrc/model/BaseGameUIConfig");a.ScopaGDUIConfig={bunldleName:n.gAssetBundleName.SCOPA_GOLD_RES,prefab:{EatCardOnDesk:new r.PrefabItem("UIEatCardOnDesk","prefabs/eatCard/EatCardOnDesk",n.gLayerLevel.Normal,c.GameZIndex.eatCard),ScopaCountView:new r.PrefabItem("UIScopaCountView","prefabs/eatCard/ScopaCountView",n.gLayerLevel.Normal,c.GameZIndex.scopeCount),GameChooseEatCardView:new r.PrefabItem("UIGameChooseEatCardView","prefabs/opView/GameChooseEatCardView",n.gLayerLevel.Normal,c.GameZIndex.opView),MyHandCardsView:new r.PrefabItem("UIMyHandPokerView","prefabs/myCard/MyHandCardsView",n.gLayerLevel.Normal,c.GameZIndex.myCards),OthersHandCardsView:new r.PrefabItem("UIOthersHandCardsView","prefabs/othersCard/OthersHandCardsView",n.gLayerLevel.Normal,c.GameZIndex.playerCards),DeskOutCardView:new r.PrefabItem("UIDeskOutCardView","prefabs/outCard/DeskOutCardView",n.gLayerLevel.Normal,c.GameZIndex.outCards),GameMySelfBg:new r.PrefabItem("UIGameUserInfoBg","prefabs/desk/GameMySelfBg",n.gLayerLevel.Normal,c.GameZIndex.myInfoPanel),ScopaAnim:new r.PrefabItem("UIScopaAnim","prefabs/effect/ScopaAnim",n.gLayerLevel.Normal,c.GameZIndex.scopaAnima),GameUserInfoBg:new r.PrefabItem("UIGameUserInfoBg","prefabs/desk/GameUserInfoBg",n.gLayerLevel.Normal,c.GameZIndex.gameBg),SkinGameDeskMenu:new r.PrefabItem("UIGameDeskMenu","skinPrefabs/desk/SkinGameDeskMenu",n.gLayerLevel.Normal,c.GameZIndex.deskMenu),SkinGameInfo:new r.PrefabItem("UIGameInfo","skinPrefabs/desk/SkinGameInfo",n.gLayerLevel.Normal,c.GameZIndex.gameInfo)},defPrefab:{},skinPrefab:{},altas:["altas/ScopaPoker","altas/ScopaBase"],popup:{GameResultView:new r.PrefabItem("UIGameResultView","prefabs/result/GameResultView",n.gLayerLevel.Popup,r.PopupZIndex.onceResult),GameResultView_2:new r.PrefabItem("UIGameResultView","prefabs/result/GameResultView_2",n.gLayerLevel.Popup,r.PopupZIndex.onceResult),GameRealTimeScore:new r.PrefabItem("UIGameRealTimeScore","prefabs/desk/GameRealTimeScore",n.gLayerLevel.Popup,r.PopupZIndex.effect),SettebelloAnim:new r.PrefabItem("UISettebelloAnim","prefabs/effect/SettebelloAnim",n.gLayerLevel.Popup,r.PopupZIndex.effect)},skeleton:["effect/shoupai/shoupai","effect/scopa/scopa","effect/teshupai/teshupai","effect/jiesuan/jiesuan"],particle:{lz01:"effect/particle/lz01",lz02:"effect/particle/lz02"}};var d=function(t){function e(){var e=t.call(this)||this;return e.name=n.gAssetBundleName.SCOPA_GOLD_RES,e.tips="Scopa",e.dependency=[n.gAssetBundleName.SCOPA_GOLD_SRC,n.gAssetBundleName.GAME_BASE_RES],e}return i(e,t),e.prototype.getRes=function(){return a.ScopaGDUIConfig},e}(s.BundleConfig);a.ScopaBundleConfig=d,s.default.getInstance().addBundleCfg(new d),cc._RF.pop()},{"../../../script/app/config/ResConfig":void 0,"../../../script/app/const/Global":void 0,"../../../script/lib/manager/ResManager":void 0,"../../gameBaseSrc/model/BaseGameUIConfig":void 0}],ScopaRoomData:[function(t,e,a){"use strict";cc._RF.push(e,"79138PQ6eJIBoLm9M1Xr1Nu","ScopaRoomData");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(a,"__esModule",{value:!0}),a.ScopaGDRoomData=void 0;var r=t("../../../script/lib/utils/ComUtils"),n=function(t){function e(e){var a=t.call(this,e)||this;return a.settleMode=1,a.isAScopa=!1,a.clear(),a}return i(e,t),e.prototype.clear=function(){t.prototype.clear.call(this),this.settleMode=1},e.prototype.parse=function(e){var a=t.prototype.parse.call(this,e);a&&(this.bWild=1==a.wild,this.settleMode=a.settlegoldmode||1,this.isAScopa=1===a.ascopa)},e.prototype.isSettleNormal=function(){return 1==this.settleMode},e.prototype.onLoginFinish=function(){t.prototype.onLoginFinish.call(this)},e.prototype.getDeskInfo=function(){var t=r.ComUtils.formatGoldStr(this.iBaseScore||0);return this.bWild?["WILD BET "+t]:["BET "+t]},e.prototype.getRoomInfo=function(){var t={showHelp:!1};return this.isAScopa&&(t.showHelp=!0),this.isSettleNormal()||(t.showHelp=!0),this.isWild()&&(t.showHelp=!0),[JSON.stringify(t)]},e}(t("./../../gameBaseSrc/model/goldGame/BaseGoldRoomData").BaseGoldRoomData);a.ScopaGDRoomData=n,cc._RF.pop()},{"../../../script/lib/utils/ComUtils":void 0,"./../../gameBaseSrc/model/goldGame/BaseGoldRoomData":void 0}],ScopaVoice:[function(t,e,a){"use strict";cc._RF.push(e,"5d7f7ei3fNLHYxZrC/oTUBb","ScopaVoice");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(a,"__esModule",{value:!0}),a.ScopaVoice=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(t("./../../gameBaseSrc/controller/GameVoice").GameVoice);a.ScopaVoice=r,cc._RF.pop()},{"./../../gameBaseSrc/controller/GameVoice":void 0}],UIDeskOutCardView:[function(t,e,a){"use strict";cc._RF.push(e,"541bb2TIL5F6oU/5i3VzBAa","UIDeskOutCardView");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIDeskOutCardView=void 0;var n,s,c=t("./../../../gameBaseSrc/view/PokerCreator"),d=t("./../../model/ScopaGDUIConfig"),l=t("../../../../script/app/const/AudioFile"),p=t("../../../../script/app/const/Global"),h=t("../../../../script/app/event/Notify"),u=t("../../../../script/app/view/ComUI"),C=t("../../../../script/lib/base/CxCompExt"),f=t("../../../../script/lib/utils/ComUtils"),y=t("../../../../script/lib/utils/Display"),S=t("../../../../script/lib/utils/MathUtils"),v=t("../../../gameBaseSrc/alg/ScopaLogic"),m=t("../../../gameBaseSrc/model/GameEvent"),_=t("../../../gameBaseSrc/model/ScopaConstant"),g=t("../../../gameBaseSrc/view/PokerCreator"),E=t("../poker/UIDeskOutPoker"),I=t("../../../../script/lib/manager/NodePoolMgr"),P=t("../../../../script/lib/manager/ResManager");(function(t){t[t.MergePos=-1]="MergePos",t[t.NotFoundPos=-2]="NotFoundPos"})(n||(n={})),function(t){t[t.bgEffect=0]="bgEffect",t[t.normalCard=100]="normalCard",t[t.throwCardEffect=290]="throwCardEffect",t[t.throwCard=300]="throwCard",t[t.frontEffect=400]="frontEffect",t[t.particle=401]="particle"}(s||(s={}));var D=cc._decorator,b=D.ccclass,O=D.property,G=function(t){function e(){var e=t.call(this)||this;return e.pfOutCard=null,e.pBgEffect=null,e.pFrontEffect=null,e.eatCardPoints=[],e.allDeskCards=[],e.allDeskCardsPosInfo=[],e.logicOutCardDatas=[],e.showCardNumMax=8,e.bStopEffect=!0,e}var a;return i(e,t),a=e,e.prototype.setDataDelegate=function(t){this.playDataDelegate=t},e.prototype.getDataDelegate=function(){return this.playDataDelegate},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.initPositionInfo(),this.initDeskCard()},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(m.GameEvent.OutCard.CLEAR,this.clear),this.bindEvent(m.GameEvent.Com.GAME_SCENE_CLEAR,this.clear),this.bindEvent(m.GameEvent.Com.READY_NEXT_CLEAR,this.clear),this.bindEvent(m.GameEvent.Com.CARD_HIGH_LIGHT_ORANGE,this.onHighLightCard),this.bindEvent(m.GameEvent.HandCard.DESK_CARD_THROW,this.onDeskThrow),this.bindEvent(m.GameEvent.HandCard.PLAYER_OP_RESULT,this.onGameOpResult),this.bindEvent(m.GameEvent.HandCard.MY_HAND_CARD_SELECT,this.onHandCardSelectEvent),this.bindEvent(m.GameEvent.OutCard.UPDATE_DATA,this.onUpdateData),this.bindEvent(m.GameEvent.OutCard.DELELE_EAT_CARDS,this.onDeleteEatCards),this.bindEvent(m.GameEvent.OutCard.SCENE_PLAYING,this.doScenePlaying),this.bindEvent(m.GameEvent.OutCard.START_SEND_CARD,this.clear),this.bindEvent(m.GameEvent.OutCard.SENDING_CARD,this.doSendCard),this.bindEvent(m.GameEvent.OutCard.REDEAL_CARD,this.doRedealCard),this.bindEvent(m.GameEvent.Base.GAME_RESULT,this.clear),this.bindEvent(m.GameEvent.EatCard.PUT_POINTS,this.onGetEatCardPoints),this.bindEvent(m.GameEvent.Com.SET_DATA_DELEGATE,this.setDataDelegate)},e.prototype.onDestroy=function(){this.allDeskCards&&(this.allDeskCards=null),this.allDeskCardsPosInfo&&(this.allDeskCardsPosInfo=null),this.pThrowCard&&(this.pThrowCard=null),this.pBgEffect&&(this.pBgEffect=null),this.pFrontEffect&&(this.pFrontEffect=null),I.NodePoolMgr.getInstance().getPool(E.UIDeskOutPoker.NAME).clear(),t.prototype.onDestroy.call(this)},e.prototype.clearOutCards=function(){this.clearThrowCard();for(var t=0,e=this.allDeskCards;t<e.length;t++)e[t].clear()},e.prototype.clear=function(){this.node.stopAllActions(),this.clearThrowCard(),this.clearOutCards(),this.logicOutCardDatas.length=0},e.prototype.clearThrowCard=function(){var t=I.NodePoolMgr.getInstance().getPool(E.UIDeskOutPoker.NAME);this.pThrowCard&&(this.pThrowCard.clear(),t.put(this.pThrowCard.node),this.pThrowCard=null)},e.prototype.initPositionInfo=function(){for(var t=cc.v2(y.Display.cx-342+68,y.Display.cy+76+135),e=c.PokerCreator.POKER_OUT_CARD_WIDTH,o=c.PokerCreator.POKER_OUT_CARD_HEIGHT,i=c.PokerCreator.POKER_OUT_CARD_OFF_X,r=c.PokerCreator.POKER_OUT_CARD_OFF_Y,n=0,d=0,l=a.COL_MAX,p=a.ROW_MAX,h=0;h<p;h++)for(var u=0;u<l;u++){var C=l*h+u;this.allDeskCardsPosInfo[C]=this.allDeskCardsPosInfo[C]||g.CardPosInfo.get(),n=t.x+(e+i)*u,d=t.y-(o+r)*h,this.allDeskCardsPosInfo[C].angle=0,this.allDeskCardsPosInfo[C].scale=.66,this.allDeskCardsPosInfo[C].zIndex=s.normalCard+C,this.allDeskCardsPosInfo[C].pos=cc.v2(n,d)}},e.prototype.initDeskCard=function(){for(var t,e,o=I.NodePoolMgr.getInstance().getPool(E.UIDeskOutPoker.NAME),i=a.COL_MAX,r=a.ROW_MAX,n=0;n<r;n++)for(var s=0;s<i;s++){var c=i*n+s;(t=o.get())||(t=cc.instantiate(this.pfOutCard)),(e=t.getComponent(E.UIDeskOutPoker))||(e=t.addComponent(E.UIDeskOutPoker)),this.node.addChild(t,c),t.active=!1,e.itemIndex=c,this.allDeskCards[c]=e}},e.prototype.throwCardToDesk=function(t,e,a){var o;this.clearThrowCard();var i=!1;e!==n.MergePos&&((o=this.allDeskCards[e])&&o.cardData&&o.cardData.o>0?(o.bEat=!0,i=!0):o=this.displayCardItem(t,e,!a)),this.pThrowCard=this.createOneCard(t,e,i),(-1===e||o&&!0===o.bEat)&&this.pThrowCard.setFinalScale(.8,!0),a?(this.pThrowCard.node.opacity=0,this.pThrowCard.throwToDesk(a)):this.pThrowCard.node.opacity=255,this.pThrowCard.itemIndex=e,this.node.addChild(this.pThrowCard.node,s.throwCard),t.o===v.ScopaLogic.COINS_7?-1===e?this.playSpecialCardEffect(e,this.pThrowCard.cardPosInfo):o&&this.playSpecialCardEffect(e,o.cardPosInfo):this.hideEffect()},e.prototype.createOneCard=function(t,e,a){var o,i=e;i===n.MergePos?(o=this.getMergeCardPos(),e=s.throwCard):o=this.getCardPosInfo(i,a);var r=I.NodePoolMgr.getInstance().getPool(E.UIDeskOutPoker.NAME).get();r||(r=cc.instantiate(this.pfOutCard));var c=r.getComponent(E.UIDeskOutPoker);return c||(c=r.addComponent(E.UIDeskOutPoker)),c.init({meta:t,posInfo:o}),c},e.prototype.getCardPosInfo=function(t,e){var a=null;return t>=0&&t<this.allDeskCardsPosInfo.length&&(a=this.allDeskCardsPosInfo[t]),e&&((a=a.copy()).angle+=f.ComUtils.random(-3,3)),a},e.prototype.getMergeCardPos=function(){var t=g.CardPosInfo.get();return t.pos=cc.v2(y.Display.cx,y.Display.cy),t.zIndex=s.throwCard,t.scale=.8,t},e.prototype.displayCardItem=function(t,e,o){var i=this.getDeskCardItemByIndex(e);if(i){var r=this.allDeskCardsPosInfo[e];r.angle=a.CARD_ANGLES[e%4]+f.ComUtils.random(-4,4),i.init({meta:t,posInfo:r,itemIndex:e}),0===t.o?i.node.active=!1:0==o&&(i.node.opacity=0,i.delayToDisplay(_.ScopaConstant.THROW_OUT_CARD_TIME))}return i},e.prototype.getDeskCardItemByIndex=function(t){return this.allDeskCards[t]},e.prototype.getLogicOutCardDatas=function(){return this.logicOutCardDatas},e.prototype.getDeskCardItemByIndx=function(t){for(var e=0;e<this.allDeskCards.length;e++)if(this.allDeskCards[e].itemIndex===t)return this.allDeskCards[e];return null},e.prototype.updateData=function(t){v.LocalCardSt.put(this.logicOutCardDatas),this.logicOutCardDatas=null,this.logicOutCardDatas=v.ScopaLogic.bytesToLocal(t)},e.prototype.updateView=function(){this.clearOutCards();for(var t=this.getLogicOutCardDatas(),e=0;e<t.length;e++)this.displayCardItem(t[e],e,!0)},e.prototype.getDisplayUICardDatas=function(){var t=[],e=v.LocalCardSt.get(0);return this.allDeskCards.forEach(function(a){var o=a.cardData;!1===a.bEat&&o?t.push(o):!0===a.bEat&&t.push(e)}),t},e.prototype.checkCurUIOutCardStatus=function(){for(var t=this.getLogicOutCardDatas(),e=this.getDisplayUICardDatas(),a=t.length,o=e.length,i=o-1;i>=0&&!(e[i].o>0);i--)0===e[i].o&&e.splice(i,1);var r=0;if((o=e.length)==a-1)r=-1;else if(o==a){if(o>0)for(i=0;i<a;i++){var n=t[i],s=e[i];if(!n||!s||n.o!=s.o){cc.log("checkCurUIOutCardStatus, DataError:\u724c\u6570\u636e\u4e0d\u7b26 ui="+JSON.stringify(s)+" logic="+JSON.stringify(n)),r=1;break}}}else cc.log("checkCurUIOutCardStatus, numError:\u6570\u91cf\u4e0d\u7b26"),r=1;return r},e.prototype.checkOutCardInvalid=function(t,e){return!(!this.pThrowCard||this.pThrowCard.cardData.o===t&&this.pThrowCard.itemIndex===e)||0!==this.checkCurUIOutCardStatus()},e.prototype.removeEatCards=function(t,e){if(t&&t.length>1){var a=t.length;e.bSurplus?this.removeSurplusCards(t,e.bOurSide,e.delayTime):a>2?this.removeMultCards(t,e.bOurSide,e.bScopa,e.delayTime):this.removeTwoCards(t,e.bOurSide,e.bScopa,e.delayTime)}},e.prototype.removeMultCards=function(t,e,a,o){for(var i=t.length,r=t[i-1].cardPosInfo.copy(),n=0;n<i-1;n++){var c=t[n];c&&(c.node.active=!0,r.angle+=3*n,c.setFinalPos(r.pos,!0),c.node.zIndex=s.throwCard-i-n-10,c.moveToMergePos(_.ScopaConstant.MERGE_EAT_DELAY_TIME*n))}this.dispatch(h.Notify.Base.PLAY_EFFECT,{path:l.AudioFile.Game.MERGE_CARD});var d=t[i-1].cardPosInfo;this.playEatCardEffect(i-1,d),this.delayToClearEatCards(t,o,e,a)},e.prototype.removeTwoCards=function(t,e,a,o){var i=this;this.pThrowCard&&cc.tween(this.pThrowCard.node).to(.13,{scale:.67}).call(function(){i.playEatCardEffect(1,t[0].cardPosInfo)}).start(),this.delayToClearEatCards(t,o,e,a),this.dispatch(h.Notify.Base.PLAY_EFFECT,{path:l.AudioFile.Game.MERGE_CARD})},e.prototype.removeSurplusCards=function(t,e,a){this.delayToClearEatCards(t,a,e,!1)},e.prototype.delayToClearEatCards=function(t,e,a,o){var i,r=this,n=t.length,s=0;a?(i=this.eatCardPoints[0],s=-90):(i=this.eatCardPoints[1],s=90),cc.tween(this.node).delay(e).call(function(){for(var e=0;e<n;e++){var a=t[e];cc.isValid(a)&&(o&&n-1===e?(a.node.zIndex=0,a.setFinalPos(i,!0),a.setFinalAngle(s,!0),a.setFinalScale(.3,!0),a.setAnchorPoint(.5,0),a.moveToEatPos(0,s,!1)):(a.cardData&&(a.cardData.r=0),a.setFinalPos(i,!0),a.moveToEatPos(0,a.cardPosInfo.angle,!0)))}r.hideEffect()}).delay(_.ScopaConstant.EAT_CARD_RUN_TIME).call(function(){r.clearThrowCard()}).start()},e.prototype.initEffect=function(t){var e;this.pBgEffect||((e=new cc.Node).parent=this.node,this.pBgEffect=e.addComponent(sp.Skeleton)),this.pBgEffect.node.zIndex=s.bgEffect,this.pFrontEffect||((e=new cc.Node).parent=this.node,this.pFrontEffect=e.addComponent(sp.Skeleton)),this.pFrontEffect.node.zIndex=s.frontEffect,this.pBgEffect.node.x=this.pFrontEffect.node.x=t.pos.x,this.pBgEffect.node.y=this.pFrontEffect.node.y=t.pos.y,this.pBgEffect.node.scale=this.pFrontEffect.node.scale=t.scale,this.pBgEffect.node.angle=this.pFrontEffect.node.angle=t.angle},e.prototype.hideEffect=function(){this.pBgEffect&&(this.pBgEffect.paused=!0,this.pBgEffect.node.active=!1),this.pFrontEffect&&(this.pBgEffect.paused=!0,this.pFrontEffect.node.active=!1),this.bStopEffect=!0},e.prototype.playParticle=function(t,e,a){var o,i=this;o=e>=1?d.ScopaGDUIConfig.particle.lz01:d.ScopaGDUIConfig.particle.lz02,cc.tween(this.node).delay(t||0).call(function(){u.ComUI.createParticle({parent:i.node,x:a.pos.x,y:a.pos.y,zIndex:s.particle,scale:a.scale},o,p.gAssetBundleName.SCOPA_GOLD_RES)}).start()},e.prototype.playEatCardEffect=function(t,e){this.initEffect(e),this.playParticle(.15,t,e),this.bStopEffect=!1;var a=this;P.default.getInstance().loadSkeleton("effect/shoupai/shoupai",p.gAssetBundleName.SCOPA_GOLD_RES,function(e,o){o&&cc.isValid(a)&&!a.bStopEffect&&(cc.isValid(a.pBgEffect)&&(a.pBgEffect.skeletonData=o,a.pBgEffect.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),a.pBgEffect.node.active=!0,a.pBgEffect.animation="s_"+(t>=2?2:t),a.pBgEffect.loop=!1,a.pBgEffect.paused=!1,a.pBgEffect.premultipliedAlpha=!1,a.pBgEffect.node.zIndex=s.throwCardEffect),cc.isValid(a.pFrontEffect)&&t>=3&&(a.pFrontEffect.node.active=!0,a.pFrontEffect.skeletonData=o,a.pFrontEffect.animation="s_3_jb",a.pFrontEffect.loop=!1,a.pFrontEffect.paused=!1,a.pFrontEffect.premultipliedAlpha=!1))})},e.prototype.playSpecialCardEffect=function(t,e){this.initEffect(e),this.bStopEffect=!1;var a=this;cc.tween(this.node).delay(_.ScopaConstant.THROW_OUT_CARD_TIME).call(function(){P.default.getInstance().loadSkeleton("effect/teshupai/teshupai",p.gAssetBundleName.GAME_BASE_RES,function(e,o){o&&cc.isValid(a)&&!a.bStopEffect&&cc.isValid(a.pBgEffect)&&(a.pBgEffect.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),a.pBgEffect.skeletonData=o,a.pBgEffect.node.active=!0,a.pBgEffect.loop=!1,a.pBgEffect.premultipliedAlpha=!1,a.pBgEffect.animation=-1==t?"7_zj":"7_gg",a.pBgEffect.node.zIndex=s.throwCardEffect)})}).start()},e.prototype.doSendCard=function(t){this.clear(),this.updateData(t.cardDatas),this.doSendCardAction(t)},e.prototype.doSendCardAction=function(t){for(var e=this,o=cc.v3(t.fromPos),i=this.getLogicOutCardDatas(),r=i.length,n=function(n){var c=s.getCardPosInfo(n,!1);c.angle=a.CARD_ANGLES[n%4];var d=s.allDeskCards[n];d.init({meta:i[n],posInfo:c}),d.node.position=o,d.node.scale=.6,d.node.angle=0,d.node.zIndex=r-n,d.showBack();var p=S.MathUtils.lookAt(c.pos,o),h=t.spaceTime*n;cc.tween(d.node).delay(h).parallel(cc.tween().set({angle:p,scale:.6}).call(function(){e.dispatch(m.GameEvent.Voice.PLAY_EFFECT_OTHER,l.AudioFile.Game.SEND_CARD),e.dispatch(m.GameEvent.Desk.REDUCE_CARD_NUM,1),d.node.zIndex=c.zIndex}).to(.13,{scaleX:.15,scaleY:.65}).call(function(){d.showFront()}).to(.04,{scaleX:.2,scaleY:.45}).to(.23,{scaleX:.67,scaleY:.67,angle:c.angle}),cc.tween().to(.4,{x:c.pos.x,y:c.pos.y})).start()},s=this,c=0;c<r;c++)n(c)},e.prototype.onUpdateData=function(t){this.updateData(t)},e.prototype.onDeskThrow=function(t){this.throwCardToDesk(v.ScopaLogic.byteToLocal(t.cardData),t.throwCardIndex,t.fromPos,t.isOutCardMySelf)},e.prototype.onGameOpResult=function(t){for(var e=f.ComUtils.clone(t.deleteCards),a=this.allDeskCards,o=a.length-1;o>=0;o--){var i=!1,r=a[o];if(r&&r.cardData)for(var n=r.cardData.o,s=0;s<e.length;s++)if(n===e[s]){i=!0,e.splice(s,1);break}i&&(r.bEat=!0)}this.checkOutCardInvalid(t.outCardData,t.throwCardIndex)&&this.updateView()},e.prototype.onHandCardSelectEvent=function(t){this.onHighLightCard({isDisplay:t.isSelect,cardDatas:[t.cardData]})},e.prototype.onDeleteEatCards=function(t){if(t&&t.deleteCards&&t.deleteCards.length>0){var e=[],a=f.ComUtils.clone(t.deleteCards),o=this.allDeskCards,i=[];this.allDeskCards.forEach(function(t){t&&t.cardData&&i.push(t.cardData)});for(var r=o.length-1;r>=0;r--){var n=!1,s=o[r];if(s&&s.cardData)for(var c=s.cardData.o,d=0;d<a.length;d++)if(c===a[d]){n=!0,a.splice(d,1);break}n&&(e.push(s),s.cardData.o=0,s.bEat=!0)}this.pThrowCard&&(e.push(this.pThrowCard),this.pThrowCard.cardData.o=0,this.pThrowCard.bEat=!0),this.removeEatCards(e,t)}},e.prototype.onHighLightCard=function(){},e.prototype.doRedealCard=function(t){for(var e,a=cc.v3(t.pos),o=this.allDeskCards,i=function(t){var i=o[t];i&&(e=.06*t,cc.tween(i.node).delay(e).parallel(cc.tween().to(.16,{scaleX:.1,scaleY:.5}).to(.04,{scaleX:.15,scaleY:.65}).call(function(){i.showBack()}).to(.3,{scaleX:.6,scaleY:.6}),cc.tween().to(.5,{x:a.x,y:a.y,angle:0})).set({active:!1}).start())},r=0;r<o.length;r++)i(r)},e.prototype.doScenePlaying=function(t){this.clear(),this.updateData(t),this.updateView()},e.prototype.onGetEatCardPoints=function(t){t&&t[0]instanceof cc.Vec2&&(this.eatCardPoints=null,this.eatCardPoints=[],this.eatCardPoints[0]=this.node.convertToNodeSpace(t[0]),this.eatCardPoints[1]=this.node.convertToNodeSpace(t[1]))},e.CARD_ANGLES=[4,0,-4,-2],e.COL_MAX=4,e.ROW_MAX=2,r([O(cc.Prefab)],e.prototype,"pfOutCard",void 0),r([O(sp.Skeleton)],e.prototype,"pBgEffect",void 0),r([O(sp.Skeleton)],e.prototype,"pFrontEffect",void 0),a=r([b],e)}(C.CxCompExt);a.UIDeskOutCardView=G,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/const/Global":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/view/ComUI":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/manager/NodePoolMgr":void 0,"../../../../script/lib/manager/ResManager":void 0,"../../../../script/lib/utils/ComUtils":void 0,"../../../../script/lib/utils/Display":void 0,"../../../../script/lib/utils/MathUtils":void 0,"../../../gameBaseSrc/alg/ScopaLogic":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../../../gameBaseSrc/model/ScopaConstant":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0,"../poker/UIDeskOutPoker":"UIDeskOutPoker","./../../../gameBaseSrc/view/PokerCreator":void 0,"./../../model/ScopaGDUIConfig":"ScopaGDUIConfig"}],UIDeskOutPoker:[function(t,e,a){"use strict";cc._RF.push(e,"bcb8da87zVNxI9cuIS6Jhpp","UIDeskOutPoker");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIDeskOutPoker=void 0;var n=t("../../../gameBaseSrc/model/ScopaConstant"),s=t("./UIPokerCardBase"),c=cc._decorator,d=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemIndex=null,e.bEat=!1,e}return i(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.node.scale=.66,this.itemIndex=e.itemIndex},e.prototype.throwToDesk=function(t,e){if(!t)return cc.error("throwToDesk fromPosInfo err"),void this.throwToDeskEnd();this.node.stopAllActions(),e=e||n.ScopaConstant.THROW_OUT_CARD_TIME;var a=t.pos,o=t.scale,i=t.angle;cc.tween(this.node).set({scale:o,x:a.x,y:a.y,angle:i,opacity:255}).to(e,{position:cc.v3(this.finalPos),angle:this.finalAngle,scale:this.finalScale},{easing:cc.easing.quadOut}).delay(n.ScopaConstant.EAT_CARD_RUN_TIME).call(this.throwToDeskEnd.bind(this)).start()},e.prototype.throwToDeskEnd=function(){},e.prototype.delayToDisplay=function(t){this.node.active=!0,cc.tween(this.node).set({opacity:0}).delay(t||n.ScopaConstant.THROW_OUT_CARD_TIME).set({opacity:255}).start()},e.prototype.delayToHide=function(t){cc.tween(this.node).set({active:!0,opacity:255}).delay(t||n.ScopaConstant.THROW_OUT_CARD_TIME).set({opacity:0}).start()},e.prototype.moveToMergePos=function(t){cc.tween(this.node).delay(t||.06).parallel(cc.tween().to(.3,{scale:.8}),cc.tween().to(n.ScopaConstant.MERGE_EAT_RUN_TIME,{position:cc.v3(this.finalPos),angle:this.finalAngle},{easing:cc.easing.quadOut})).start()},e.prototype.moveToEatPos=function(t,e,a){this.node.stopAllActions(),cc.tween(this.node).delay(t||0).to(n.ScopaConstant.EAT_CARD_RUN_TIME,{position:cc.v3(this.finalPos),angle:e}).start(),a?this.flipToBack(t):this.flipToFront(t)},e.prototype.clear=function(){t.prototype.clear.call(this),this.itemIndex=null,this.bEat=!1},e.NAME="UIDeskOutPoker",r([d],e)}(s.UIPokerCardBase));a.UIDeskOutPoker=l,cc._RF.pop()},{"../../../gameBaseSrc/model/ScopaConstant":void 0,"./UIPokerCardBase":"UIPokerCardBase"}],UIEatCardDetails:[function(t,e,a){"use strict";cc._RF.push(e,"fafab9XS8JDFpHdLgS4f86J","UIEatCardDetails");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIEatCardDetails=void 0;var n=t("../../../../script/app/const/AudioFile"),s=t("../../../../script/app/const/game/GameConstant"),c=t("../../../../script/app/event/Notify"),d=t("../../../../script/lib/base/CxCompExt"),l=t("../../../../script/lib/manager/NodePoolMgr"),p=t("../../../../script/lib/utils/Display"),h=t("../../../gameBaseSrc/alg/ScopaLogic"),u=t("../../../gameBaseSrc/model/GameEvent"),C=t("../../../gameBaseSrc/view/PokerCreator"),f=t("../poker/UIDeskOutPoker"),y=cc._decorator,S=y.ccclass,v=y.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfOutCard=null,e.eatCardPoints=[],e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.init()},e.prototype.init=function(){t.prototype.init.call(this),this.allEatCardList=[],this.CARD_OFFSET_X=115,this.CARD_OFFSET_Y=217,this.MAXCOL=8,this.START_X=p.Display.cx-510+C.PokerCreator.POKER_HAND_CARD_WIDTH/2},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(u.GameEvent.Com.GAME_SCENE_CLEAR,this.clear),this.bindEvent(u.GameEvent.Com.READY_NEXT_CLEAR,this.clear),this.bindEvent(u.GameEvent.OutCard.SHOW_EAT_CARDS,this.onShowEatCards),this.bindEvent(u.GameEvent.EatCard.PUT_POINTS,this.onGetEatCardPoints),this.bindEvent(c.Notify.Base.REQ_SCREEN_SHOT,this.onReqScreenShot)},e.prototype.clear=function(){t.prototype.clear.call(this),this.screenNode&&(this.screenNode.destroy(),this.screenNode=null);for(var e=l.NodePoolMgr.getInstance().getPool(f.UIDeskOutPoker.NAME),a=0,o=this.allEatCardList;a<o.length;a++){var i=o[a];i.clear(),e.put(i.node)}},e.prototype.onGetEatCardPoints=function(t){t&&t[0]instanceof cc.Vec2&&(this.eatCardPoints=null,this.eatCardPoints=[],this.eatCardPoints[0]=this.node.convertToNodeSpace(t[0]),this.eatCardPoints[1]=this.node.convertToNodeSpace(t[1]))},e.prototype.onShowEatCards=function(t){this.clear(),this.showOurSideEatCards(t[0]),this.showOtherSideEatCards(t[1])},e.prototype.showOurSideEatCards=function(t){var e=t.length,a=Math.ceil(e/this.MAXCOL),o=cc.v3(this.START_X,185+C.PokerCreator.POKER_OUT_CARD_HEIGHT/2+p.Display.bannerOffsetY);o.y+=(a-1)*this.CARD_OFFSET_Y;for(var i=Math.min(e,this.MAXCOL),r=0;r<i;r++)for(var n=0;n<a;n++){var s=this.MAXCOL*n+r;if(s>=e)break;var c=this.displayCardItem(t[s],s);c.node.x=o.x+this.CARD_OFFSET_X*r,c.node.y=o.y-this.CARD_OFFSET_Y*n,this.doShowCardAnim(this.eatCardPoints[0],c,r,.2*n)}},e.prototype.showOtherSideEatCards=function(t){for(var e=t.length,a=Math.ceil(e/this.MAXCOL),o=cc.v3(this.START_X,p.Display.cy+550+C.PokerCreator.POKER_OUT_CARD_HEIGHT/2),i=Math.min(e,this.MAXCOL),r=0;r<i;r++)for(var n=0;n<a;n++){var s=this.MAXCOL*n+r;if(s>=e)break;var c=this.displayCardItem(t[s],s);c.node.x=o.x+this.CARD_OFFSET_X*r,c.node.y=o.y-this.CARD_OFFSET_Y*n,this.doShowCardAnim(this.eatCardPoints[1],c,r,.2*n)}},e.prototype.displayCardItem=function(t,e){var a=l.NodePoolMgr.getInstance().getPool(f.UIDeskOutPoker.NAME).get();a||(a=cc.instantiate(this.pfOutCard));var o=a.getComponent(f.UIDeskOutPoker);return o||(o=a.addComponent(f.UIDeskOutPoker)),o.init({meta:h.LocalCardSt.get(t)}),this.node.addChild(a,e),this.allEatCardList.push(o),o},e.prototype.doShowCardAnim=function(t,e,a,o){var i=this;if(e){var r=.06*a+o||0,s=e.node.x,c=e.node.y;e.showBack(),cc.tween(e.node).set({x:t.x,y:t.y,angle:0,opacity:0}).delay(r).set({opacity:255}).call(function(){i.dispatch(u.GameEvent.Voice.PLAY_EFFECT_OTHER,n.AudioFile.Game.SEND_CARD)}).parallel(cc.tween().to(.16,{scaleX:.4,scaleY:.5}).to(.04,{scaleX:.05,scaleY:.5}).call(function(){e.showFront(),e.node.scaleX=.05,e.node.scaleY=.35}).to(.3,{scaleX:.66,scaleY:.66}),cc.tween().to(.5,{x:s,y:c,angle:0},{easing:cc.easing.sineOut})).start()}},e.prototype.onReqScreenShot=function(t){t===s.GameConstant.RoomPlayStatus.gameEnd&&this.dispatch(c.Notify.Base.SCREEN_SHOT_START,{requestKey:"UIEatCardDetails",shotNode:this.node})},e.prototype.onScreenShotResult=function(t){if(t&&"UIEatCardDetails"===t.requestKey){var e=t.node;e&&(this.clear(),this.screenNode=e,e.parent=this.node,e.zIndex=cc.macro.MAX_ZINDEX)}},r([v(cc.Prefab)],e.prototype,"pfOutCard",void 0),r([S],e)}(d.CxCompExt);a.UIEatCardDetails=m,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/const/game/GameConstant":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/manager/NodePoolMgr":void 0,"../../../../script/lib/utils/Display":void 0,"../../../gameBaseSrc/alg/ScopaLogic":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0,"../poker/UIDeskOutPoker":"UIDeskOutPoker"}],UIEatCardOnDesk:[function(t,e,a){"use strict";cc._RF.push(e,"47ecdadojhFHZTDPulc6WUt","UIEatCardOnDesk");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIEatCardOnDesk=void 0;var n,s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../../script/lib/utils/Display"),d=t("../../../gameBaseSrc/alg/ScopaLogic"),l=t("../../../gameBaseSrc/model/GameEvent"),p=t("../../../gameBaseSrc/model/ScopaConstant"),h=t("../../../gameBaseSrc/view/PokerCreator"),u=t("./../poker/UIPokerCardBase");(function(t){t[t.ShowAllCards=0]="ShowAllCards",t[t.ScopaCard=200]="ScopaCard",t[t.NormalCard=300]="NormalCard",t[t.ScopaCount=400]="ScopaCount"})(n||(n={}));var C=cc._decorator,f=C.ccclass,y=C.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfEatCard=null,e.ndOurNormal=null,e.ndOtherNormal=null,e.ourNormalCard=[],e.ourScopaCard=[],e.otherNormalCard=[],e.otherScopaCard=[],e.unuseCards=[],e.cardInitPos=[],e}return i(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.cardInitPos[0]=cc.v2(65,c.Display.cy-325),this.cardInitPos[1]=cc.v2(c.Display.width-65,c.Display.cy+749-c.Display.paddingTop),this.ndOurNormal&&(this.ndOurNormal.x=this.cardInitPos[0].x,this.ndOurNormal.y=this.cardInitPos[0].y,this.ndOurNormal.on("click",this.onClickBtn,this)),this.ndOtherNormal&&(this.ndOtherNormal.x=this.cardInitPos[1].x,this.ndOtherNormal.y=this.cardInitPos[1].y,this.ndOtherNormal.on("click",this.onClickBtn,this)),this.clear()},e.prototype.clear=function(){for(var t=0;t<this.ourNormalCard.length;t++)this.ourNormalCard[t]&&(this.ourNormalCard[t].node.active=!1,this.unuseCards.push(this.ourNormalCard[t].node));for(t=0;t<this.otherNormalCard.length;t++)this.otherNormalCard[t]&&(this.otherNormalCard[t].node.active=!1,this.unuseCards.push(this.otherNormalCard[t].node));for(t=0;t<this.otherScopaCard.length;t++)this.otherScopaCard[t]&&(this.otherScopaCard[t].node.active=!1,this.unuseCards.push(this.otherScopaCard[t].node));for(t=0;t<this.ourScopaCard.length;t++)this.ourScopaCard[t]&&(this.ourScopaCard[t].node.active=!1,this.unuseCards.push(this.ourScopaCard[t].node));this.ourNormalCard=[],this.ourScopaCard=[],this.otherNormalCard=[],this.otherScopaCard=[]},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(l.GameEvent.Com.GAME_SCENE_CLEAR,this.clear),this.bindEvent(l.GameEvent.Com.READY_NEXT_CLEAR,this.clear),this.bindEvent(l.GameEvent.EatCard.MOVE_TO_DESK,this.onEatCard),this.bindEvent(l.GameEvent.EatCard.SCENE_PLAYING,this.updateAllEatCard),this.bindEvent(l.GameEvent.EatCard.CLEAR,this.clear),this.bindEvent(l.GameEvent.Base.GAME_RESULT,this.clear),this.bindEvent(l.GameEvent.Base.INIT_FINISH,this.onPutEatCardPoints),this.bindEvent(l.GameEvent.Com.SET_DATA_DELEGATE,this.setDataDelegate)},e.prototype.start=function(){this.onPutEatCardPoints()},e.prototype.onPutEatCardPoints=function(){var t=[];t[0]=this.node.convertToWorldSpace(this.cardInitPos[0]),t[1]=this.node.convertToWorldSpace(this.cardInitPos[1]),this.dispatch(l.GameEvent.EatCard.PUT_POINTS,t)},e.prototype.setDataDelegate=function(t){this.playDataDelegate=t},e.prototype.getDataDelegate=function(){return this.playDataDelegate},e.prototype.updateAllEatCard=function(t){this.clear(),this.addNormalCard(t.normalCardList[0],!0),this.updateScopaCards(t.scopaCardList[0],!0),this.setScopaCount(!0,t.scopaCount[0]||0),this.addNormalCard(t.normalCardList[1],!1),this.updateScopaCards(t.scopaCardList[1],!1),this.setScopaCount(!1,t.scopaCount[1]||0)},e.prototype.onEatCard=function(t){t.bScopa?(this.addOneScopaCard(t.outCardData,t.bOurSide),this.addNormalCard(2,t.bOurSide)):this.addNormalCard(t.deleteCards.length+1,t.bOurSide)},e.prototype.addNormalCard=function(t,e){if(this.pfEatCard&&t){var a=void 0,o=void 0;if(e?(a=this.ourNormalCard,o=this.cardInitPos[0]):(a=this.otherNormalCard,o=this.cardInitPos[1]),a.length>=2)return;for(var i=0;i<t;i++){if(a.length>=2)return;var r=this.unuseCards.shift();r||(r=cc.instantiate(this.pfEatCard)),r.active=!0,r.parent=this.node;var s=h.CardPosInfo.get();s.pos=o,s.angle=1==i?3:0,s.scale=.4,s.zIndex=n.NormalCard+i;var c=r.getComponent(u.UIPokerCardBase);c||(c=r.addComponent(u.UIPokerCardBase)),c.init({meta:d.LocalCardSt.get(0),posInfo:s}),a.push(c)}}},e.prototype.addOneScopaCard=function(t,e){if(this.pfEatCard&&t){var a=void 0,o=void 0,i=void 0;e?(o=-90,a=this.ourScopaCard,i=this.cardInitPos[0]):(o=90,a=this.otherScopaCard,i=this.cardInitPos[1]);var r=this.unuseCards.shift();r||(r=cc.instantiate(this.pfEatCard)),r.active=!1,r.parent=this.node;var s=r.getComponent(u.UIPokerCardBase);s||(s=r.addComponent(u.UIPokerCardBase));var c=h.CardPosInfo.get();c.pos=i,c.angle=o,c.scale=.3,c.zIndex=a.length+n.ScopaCard,s.init({meta:d.LocalCardSt.get(t),posInfo:c}),s.setAnchorPoint(.5,0),a.push(s),this.setScopaCount(e,a.length),r.active=!0,a.length>1&&this.moveScopaCardsToFinalPos(a,e,!0)}},e.prototype.setScopaCount=function(t,e){this.dispatch(l.GameEvent.EatCard.SCOPA_COUNT,{bOurSide:t,count:e})},e.prototype.updateScopaCards=function(t,e){if(this.pfEatCard&&t){var a=t.length,o=void 0,i=void 0;e?(o=this.ourScopaCard,i=this.cardInitPos[0]):(o=this.otherScopaCard,i=this.cardInitPos[1]);for(var r=d.ScopaLogic.bytesToLocal(t),s=0;s<a;s++){var c=r[s],l=this.unuseCards.shift();l||(l=cc.instantiate(this.pfEatCard)),l.active=!0,l.parent=this.node;var p=l.addComponent(u.UIPokerCardBase),C=h.CardPosInfo.get();C.pos=i,C.scale=.3,C.zIndex=s+n.ScopaCard,p.init({meta:c,posInfo:C}),p.setAnchorPoint(.5,0),o.push(p)}d.LocalCardSt.put(r),r=null,this.setScopaCount(e,o.length),this.moveScopaCardsToFinalPos(o,e,!1)}},e.prototype.moveScopaCardsToFinalPos=function(t,e,a){var o,i,r=[0,0,15,20,15,12,10,8.5,7.5,6.6,6],n=t.length||0;o=e?-90-(i=-r[n])*n/2:90-(i=r[n])*n/2;for(var s=0;s<n;s++){var c=o+i*s;a?cc.tween(t[s].node).to(p.ScopaConstant.EAT_CARD_RUN_TIME,{angle:c}).start():t[s].node.angle=c}},e.prototype.onClickBtn=function(t){this.dispatch(l.GameEvent.OperateEvent.CLICK_EATCARD,t.node.parent.convertToWorldSpace(cc.v2(t.node.position)))},e.prototype.onDestroy=function(){this.ourNormalCard=null,this.ourScopaCard=null,this.otherNormalCard=null,this.otherScopaCard=null,this.otherScopaCard=null,this.unuseCards=null,t.prototype.onDestroy.call(this)},r([y(cc.Prefab)],e.prototype,"pfEatCard",void 0),r([y(cc.Node)],e.prototype,"ndOurNormal",void 0),r([y(cc.Node)],e.prototype,"ndOtherNormal",void 0),r([f],e)}(s.CxCompExt);a.UIEatCardOnDesk=S,cc._RF.pop()},{"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/utils/Display":void 0,"../../../gameBaseSrc/alg/ScopaLogic":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../../../gameBaseSrc/model/ScopaConstant":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0,"./../poker/UIPokerCardBase":"UIPokerCardBase"}],UIGameChooseEatCardView:[function(t,e,a){"use strict";cc._RF.push(e,"02d54je0fFKo6igm+LdbpSc","UIGameChooseEatCardView");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameChooseEatCardView=void 0;var n=t("../../../../script/lib/base/Callback"),s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../../script/lib/i18n/i18nHelper"),d=t("../../../gameBaseSrc/i18n/GameBaseI18n"),l=t("../../../gameBaseSrc/model/GameEvent"),p=t("./UIGameEatCardGroup"),h=cc._decorator,u=h.ccclass,C=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfEatCardGroup=null,e.ndMask=null,e.labTips=null,e.ndLayout=null,e.haveCancleMenu=!1,e.lastItemPosX=0,e}var a;return i(e,t),a=e,e.prototype.init=function(e){t.prototype.init.call(this,e),this.clear(),this.haveCancleMenu=e.canCancle},e.prototype.start=function(){a.OP_ITEM_RIGHT_POS_Y=244,a.OP_ITEM_RIGHT_POS_X=0,this.lastItemPosX=a.OP_ITEM_RIGHT_POS_X,this.labTips&&(this.labTips.language=c.i18nHelper.makeLanguage(d.IGameBaseI18n.k.game_choose_take_cards,d.GameBaseLan.bundle))},e.prototype.onDestroy=function(){this.eatOptionData&&(this.eatOptionData=null),t.prototype.onDestroy.call(this)},e.prototype.show=function(){this.ndMask&&(this.ndMask.active=!0),this.haveCancleMenu;for(var t=this.eatOptionData.eatOptions,e=0;e<t.length;e++)this.getChooseItem(t[e])},e.prototype.getChooseItem=function(t){var e=cc.instantiate(this.pfEatCardGroup),a=e.getComponent(p.UIGameEatCardGroup);return a.init({eatCardDatas:t,callback:new n.Callback(this,this.opItemCallBack,t)}),this.ndLayout.addChild(e),a},e.prototype.opItemCallBack=function(t){null!=t&&(this.dispatch(l.GameEvent.OperateEvent.OPERATE,{outCard:this.eatOptionData.outCardData,eatCards:t}),this.clear())},e.prototype.clear=function(){this.ndLayout&&this.ndLayout.destroyAllChildren(),this.ndMask&&(this.ndMask.active=!1)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(l.GameEvent.HandCard.INFORM_PLAYER_OP,this.clear),this.bindEvent(l.GameEvent.HandCard.PLAYER_OP_RESULT,this.clear),this.bindEvent(l.GameEvent.HandCard.PLAYER_OUT_CARD_RESULT,this.clear),this.bindEvent(l.GameEvent.Base.GAME_RESULT,this.clear),this.bindEvent(l.GameEvent.Com.READY_NEXT_CLEAR,this.clear),this.bindEvent(l.GameEvent.OpView.CHOOSE_CARD,this.checkOpActions),this.bindEvent(l.GameEvent.OpView.CLEAR,this.clear)},e.prototype.checkOpActions=function(t){this.clear(),t&&t.eatOptions&&t.eatOptions.length>0&&(this.eatOptionData=t,this.show())},e.OP_ITEM_RIGHT_POS_X=380,e.OP_ITEM_RIGHT_POS_Y=150,e.OP_ITEM_SPACE_X=20,r([C(cc.Prefab)],e.prototype,"pfEatCardGroup",void 0),r([C(cc.Node)],e.prototype,"ndMask",void 0),r([C(cc.Label)],e.prototype,"labTips",void 0),r([C(cc.Node)],e.prototype,"ndLayout",void 0),a=r([u],e)}(s.CxCompExt);a.UIGameChooseEatCardView=f,cc._RF.pop()},{"../../../../script/lib/base/Callback":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../gameBaseSrc/i18n/GameBaseI18n":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"./UIGameEatCardGroup":"UIGameEatCardGroup"}],UIGameDeskMenu:[function(t,e,a){"use strict";cc._RF.push(e,"e8ecfhepaVAwI442zcbjyQq","UIGameDeskMenu");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameDeskMenu=void 0;var n=t("../../../../script/app/event/GuiEvent"),s=t("../../../../script/app/event/Notify"),c=t("../../../../script/app/module/buryPoint/BuryPoint"),d=t("../../../../script/app/module/buryPoint/BuryPointUtils"),l=t("../../../../script/lib/base/CxCompExt"),p=t("../../../../script/lib/utils/Display"),h=t("../../../../script/lib/utils/ScreenAdapter"),u=t("../../../gameBaseSrc/model/GameEvent"),C=t("../../../gameBaseSrc/model/GameInitConfig"),f=cc._decorator,y=f.ccclass,S=f.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnMainMenu=null,e.btnLeave=null,e.btnSkin=null,e.btnSpecialSale=null,e.btnChat=null,e.ndDeskBuild=null,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.btnMainMenu&&(this.btnMainMenu.node.on("click",this.onClickMainMenu,this),h.ScreenAdapter.paddingTop(this.btnMainMenu.node)),this.btnLeave&&(this.btnLeave.node.on("click",this.onClickLeaveMenu,this),h.ScreenAdapter.paddingTop(this.btnLeave.node)),this.btnSkin&&(this.btnSkin.node.on("click",this.onClickSkinMenu,this),h.ScreenAdapter.paddingTop(this.btnSkin.node)),this.btnSpecialSale&&(this.btnSpecialSale.node.on("click",this.onClickSpecialScale,this),this.btnSpecialSale.node.y=p.Display.cy-170,h.ScreenAdapter.paddingRight(this.btnSpecialSale.node)),this.btnChat&&(this.btnChat.node.on("click",this.onChatClicked,this),this.btnChat.node.y=306,h.ScreenAdapter.paddingRight(this.btnChat.node),h.ScreenAdapter.paddingBottom(this.btnChat.node)),this.changeSkin()},e.prototype.changeSkin=function(){C.GameInitConfig.tableId>1&&this.btnMainMenu&&(this.btnChat.node.y=p.Display.cy-648,h.ScreenAdapter.paddingRight(this.btnChat.node)),this.ndDeskBuild&&(this.ndDeskBuild.active=!1)},e.prototype.onClickMainMenu=function(){var t=this.btnMainMenu.node.parent.convertToWorldSpace(cc.v2(this.btnMainMenu.node.position));t.x-=this.btnMainMenu.node.width/2,t.y+=30,this.dispatch(u.GameEvent.OperateEvent.CLICK_SETTING,t)},e.prototype.onClickLeaveMenu=function(){this.dispatch(u.GameEvent.Popup.EXIT_DLG),d.BuryPointUtils.send(c.BuryPoint.Debug.Game.ClickLeave)},e.prototype.onClickSpecialScale=function(){this.dispatch(n.GuiEvent.PopMsg.DISPLAY_SHOP_SPECIAL_SALE),d.BuryPointUtils.send(c.BuryPoint.Debug.Game.ClickSpecialSale)},e.prototype.onChatClicked=function(){this.dispatch(u.GameEvent.Popup.CHAT),d.BuryPointUtils.send(c.BuryPoint.Debug.Game.ClickChat)},e.prototype.onClickSkinMenu=function(){this.dispatch(u.GameEvent.Desk.PREVIEW_SKIN),d.BuryPointUtils.send(c.BuryPoint.Debug.Game.ClickSkin)},e.prototype.displaySpecialSaleMenu=function(t){this.btnSpecialSale&&(this.btnSpecialSale.node.active=t)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(u.GameEvent.Player.GAME_START,this.hide),this.bindEvent(u.GameEvent.OperateEvent.NEXT_GAME,this.show),this.bindEvent(u.GameEvent.Player.MOVE_END,this.show),this.bindEvent(u.GameEvent.Base.GAME_RESULT,this.hide),this.bindEvent(n.GuiEvent.UI.DISPLAY_MENU_SPECIAL_SALE,this.displaySpecialSaleMenu),this.bindEvent(s.Notify.Base.ON_APP_RESUME,this.show)},e.prototype.hide=function(){this.node.opacity=0},e.prototype.show=function(){this.node.opacity=255},r([S(cc.Button)],e.prototype,"btnMainMenu",void 0),r([S(cc.Button)],e.prototype,"btnLeave",void 0),r([S(cc.Button)],e.prototype,"btnSkin",void 0),r([S(cc.Button)],e.prototype,"btnSpecialSale",void 0),r([S(cc.Button)],e.prototype,"btnChat",void 0),r([S(cc.Node)],e.prototype,"ndDeskBuild",void 0),r([y],e)}(l.CxCompExt);a.UIGameDeskMenu=v,cc._RF.pop()},{"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/module/buryPoint/BuryPoint":void 0,"../../../../script/app/module/buryPoint/BuryPointUtils":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/utils/Display":void 0,"../../../../script/lib/utils/ScreenAdapter":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../../../gameBaseSrc/model/GameInitConfig":void 0}],UIGameEatCardGroup:[function(t,e,a){"use strict";cc._RF.push(e,"1ceafq65+tIUaC/gKc7eYrO","UIGameEatCardGroup");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameEatCardGroup=void 0;var n=t("../../../../script/lib/base/CxCompExt"),s=t("../../../../script/lib/utils/MathUtils"),c=t("../../../gameBaseSrc/alg/ScopaLogic"),d=t("../../../gameBaseSrc/view/PokerCreator"),l=t("./../poker/UIMyHandPoker"),p=cc._decorator,h=p.ccclass,u=p.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfCard=null,e.iTouchId=-1,e.bTouchIn=!1,e}return i(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.clickCallback=e.callback,this.regTouchEvent(),this.createEatGroup(e.eatCardDatas)},e.prototype.start=function(){this.regTouchEvent()},e.prototype.onDestroy=function(){this.clickCallback=null,this.unRegTouchEvent(),t.prototype.onDestroy.call(this)},e.prototype.getCardPosInfo=function(t){var e,a,o,i=[],r=s.MathUtils.ANGLE_TO_RADIAN,n=cc.v2(0,-410);a=90+(o=[0,12,10,8,6,4][e=Math.min(4,t)-1])*e/2;for(var c=0;c<=e;c++){var l=(a-o*c)*r;i[c]=i[c]||d.CardPosInfo.get(),i[c].pos=s.MathUtils.pointAtCircle(n.x,n.y,l,500),i[c].angle=a-o*c-90,i[c].zIndex=c,i[c].scale=.68}return i},e.prototype.createEatGroup=function(t){if(this.pfCard)for(var e=this.getCardPosInfo(t.length),a=0;a<t.length;a++){var o=t[a],i=cc.instantiate(this.pfCard),r=i.getComponent(l.UIMyHandPoker);r||(r=i.addComponent(l.UIMyHandPoker)),r.init({meta:c.LocalCardSt.get(o)}),r.setAnchorPoint(.5,0),i.x=e[a].pos.x,i.y=e[a].pos.y,i.scale=e[a].scale,this.node.addChild(i),cc.tween(i).to(.3,{angle:e[a].angle}).start()}},e.prototype.regTouchEvent=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this,!0),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.unRegTouchEvent=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this,!0),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.setCanTouch=function(t){t?this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this,!0):this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this,!0)},e.prototype.onTouchStart=function(t){-1===this.iTouchId&&(this.iTouchId=t.getID(),this.bTouchIn=!0,this.pressOn())},e.prototype.onTouchMove=function(t){this.iTouchId===t.getID()&&(this.node.getBoundingBoxToWorld().contains(t.getLocation())?this.bTouchIn=!0:this.bTouchIn=!1)},e.prototype.onTouchEnd=function(t){this.iTouchId===t.getID()&&(this.bTouchIn&&this.node.getBoundingBoxToWorld().contains(t.getLocation())?(this.pressOff(),this.emitterEvent()):(this.node.stopAllActions(),this.node.setScale(1)),this.iTouchId=-1,this.bTouchIn=!1)},e.prototype.onTouchCancel=function(){this.pressOff(),this.iTouchId=-1,this.bTouchIn=!1},e.prototype.pressOn=function(){this.node.stopAllActions(),this.node.setScale(1),cc.tween(this.node).to(.1,{scaleX:1.1,scaleY:1.1}).to(.1,{scaleX:1,scaleY:1}).start()},e.prototype.pressOff=function(){this.node.stopAllActions(),cc.tween(this.node).to(.1,{scaleX:1,scaleY:1}).start()},e.prototype.addClickEvent=function(t){this.clickCallback=t},e.prototype.emitterEvent=function(){this.clickCallback&&this.clickCallback.call()},e.GROUP_VIDTH=352,e.GROUP_HEIGHT=352,r([u(cc.Prefab)],e.prototype,"pfCard",void 0),r([h],e)}(n.CxCompExt);a.UIGameEatCardGroup=C,cc._RF.pop()},{"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/utils/MathUtils":void 0,"../../../gameBaseSrc/alg/ScopaLogic":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0,"./../poker/UIMyHandPoker":"UIMyHandPoker"}],UIGameInfo:[function(t,e,a){"use strict";cc._RF.push(e,"b5c3d+r5+FMHJM5nJyEuOPv","UIGameInfo");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameInfo=void 0;var n=t("../../../../script/app/view/ComUI"),s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../gameBaseSrc/model/GameEvent"),d=t("../../../../script/app/module/tables/TableSkinMgr"),l=t("../../../../script/app/event/Notify"),p=cc._decorator,h=p.ccclass,u=p.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spRemainCardBg=null,e.labRemainCardNum=null,e.labGameInfo=null,e.labBeishu=null,e.btnHelp=null,e}return i(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.oldRemainBgX=this.spRemainCardBg.node.x,this.oldGameInfoX=this.labGameInfo.node.x,this.btnHelp&&(this.btnHelp.node.active=!1,this.btnHelp.node.on("click",this.onHelpClicked,this)),this.labBeishu&&(this.labBeishu.node.active=!1)},e.prototype.start=function(){this.changeSkin(d.TableSkinMgr.getCfg()),this.resetPosition()},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(c.GameEvent.Base.INIT_FINISH,this.onPutBeiShuPos),this.bindEvent(c.GameEvent.Com.READY_NEXT_CLEAR,this.clear),this.bindEvent(c.GameEvent.Desk.DESK_REST,this.clear),this.bindEvent(c.GameEvent.Desk.REDUCE_CARD_NUM,this.onReduceCardNum),this.bindEvent(c.GameEvent.Desk.REMAIN_CARD_NUM_CHANGE,this.onRemainCardNumChange),this.bindEvent(c.GameEvent.Desk.DESKINFO_TRANSPARENT,this.onTransParent),this.bindEvent(c.GameEvent.Desk.UPDATE_DESKINFO,this.onUpdateDeskInfo),this.bindEvent(c.GameEvent.Desk.BEI_SHU_CHANGE,this.onBeiShuChange),this.bindEvent(l.Notify.Base.CHANGE_SKIN,this.onChangeSkin)},e.prototype.changeSkin=function(t){t&&(n.ComUI.changeLabel(this.labRemainCardNum,t.font_remain_cardnum),n.ComUI.changeLabel(this.labGameInfo,t.font_game_info))},e.prototype.onChangeSkin=function(t){this.changeSkin(t)},e.prototype.onPutBeiShuPos=function(){if(this.labBeishu){var t=this.labBeishu.node.parent.convertToWorldSpaceAR(this.labBeishu.node.position);this.dispatch(c.GameEvent.Desk.BEI_SHU_POS,t)}},e.prototype.onRemainCardNumChange=function(t){this.labRemainCardNum&&(this.labRemainCardNum.node.parent.active=!0),this.labRemainCardNum&&(this.labRemainCardNum.string=""+t)},e.prototype.onReduceCardNum=function(t){if(this.labRemainCardNum&&(this.labRemainCardNum.node.active=!0),this.labRemainCardNum){var e=parseInt(this.labRemainCardNum.string);this.labRemainCardNum.string=e-t>=0?""+(e-t):"0"}},e.prototype.onTransParent=function(){},e.prototype.clear=function(){this.labRemainCardNum&&(this.labRemainCardNum.node.parent.active=!1),this.labGameInfo&&(this.labGameInfo.string=""),this.labBeishu&&(this.labBeishu.string="",this.labBeishu.node.active=!1),this.btnHelp&&(this.btnHelp.node.active=!1)},e.prototype.onUpdateDeskInfo=function(t){if(t){var e=t.deskCfg;if(e&&e[0]&&(this.labGameInfo.string=e[0]),null!=t.remainCardNum&&null!=t.remainCardNum&&this.onRemainCardNumChange(t.remainCardNum),t.roomCfg){var a=JSON.parse(t.roomCfg[0]);a&&this.setHelpButton(a.showHelp)}t.iMultpNum?this.onBeiShuChange({iMultpNum:t.iMultpNum,action:!1}):this.resetPosition()}},e.prototype.onBeiShuChange=function(t){var e=this;if(this.labBeishu){var a,o,i,r,n,s,c=t&&t.iMultpNum||1,d=!this.labBeishu.node.active&&c>1;!1===t.action&&(d=!1);var l=this.labBeishu.string;this.labBeishu.string="/"+c,this.labBeishu.node.active=c>1,a=this.spRemainCardBg.node.x,o=this.labGameInfo.node.x,i=this.labBeishu.node.x,this.resetPosition(),this.onPutBeiShuPos(),d&&(this.labBeishu.string=l,this.scheduleOnce(function(){e.labBeishu.string="/"+c,r=e.spRemainCardBg.node.x,n=e.labGameInfo.node.x,s=e.labBeishu.node.x,e.btnHelp.node.active=!0,cc.tween(e.spRemainCardBg.node).set({x:a}).delay(.96).to(.34,{x:r}).start(),cc.tween(e.labGameInfo.node).set({x:o}).delay(.96).to(.34,{x:n}).start(),cc.tween(e.labBeishu.node).set({opacity:0,scale:.8,x:i}).delay(1.2).to(.1,{scale:1,opacity:255,x:s}).call(function(){e.btnHelp&&(e.btnHelp.node.active=!0)}).start()}))}},e.prototype.resetPosition=function(){var t=this;this.scheduleOnce(function(){var e=[{node:t.spRemainCardBg.node,gap:0},{node:t.labGameInfo.node,gap:30},{node:t.labBeishu.node,gap:20},{node:t.btnHelp.node,gap:0}];n.ComUI.serialize({nodes:e,startX:0,anchor:.5}),e=null})},e.prototype.setHelpButton=function(t){this.btnHelp&&(this.btnHelp.node.x=this.labBeishu.node.x+this.labBeishu.node.width/2+this.btnHelp.node.width/2,this.btnHelp.node.active=t)},e.prototype.onHelpClicked=function(){this.dispatch(c.GameEvent.OperateEvent.CLICK_RULE_HELP)},r([u(cc.Sprite)],e.prototype,"spRemainCardBg",void 0),r([u(cc.Label)],e.prototype,"labRemainCardNum",void 0),r([u(cc.Label)],e.prototype,"labGameInfo",void 0),r([u(cc.Label)],e.prototype,"labBeishu",void 0),r([u(cc.Button)],e.prototype,"btnHelp",void 0),r([h],e)}(s.CxCompExt);a.UIGameInfo=C,cc._RF.pop()},{"../../../../script/app/event/Notify":void 0,"../../../../script/app/module/tables/TableSkinMgr":void 0,"../../../../script/app/view/ComUI":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../gameBaseSrc/model/GameEvent":void 0}],UIGameRealTimeScore:[function(t,e,a){"use strict";cc._RF.push(e,"59916Z81qNJOacimK8oEPp3","UIGameRealTimeScore");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameRealTimeScore=void 0;var n=t("../../../../script/lib/base/CxCompExt"),s=t("../../../../script/lib/i18n/i18nHelper"),c=t("../../../gameBaseSrc/i18n/GameBaseI18n"),d=t("../result/UIGameResultItem"),l=cc._decorator,p=l.ccclass,h=l.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfItem=null,e.layout=null,e}return i(e,t),e.prototype.init=function(e){t.prototype.init.call(this),e?(this.ourScoreDetail=e.ourScoreDetail,this.otherScoreDetail=e.otherScoreDetail,e.worldPos&&(this.worldPos=e.worldPos),this.initView()):this.close()},e.prototype.start=function(){this.worldPos&&(this.worldPos=this.node.parent.convertToNodeSpaceAR(this.worldPos),this.worldPos.x<0?(this.node.x=this.worldPos.x+this.node.width/2+60,this.node.y=this.worldPos.y+this.node.height/2-50):(this.node.x=this.worldPos.x-this.node.width/2-60,this.node.y=this.worldPos.y-this.node.height/2+50))},e.prototype.initView=function(){var t={Denari:"coinsNum",Primiera:"ColorFenMax",Cards:"cardNum",Settebello:"coins7",Scopa:"scopaCount"};for(var e in t){var a=t[e],o=this.ourScoreDetail[a],i=this.otherScoreDetail[a],r="Scopa"===e,n=s.i18nHelper.makeLanguage(c.IGameBaseI18n.k["txt_"+e],c.GameBaseLan.bundle);if(null!=o&&null!=i){var l=cc.instantiate(this.pfItem);l.parent=this.layout;var p=l.getComponent(d.UIGameResultItem);p&&p.init({leftScore:o,scoreName:n,rightScore:i,useDefColor:r})}}},r([h(cc.Prefab)],e.prototype,"pfItem",void 0),r([h(cc.Node)],e.prototype,"layout",void 0),r([p],e)}(n.CxCompExt);a.UIGameRealTimeScore=u,cc._RF.pop()},{"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../gameBaseSrc/i18n/GameBaseI18n":void 0,"../result/UIGameResultItem":"UIGameResultItem"}],UIGameResultBattle:[function(t,e,a){"use strict";cc._RF.push(e,"b0ec7aGmeRMXJ1wB5atHpR5","UIGameResultBattle");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameResultBattle=void 0;var n=t("../../../../script/lib/base/CxCompExt"),s=t("./UIGameResultPlayer"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfPlayer=null,e.labLeftScore=null,e.ndLeftPlayers=null,e.labRightScore=null,e.ndRightPlayers=null,e.colorGreen=(new cc.Color).fromHEX("#37E502"),e.colorPink=(new cc.Color).fromHEX("#FB2164"),e}return i(e,t),e.prototype.init=function(t){t?(this.gameResult=t,this.initTotalScore(),this.initPlayerInfo()):cc.error("UIGameResultBattle data is null")},e.prototype.initTotalScore=function(){var t=this.gameResult.ourGameResult.score,e=this.gameResult.otherGameResult.score,a=this.getColor(t,e);this.labLeftScore&&(this.labLeftScore.string=""+t,this.labLeftScore.node.color=a[0]),this.labRightScore&&(this.labRightScore.string=""+e,this.labRightScore.node.color=a[1])},e.prototype.initPlayerInfo=function(){if(this.pfPlayer){for(var t=this.gameResult.ourSidePlayers,e=0;e<t.length;e++)(i=(o=cc.instantiate(this.pfPlayer)).getComponent(s.UIGameResultPlayer))&&i.init(t[e]),o.parent=this.ndLeftPlayers;var a=this.gameResult.otherSidePlayers;for(e=0;e<a.length;e++){var o,i;(i=(o=cc.instantiate(this.pfPlayer)).getComponent(s.UIGameResultPlayer))&&i.init(a[e]),o.parent=this.ndRightPlayers}}},e.prototype.getColor=function(t,e){var a=t-e;return 0===a?[cc.Color.WHITE,cc.Color.WHITE]:a>0?[this.colorGreen,this.colorPink]:[this.colorPink,this.colorGreen]},r([l(cc.Prefab)],e.prototype,"pfPlayer",void 0),r([l(cc.Label)],e.prototype,"labLeftScore",void 0),r([l(cc.Node)],e.prototype,"ndLeftPlayers",void 0),r([l(cc.Label)],e.prototype,"labRightScore",void 0),r([l(cc.Node)],e.prototype,"ndRightPlayers",void 0),r([l(cc.Color)],e.prototype,"colorGreen",void 0),r([l(cc.Color)],e.prototype,"colorPink",void 0),r([d],e)}(n.CxCompExt);a.UIGameResultBattle=p,cc._RF.pop()},{"../../../../script/lib/base/CxCompExt":void 0,"./UIGameResultPlayer":"UIGameResultPlayer"}],UIGameResultItem:[function(t,e,a){"use strict";cc._RF.push(e,"6ab01nJ4LdOpJOjhJxhLv9s","UIGameResultItem");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameResultItem=void 0;var n=t("../../../../script/lib/base/CxCompExt"),s=cc._decorator,c=s.ccclass,d=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labLeftScore=null,e.labScoreName=null,e.labRightScore=null,e.colorGreen=(new cc.Color).fromHEX("#37E502"),e.colorPink=(new cc.Color).fromHEX("#FB2164"),e}return i(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.labLeftScore&&(this.labLeftScore.string=""+e.leftScore),this.labScoreName&&(this.labScoreName.language=""+e.scoreName),this.labRightScore&&(this.labRightScore.string=""+e.rightScore);var a=this.getColor(e.leftScore,e.rightScore,e.useDefColor);this.setLabColor(this.labLeftScore,a[0]),this.setLabColor(this.labRightScore,a[1])},e.prototype.getColor=function(t,e,a){var o=t-e;return a||0===o?[cc.Color.WHITE,cc.Color.WHITE]:o>0?[this.colorGreen,this.colorPink]:[this.colorPink,this.colorGreen]},e.prototype.setLabColor=function(t,e){t&&(t.node.color=e)},r([d(cc.Label)],e.prototype,"labLeftScore",void 0),r([d(cc.Label)],e.prototype,"labScoreName",void 0),r([d(cc.Label)],e.prototype,"labRightScore",void 0),r([d(cc.Color)],e.prototype,"colorGreen",void 0),r([d(cc.Color)],e.prototype,"colorPink",void 0),r([c],e)}(n.CxCompExt);a.UIGameResultItem=l,cc._RF.pop()},{"../../../../script/lib/base/CxCompExt":void 0}],UIGameResultList:[function(t,e,a){"use strict";cc._RF.push(e,"e9af4sPnUBCopzlztqgPwR3","UIGameResultList");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameResultList=void 0;var n=t("../../../../script/app/const/game/GameConstant"),s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../../script/lib/i18n/i18nHelper"),d=t("../../../gameBaseSrc/i18n/GameBaseI18n"),l=t("./UIGameResultItem"),p=cc._decorator,h=p.ccclass,u=p.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfResultItem=null,e}return i(e,t),e.prototype.init=function(t){this.ourGameResult=t.ourGameResult,this.otherGameResult=t.otherGameResult,this.ourGameResult&&this.otherGameResult?(this.initView(),this.doAnim(t.endStatus)):cc.error("UIGameResultList ourGameResult is null")},e.prototype.initView=function(){var t={Denari:"coinsNum",Primiera:"ColorFenMax",Cards:"cardNum",Settebello:"coins7",Scopa:"scopaCount"};for(var e in t){var a=t[e],o=this.ourGameResult[a],i=this.otherGameResult[a],r="Scopa"===e,n=c.i18nHelper.makeLanguage(d.IGameBaseI18n.k["txt_"+e],d.GameBaseLan.bundle);if(null!=o&&null!=i){var s=cc.instantiate(this.pfResultItem);s.parent=this.node;var p=s.getComponent(l.UIGameResultItem);p&&p.init({leftScore:o,scoreName:n,rightScore:i,useDefColor:r})}}},e.prototype.doAnim=function(t){t===n.GameConstant.GameEndStatus.WIN?cc.tween(this.node.parent).set({scale:.8,opacity:0}).delay(.06).parallel(cc.tween().to(.2,{scale:1.05}).to(.1,{scale:1}),cc.tween().to(.3,{opacity:255})).start():cc.tween(this.node.parent).set({scale:1,opacity:0}).delay(.06).to(.3,{opacity:255}).start()},r([u(cc.Prefab)],e.prototype,"pfResultItem",void 0),r([h],e)}(s.CxCompExt);a.UIGameResultList=C,cc._RF.pop()},{"../../../../script/app/const/game/GameConstant":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../gameBaseSrc/i18n/GameBaseI18n":void 0,"./UIGameResultItem":"UIGameResultItem"}],UIGameResultMenu:[function(t,e,a){"use strict";cc._RF.push(e,"7d57dndyGRHUr7rLVQaRBya","UIGameResultMenu");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameResultMenu=void 0;var n=t("./../../../gameBaseSrc/i18n/GameBaseI18n"),s=t("./../../../../script/lib/utils/Display"),c=t("../../../../script/app/const/Global"),d=t("../../../../script/app/event/Notify"),l=t("../../../../script/lib/base/CxCompExt"),p=t("../../../gameBaseSrc/model/GameEvent"),h=t("../../../../script/app/const/AudioFile"),u=t("../../../../script/lib/i18n/i18nHelper"),C=t("../../../../script/app/module/buryPoint/BuryPoint"),f=t("../../../../script/app/module/buryPoint/BuryPointUtils"),y=t("../../../../script/app/event/GuiEvent"),S=cc._decorator,v=S.ccclass,m=S.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.resultLayer=null,e.btnHome=null,e.btnRematch=null,e.btnDetail=null,e.bSendRematchMsg=!1,e.isWin=!1,e}return i(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.btnHome&&this.btnHome.node.on("click",this.onClickHome,this),this.btnRematch&&(this.btnRematch.node.on("click",this.onClickRematch,this),this.labRematchTime=this.btnRematch.getComponentInChildren(cc.Label),this.labRematchTime.language=u.i18nHelper.makeLanguage([n.IGameBaseI18n.k.game_end_rematch,this.rematchCD||0],n.GameBaseLan.bundle)),this.btnDetail&&this.btnDetail.node.on("click",this.onClickDetail,this),this.bShowView=!0,this.pMask=this.node.getChildByName("mask"),this.doEnterAnim()},e.prototype.onDestroy=function(){this.stopRematchTimer(),t.prototype.onDestroy.call(this)},e.prototype.doEnterAnim=function(){var t=0;if(this.isWin&&(t=2),this.pMask&&cc.tween(this.pMask).set({opacity:0}).delay(t).to(.1,{opacity:178.5}).start(),this.btnRematch&&cc.tween(this.btnRematch.node).set({opacity:0}).delay(.7).delay(t).to(.2,{opacity:255}).start(),this.btnHome&&cc.tween(this.btnHome.node).set({opacity:0}).delay(.7).delay(t).to(.2,{opacity:255}).start(),this.btnDetail){var e=this.btnDetail.node.position;this.btnDetail.node.x=s.Display.width+100,cc.tween(this.btnDetail.node).set({opacity:255}).delay(.7).delay(t).to(.3,{opacity:255,position:e}).start()}},e.prototype.onClickHome=function(){this.dispatch(p.GameEvent.Voice.PLAY_EFFECT_OTHER,h.AudioFile.Com.BACK),f.BuryPointUtils.send(C.BuryPoint.Debug.Game.ClickHome),this.dispatch(p.GameEvent.OperateEvent.CLICK_HOME)},e.prototype.onClickRematch=function(){this.dispatch(p.GameEvent.OperateEvent.NEXT_GAME),this.dispatch(p.GameEvent.Voice.PLAY_EFFECT_OTHER,h.AudioFile.Com.GO),this.dispatch(y.GuiEvent.PopMsg.DISPLAY_TABLE_PROGRESS,{rmthis:!0}),this.bSendRematchMsg=!0,0==this.rematchCD?this.dispatch(p.GameEvent.OperateEvent.CLICK_REMATCH,!1):this.dispatch(p.GameEvent.OperateEvent.CLICK_REMATCH,!0),f.BuryPointUtils.send(C.BuryPoint.Debug.Game.ClickRematch)},e.prototype.onClickDetail=function(){f.BuryPointUtils.send(C.BuryPoint.Debug.Game.ClickDetail),this.bShowView=!this.bShowView,this.resultLayer&&(this.resultLayer.active=this.bShowView);var t=this.node.getChildByName("mask");t&&(t.active=this.bShowView),this.dispatch(y.GuiEvent.PopMsg.DISPLAY_TABLE_PROGRESS,{rmthis:!0}),this.bShowView?this.dispatch(p.GameEvent.Voice.PLAY_EFFECT_OTHER,h.AudioFile.Com.BACK):this.dispatch(p.GameEvent.Voice.PLAY_EFFECT_OTHER,h.AudioFile.Com.GO)},e.prototype.onClickTableMap=function(){this.dispatch(d.Notify.Base.ADD_ORIGIN,{level:c.gOriginLevel.LEVEL_1,event:y.GuiEvent.UI.OPEN_LOBBY_TABLES}),f.BuryPointUtils.send(C.BuryPoint.Debug.Game.ClickTableMap),this.dispatch(p.GameEvent.Com.GAME_EXIT,c.gExitGameType.exitAndLeftRoom)},e.prototype.changeReddot=function(t,e){var a;e?(a=t.getChildByName("reddot"))&&(a.active=!0,a.getComponentInChildren(cc.Label).string=""+e):(a=t.getChildByName("reddot"))&&(a.active=!1)},e.prototype.startRematchTimer=function(t){this.stopRematchTimer(),this.rematchCD=t;var e=Math.abs(t);cc.tween(this.node).repeat(e,cc.tween().delay(1).call(this.setRematchTime.bind(this))).start()},e.prototype.setRematchTime=function(){this.rematchCD--,this.labRematchTime&&(this.labRematchTime.language=u.i18nHelper.makeLanguage([n.IGameBaseI18n.k.game_end_rematch,this.rematchCD],n.GameBaseLan.bundle)),this.rematchCD<=0&&(this.rematchCD=0,this.stopRematchTimer())},e.prototype.stopRematchTimer=function(){this.node.stopAllActions()},r([m(cc.Node)],e.prototype,"resultLayer",void 0),r([m(cc.Button)],e.prototype,"btnHome",void 0),r([m(cc.Button)],e.prototype,"btnRematch",void 0),r([m(cc.Button)],e.prototype,"btnDetail",void 0),r([v],e)}(l.CxCompExt);a.UIGameResultMenu=_,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/const/Global":void 0,"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/module/buryPoint/BuryPoint":void 0,"../../../../script/app/module/buryPoint/BuryPointUtils":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"./../../../../script/lib/utils/Display":void 0,"./../../../gameBaseSrc/i18n/GameBaseI18n":void 0}],UIGameResultPlayer:[function(t,e,a){"use strict";cc._RF.push(e,"ca97aIwDbxMv5+CBUU7ty2G","UIGameResultPlayer");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameResultPlayer=void 0;var n=t("../../../../script/app/view/ComUI"),s=t("../../../../script/lib/base/CxCompExt"),c=cc._decorator,d=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndHead=null,e.labNickName=null,e.spPCIcon=null,e}return i(e,t),e.prototype.init=function(t){t?(this.setHead(t),this.setNicknName(t.name,t.bIsGoldenPass),this.setBankruptcyIcon(t.bPC)):cc.error("UIGameResultPlayer playerInfo is null")},e.prototype.setHead=function(t){this.ndHead&&(this.ndHead.destroyAllChildren(),n.ComUI.createUserHead({parent:this.ndHead,userId:t.userId,sex:t.sex,size:cc.size(129,129),save:!0,faceId:t.sysFaceId,robot:t.isRobot,custFaceId:t.custFaceId,url:t.headURL,level:t.level}))},e.prototype.setNicknName=function(t,e){this.labNickName&&(this.labNickName.string=t,e&&n.ComUI.LabelToGolden(this.labNickName))},e.prototype.setBankruptcyIcon=function(t){this.spPCIcon&&(this.spPCIcon.node.active=t)},r([l(cc.Node)],e.prototype,"ndHead",void 0),r([l(cc.Label)],e.prototype,"labNickName",void 0),r([l(cc.Sprite)],e.prototype,"spPCIcon",void 0),r([d],e)}(s.CxCompExt);a.UIGameResultPlayer=p,cc._RF.pop()},{"../../../../script/app/view/ComUI":void 0,"../../../../script/lib/base/CxCompExt":void 0}],UIGameResultTitle:[function(t,e,a){"use strict";cc._RF.push(e,"f9193WrqsFNDowwlbr4S4rB","UIGameResultTitle");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameResultTitle=void 0;var n=t("./../../../gameBaseSrc/i18n/GameBaseI18n"),s=t("./../../../../script/lib/utils/ComUtils"),c=t("../../../../script/app/const/AudioFile"),d=t("../../../../script/app/const/game/GameConstant"),l=t("../../../../script/app/event/Notify"),p=t("../../../../script/lib/base/CxCompExt"),h=t("../../../../script/app/const/Global"),u=t("../../../../script/lib/base/Language"),C=t("../../../../script/lib/manager/ResManager"),f=t("../../../../script/app/model/DataProxy"),y=t("../../../../script/app/event/GuiEvent"),S=t("../../../../script/lib/i18n/i18nHelper"),v=cc._decorator,m=v.ccclass,_=v.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sklTitle=null,e.sklPartical=null,e.spIcon=null,e.labGold=null,e.labAnimAdd=null,e.ndBeiShu=null,e.labBeiShu=null,e.spScopaIcon=null,e.skl_build=null,e.spCappedTag=null,e.spCappedTips=null,e.labCappedDesc=null,e}return i(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.mBShowCappedTips=!1,this.mGoldNum=e.goldNum,this.mFBGoldNum=e.fbGoldNum,this.mCappedViewId=e.cappedViewId,this.setTitle(e.endStatus),this.setGold(e.goldNum),this.setBeiShu(e.strBeiShu,e.endStatus),this.goldAnim(e.endStatus,e.goldNum),this.setCappedTag(e.cappedViewId>=0&&e.endStatus===d.GameConstant.GameEndStatus.WIN)},e.prototype.setTitle=function(t){this.sklTitle.paused=!1,this.sklPartical.node.active=!1;var e=this,a=function(){t===d.GameConstant.GameEndStatus.WIN?(e.sklTitle.animation="win",e.node.stopAllActions(),cc.tween(e.node).delay(.7).call(function(){e.sklPartical.node.active=!0,e.sklPartical.animation="win_lizi",e.sklPartical.loop=!0,e.sklPartical.paused=!1}).start()):t===d.GameConstant.GameEndStatus.LOST?(e.sklTitle.animation="lost",e.sklPartical.node.active=!1):t===d.GameConstant.GameEndStatus.DRAW&&(e.sklTitle.animation="draw",e.sklPartical.node.active=!1),a=null},o=u.Language.getInstance().getLanguage();cc.sys.LANGUAGE_ENGLISH!==o?C.default.getInstance().loadSkeleton("effect/jiesuan/jiesuan_"+o,h.gAssetBundleName.SCOPA_GOLD_RES,function(t,o){o&&cc.isValid(e)&&cc.isValid(e.sklPartical)?(e.sklPartical.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),e.sklPartical.skeletonData=o,e.sklPartical.node.active=!0,e.sklPartical.premultipliedAlpha=!1,e.sklTitle.skeletonData=o,e.sklTitle.loop=!1,e.sklTitle.node.active=!0,e.sklTitle.premultipliedAlpha=!1,a()):a()}):a()},e.prototype.setGold=function(t){this.labGold&&(this.labGold.string=s.ComUtils.formatGoldStr(t))},e.prototype.goldAnim=function(t){var e=this;t===d.GameConstant.GameEndStatus.WIN?(cc.log("result: goldAnim: win mFBGoldNum=",this.mFBGoldNum),cc.tween(this.labGold.node.parent).set({opacity:0}).delay(.56).to(.2,{opacity:255}).call(function(){e.playGoldAnim()}).start()):cc.tween(this.labGold.node.parent).set({opacity:0}).delay(.3).to(.2,{opacity:255}).start(),t===d.GameConstant.GameEndStatus.WIN?this.dispatch(l.Notify.Base.PLAY_EFFECT,{path:c.AudioFile.Game.GAME_WIN}):this.dispatch(l.Notify.Base.PLAY_EFFECT,{path:c.AudioFile.Game.GAME_LOST})},e.prototype.setBeiShu=function(t,e){this.ndBeiShu&&(t?(this.ndBeiShu.active=!0,this.labBeiShu.string=t,e===d.GameConstant.GameEndStatus.WIN?cc.tween(this.ndBeiShu).set({opacity:0}).delay(.56).to(.2,{opacity:255}).start():cc.tween(this.ndBeiShu).set({opacity:0}).delay(.3).to(.2,{opacity:255}).start()):this.ndBeiShu.active=!1)},e.prototype.playGoldAnim=function(){var t=this.mGoldNum;this.mFBGoldNum&&(t=this.mFBGoldNum),this.dispatch(y.GuiEvent.Anim.COM_AWARD_ANIM,{awardNum:t,scene:h.gSceneType.Game});var e=f.DataProxy.getInstance().userData.powerInfo;e&&e.changeNum>0&&this.dispatch(y.GuiEvent.Anim.COM_POWER_ANIM,{awardNum:e.changeNum,scene:h.gSceneType.Game})},e.prototype.playDeskBuildAnim=function(){var t=this;if(cc.log("desk: playDeskBuildAnim() mFBGoldNum=",this.mFBGoldNum),this.labGold&&this.mFBGoldNum&&this.labAnimAdd){cc.log("desk: playDeskBuildAnim() start");var e=this.labAnimAdd.parent.convertToWorldSpaceAR(this.labAnimAdd.position);e.x+=30,this.dispatch(y.GuiEvent.Anim.ANIM_DESK_BUILD_GOLD,e),cc.tween(this.labGold.node).delay(.8).set({opacity:0,scale:.6}).call(function(){t.setGold(t.mFBGoldNum)}).to(.13,{scale:1.6,opacity:255}).to(.07,{scale:.8}).to(.1,{scale:1}).call(function(){t.playGoldAnim()}).start(),this.skl_build&&cc.tween(this.skl_build.node).delay(.7).call(function(){t.skl_build&&(t.skl_build.paused=!1,t.skl_build.node.active=!0)}).start()}},e.prototype.setCappedTag=function(t){this.spCappedTag&&(this.spCappedTag.node.on("click",this.onShowCappedTips,this),this.spCappedTag.node.active=t),this.spCappedTips&&(this.spCappedTips.node.active=!1)},e.prototype.onShowCappedTips=function(){this.spCappedTips&&(this.spCappedTips.node.active=this.mBShowCappedTips,this.labCappedDesc&&(0==this.mCappedViewId?this.labCappedDesc.string=S.i18nHelper.getLanguage([n.IGameBaseI18n.k.game_end_you_capped_tips,this.mGoldNum,this.mGoldNum],n.GameBaseLan.bundle):this.labCappedDesc.string=S.i18nHelper.getLanguage([n.IGameBaseI18n.k.game_end_other_capped_tips,this.mGoldNum,this.mGoldNum],n.GameBaseLan.bundle))),this.mBShowCappedTips=!this.mBShowCappedTips},r([_(sp.Skeleton)],e.prototype,"sklTitle",void 0),r([_(sp.Skeleton)],e.prototype,"sklPartical",void 0),r([_(cc.Sprite)],e.prototype,"spIcon",void 0),r([_(cc.Label)],e.prototype,"labGold",void 0),r([_(cc.Node)],e.prototype,"labAnimAdd",void 0),r([_(cc.Node)],e.prototype,"ndBeiShu",void 0),r([_(cc.Label)],e.prototype,"labBeiShu",void 0),r([_(cc.Sprite)],e.prototype,"spScopaIcon",void 0),r([_(sp.Skeleton)],e.prototype,"skl_build",void 0),r([_(cc.Sprite)],e.prototype,"spCappedTag",void 0),r([_(cc.Sprite)],e.prototype,"spCappedTips",void 0),r([_(cc.Label)],e.prototype,"labCappedDesc",void 0),r([m],e)}(p.CxCompExt);a.UIGameResultTitle=g,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/const/Global":void 0,"../../../../script/app/const/game/GameConstant":void 0,"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/model/DataProxy":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/base/Language":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../../script/lib/manager/ResManager":void 0,"./../../../../script/lib/utils/ComUtils":void 0,"./../../../gameBaseSrc/i18n/GameBaseI18n":void 0}],UIGameResultView:[function(t,e,a){"use strict";cc._RF.push(e,"acdfa80ZAVA9K+7KFOYyIsc","UIGameResultView");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameResultView=void 0;var n=t("./UIGameResultList"),s=t("./UIGameResultBattle"),c=t("./UIGameResultTitle"),d=t("../../../../script/lib/base/CxCompExt"),l=t("./UIGameResultMenu"),p=t("../../../../script/lib/base/ComPopup"),h=t("../../../../script/app/const/game/GameConstant"),u=t("../../../../script/app/view/activity/GoldenPassMenuMini"),C=t("../../../../script/app/event/Notify"),f=t("../../../../script/app/view/ComFunctions"),y=cc._decorator,S=y.ccclass,v=y.property,m=y.requireComponent,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title=null,e.battleResult=null,e.resultList=null,e.pfGoldenPassMini=null,e.spriteCup=null,e.labCup=null,e}return i(e,t),e.prototype.init=function(t){this.gameResult=t,this.initTitle(t),this.initBattleResult(t),this.initResultList(t);var e=this.getComponent(l.UIGameResultMenu);e&&(e.init(t.endStatus===h.GameConstant.GameEndStatus.WIN),e.startRematchTimer(t.rematchTime)),this.spriteCup&&this.initGoldenPassEntry(t.ourGameResult.dwCupNum),this.labCup&&(this.labCup.string="x"+t.ourGameResult.dwCupNum)},e.prototype.onDestroy=function(){this.gameResult=null,this.dispatch(C.Notify.AD.HIDE_BANNER),t.prototype.onDestroy.call(this)},e.prototype.initTitle=function(t){if(this.title){var e=t.endStatus,a=t.ourGameResult.userGold;this.title.init({endStatus:e,goldNum:a,fbGoldNum:t.ourGameResult.fbScore,strBeiShu:t.strBeiShu,cappedViewId:t.cappedViewId})}},e.prototype.initBattleResult=function(t){this.battleResult&&this.battleResult.init(t)},e.prototype.initResultList=function(t){this.resultList&&this.resultList.init(t)},e.prototype.initGoldenPassEntry=function(t){var e=this;f.ComFunctions.performWithDelay(this.node,function(){if(e.pfGoldenPassMini){e.node.scale=1;var a=e.spriteCup.node.convertToWorldSpaceAR(cc.v2(0,0)),o=cc.instantiate(e.pfGoldenPassMini);o.parent=e.node;var i=o.getComponent(u.default);i.setOpenFromGame(!0),i.setActionData(t,a,e.spriteCup.node.getContentSize())}},.2)},r([v(c.UIGameResultTitle)],e.prototype,"title",void 0),r([v(s.UIGameResultBattle)],e.prototype,"battleResult",void 0),r([v(n.UIGameResultList)],e.prototype,"resultList",void 0),r([v({type:cc.Prefab,tooltip:"goldenPass\u4e3b\u9898\u5165\u53e3"})],e.prototype,"pfGoldenPassMini",void 0),r([v({type:cc.Sprite,tooltip:"\u5956\u676f\u7cbe\u7075"})],e.prototype,"spriteCup",void 0),r([v(cc.Label)],e.prototype,"labCup",void 0),r([S,m(p.ComPopup)],e)}(d.CxCompExt);a.UIGameResultView=_,cc._RF.pop()},{"../../../../script/app/const/game/GameConstant":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/view/ComFunctions":void 0,"../../../../script/app/view/activity/GoldenPassMenuMini":void 0,"../../../../script/lib/base/ComPopup":void 0,"../../../../script/lib/base/CxCompExt":void 0,"./UIGameResultBattle":"UIGameResultBattle","./UIGameResultList":"UIGameResultList","./UIGameResultMenu":"UIGameResultMenu","./UIGameResultTitle":"UIGameResultTitle"}],UIGameUserInfoBg:[function(t,e,a){"use strict";cc._RF.push(e,"629a2eSmnRCWLIDpf4YTkGM","UIGameUserInfoBg");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIGameUserInfoBg=void 0;var n=t("../../../../script/lib/base/CxCompExt"),s=t("../../../../script/lib/utils/ScreenAdapter"),c=t("../../../gameBaseSrc/model/GameEvent"),d=cc._decorator,l=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spSelf=null,e.spView_2=null,e}return i(e,t),e.prototype.start=function(){this.spSelf&&s.ScreenAdapter.paddingBottom(this.spSelf.node),this.spView_2&&s.ScreenAdapter.paddingBottom(this.spView_2.node)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(c.GameEvent.Player.GAME_START,this.onGameStart),this.bindEvent(c.GameEvent.Player.MOVE_END,this.onGameStartEnd)},e.prototype.onGameStart=function(){this.node.opacity=0},e.prototype.onGameStartEnd=function(){this.node.opacity=255},r([p(cc.Sprite)],e.prototype,"spSelf",void 0),r([p(cc.Sprite)],e.prototype,"spView_2",void 0),r([l],e)}(n.CxCompExt);a.UIGameUserInfoBg=h,cc._RF.pop()},{"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/utils/ScreenAdapter":void 0,"../../../gameBaseSrc/model/GameEvent":void 0}],UIMultCardTouchBehavior:[function(t,e,a){"use strict";cc._RF.push(e,"8b2b3XNbv1Dj5zz4rJEDgJd","UIMultCardTouchBehavior");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0});var n=t("../../../../script/lib/base/CxCompExt"),s=t("../../../../script/lib/utils/ComUtils"),c=t("../../../../script/lib/utils/Display"),d=t("./UIMyHandCardList"),l=t("./UIMyHandPokerView"),p=cc._decorator,h=p.ccclass,u=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui=null,e.isCardCanTouch=!1,e.isPressing=!1,e.iTouchId=-1,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.ui=this.node.getComponent(l.UIMyHandPokerView),this.ui||(this.ui=this.node.addComponent(l.UIMyHandPokerView)),this.pCardList=this.getComponent(d.UIMyHandCardList),this.setCanTouch(!0),this.TouchRect=new cc.Rect(0,0,c.Display.width,c.Display.height/4)},e.prototype.onDestroy=function(){this.ui&&(this.ui=null),this.pCardList&&(this.pCardList=null),this.removeEventAtTouchEnd(),t.prototype.onDestroy.call(this)},e.prototype.checkCardCanOut=function(){return!0},e.prototype.isMeCanOutCard=function(){return!!this.ui.getDataDelegate()&&this.ui.getDataDelegate().isViewIdCanOutCard(0)},e.prototype.setPressing=function(t){this.isPressing=t},e.prototype.getPressing=function(){return this.isPressing},e.prototype.getCanTouch=function(){return this.isCardCanTouch},e.prototype.setCanTouch=function(t){this.isCardCanTouch=t,t?(this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1),this.addEventAtTouchBegan()):(this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.removeEventAtTouchEnd())},e.prototype.addEventAtTouchBegan=function(){this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.removeEventAtTouchEnd=function(){this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},e.prototype.onTouchBegan=function(t){if(-1===this.iTouchId&&this.ui){this.iTouchId=t.getID();var e=t.getLocation(),a=this.node.convertToNodeSpaceAR(e),o=this.TouchRect.contains(a);if(this.getCanTouch()&&1==o){this.setPressing(!0),this.bMoveMode=!1;var i=this.getTouchCardIndex(e),r=this.pCardList.allHandCard;if(i>=0){var n=r[i];n&&n.canTouch()&&n.setPreSelected(!0)}}}},e.prototype.onTouchMoved=function(t){if(this.iTouchId===t.getID()&&this.pCardList){var e=t.getLocation(),a=this.node.convertToNodeSpaceAR(e);if(this.TouchRect.contains(a),1==this.getPressing()){this.bMoveMode=!0;for(var o=Math.abs(t.getLocationX()-t.getStartLocation().x),i=Math.abs(t.getLocationY()-t.getStartLocation().y),r=Math.min(t.getLocationX(),t.getStartLocation().x),n=Math.min(t.getLocationY(),t.getStartLocation().y),s=cc.rect(r,n,o,i),c=this.pCardList.allHandCard,d=c.length-1;d>=0;d--){var l=c[d];l&&l.canTouch()&&(l.containsInRect(s)?l.setPreSelected(!0):l.isSelected()&&l.isPreSelected()?l.setPreSelected(!1):l.isSelected()||l.setPreSelected(!1))}}}},e.prototype.onTouchEnd=function(t){if(this.iTouchId===t.getID()&&this.pCardList){var e=t.getLocation(),a=this.node.convertToNodeSpaceAR(e),o=this.TouchRect.contains(a);if(this.getCanTouch()&&1==this.getPressing())if(this.bMoveMode){this.bMoveMode=!1;for(var i=!1,r=this.pCardList.allHandCard,n=r.length-1;n>=0;n--){var s=r[n];if(s&&s.canTouch()){var c=s.dealWithPreEvent();i||(i=c)}}var d=this.getPreSelectedCard(),l=this.getSelectedCardData();l.length>0?(l=l.concat(d),this.selectCards(l)):i?this.selectCards(d):this.dealWithAICard(d)}else o?this.dealWithTouch(e):this.clearHandCardSelectedStatus();else this.clearHandCardSelectedStatus(),this.curTipIndx=0;this.setPressing(!1),this.clearHandCardPreSelectedStatus(),this.iTouchId=-1}},e.prototype.onTouchCancel=function(t){this.getPressing()&&this.onTouchEnd(t)},e.prototype.getTouchCardIndex=function(t){for(var e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=e[a];if(o&&!0===o.hitPos(t))return a}return-1},e.prototype.clearHandCardSelectedStatus=function(){for(var t=this.pCardList.allHandCard,e=0;e<t.length;e++){var a=t[e];a&&a.setSelected(!1)}},e.prototype.clearHandCardPreSelectedStatus=function(){for(var t=this.pCardList.allHandCard,e=0;e<t.length;e++){var a=t[e];a&&a.clearPreSelected()}},e.prototype.getSelectedCardData=function(){for(var t=[],e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=e[a];o&&o.isSelected()&&t.push(o.cardData)}return t},e.prototype.getPreSelectedCard=function(){for(var t=[],e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=e[a];o&&o.isPreSelected()&&t.push(o.cardData)}return t},e.prototype.setHandCardCanSelect=function(t){for(var e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=(n=e[a]).cardData;if(n&&o){n.setCanSelect(!1);for(var i=0;i<t.length;i++){var r=t[i];if(r&&o.l==r.l){n.setCanSelect(!0),n.setUnTouch(!1);break}}}}for(a=0;a<e.length;a++){var n;(n=e[a]).isCanSelect()||(n.setSelected(!1),n.setUnTouch(!0))}},e.prototype.setHandCardAllCanSelect=function(t){for(var e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=e[a];o&&(o.setCanSelect(t),o.setUnTouch(!t))}},e.prototype.dealWithTouch=function(t){for(var e=this.pCardList.allHandCard,a=!1,o=e.length-1;o>=0;o--){var i=e[o];if(i&&i.touch(t)){i.isSelected()?i.setSelected(!1):(i.setSelected(!0),a=!0);break}}a&&1==this.getSelectedCardData().length&&this.dealWithAICard(this.getSelectedCardData()),this.checkCardValid(this.getSelectedCardData())},e.prototype.dealWithAICard=function(t,e){void 0===e&&(e=!1),this.ui.getCurHandCardDatas()},e.prototype.selectCards=function(t){for(var e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=!1,i=e[a];if(i&&i.cardData){for(var r=0;r<t.length;r++){var n=t[r];if(i.cardData.r===n.r){o=!0,i.setSelected(!0);break}}o||i.setSelected(!1)}}},e.prototype.onClickTipCard=function(){if(this.tipCards&&this.tipCards.length>0){var t=this.tipCards.length-1,e=this.tipCards[this.curTipIndx];e?(this.selectCards(e),this.checkCardValid(e)):this.setOutMenuStatus(!1),this.curTipIndx++,this.curTipIndx>t&&(this.curTipIndx=0)}},e.prototype.checkLastHandCard=function(){return!1},e.prototype.onTipOutCard=function(){},e.prototype.resetTipCard=function(){this.curTipIndx=0},e.prototype.findTipCards=function(){this.curTipIndx=0,this.checkTipCardAndPop()},e.prototype.checkTipCardAndPop=function(t){if(void 0===t&&(t=!1),this.tipCards&&this.tipCards.length>=1){this.curTipIndx=0;var e=this.tipCards[this.curTipIndx];e?(this.tipCards.length>1&&this.curTipIndx++,this.selectCards(e),t?this.checkCardValid(e):this.setOutMenuStatus(!0)):this.setOutMenuStatus(!1)}},e.prototype.checkCardValid=function(){},e.prototype.onClickOutCard=function(){var t=this.getSelectedCardData();t&&t.length>0&&this.isMeCanOutCard()&&this.ui.doOutCard(s.ComUtils.clone(t))},e.prototype.setOutMenuStatus=function(){},r([h],e)}(n.CxCompExt));a.default=u,cc._RF.pop()},{"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/utils/ComUtils":void 0,"../../../../script/lib/utils/Display":void 0,"./UIMyHandCardList":"UIMyHandCardList","./UIMyHandPokerView":"UIMyHandPokerView"}],UIMyHandCardList:[function(t,e,a){"use strict";cc._RF.push(e,"45cdfFd7fJBWK626LMmDZyj","UIMyHandCardList");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIMyHandCardList=void 0;var n,s=t("./../../../gameBaseSrc/alg/ScopaLogic"),c=t("../../../../script/app/const/AudioFile"),d=t("../../../../script/app/const/Global"),l=t("../../../../script/app/event/Notify"),p=t("../../../../script/app/view/ComUI"),h=t("../../../../script/lib/base/CxCompExt"),u=t("../../../../script/lib/manager/NodePoolMgr"),C=t("../../../../script/lib/utils/Display"),f=t("../../../../script/lib/utils/Logger"),y=t("../../../../script/lib/utils/MathUtils"),S=t("../../../../script/lib/utils/ScreenAdapter"),v=t("../../../gameBaseSrc/model/GameEvent"),m=t("../../../gameBaseSrc/model/ScopaConstant"),_=t("../../../gameBaseSrc/view/PokerCreator"),g=t("../poker/UIMyHandPoker"),E=t("./UIMyHandPokerView");(function(t){t[t.CARD_BG_LIGHT=1]="CARD_BG_LIGHT",t[t.CARD=10]="CARD",t[t.HOLD_CARD=1e3]="HOLD_CARD"})(n||(n={}));var I=cc._decorator,P=I.ccclass,D=I.property,b=function(t){function e(){var e=t.call(this)||this;return e.pfMyHandCard=null,e.ui=null,e.curSendOverCardNum=0,e.CARD_GRAY_OPACITY=200,e.Radius=1935,e.RadiusOffset=230,e.curSelectCardIndx=-1,e.cardLights=[],e.allHandCard=[],e.allHandCardInfo=[],e.unuseCards=[],e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.ui=this.node.getComponent(E.UIMyHandPokerView),this.ui||(this.ui=this.node.addComponent(E.UIMyHandPokerView)),this.circlePos=cc.v2(C.Display.cx,340-this.Radius+C.Display.paddingBottom)},e.prototype.onDestroy=function(){this.ui&&(this.ui=null),u.NodePoolMgr.getInstance().clearPool(g.UIMyHandPoker.NAME),t.prototype.onDestroy.call(this),this.cardLights=null,this.allHandCard=null,this.allHandCardInfo=null,this.unuseCards=[],this.unuseCards=null},e.prototype.getCardNum=function(){return this.allHandCard.length},e.prototype.getCardItemByIndex=function(t){return t>=0&&t<this.allHandCard.length?this.allHandCard[t]:null},e.prototype.getCardItemIndexByData=function(t){for(var e=-1,a=this.allHandCard.length-1;a>=0;a--)if(this.allHandCard[a].cardData.r==t){e=a;break}return e},e.prototype.getTouchCardIndx=function(t){for(var e=-1,a=0;a<this.allHandCard.length;a++)if(this.allHandCard[a].node.getBoundingBoxToWorld().contains(t)){e=a;break}return e},e.prototype.getCardItemByData=function(t){for(var e=0;e<this.allHandCard.length;e++)if(this.allHandCard[e].cardData.r===t)return this.allHandCard[e];return null},e.prototype.setCurSelectCardIndx=function(t){this.curSelectCardIndx=t},e.prototype.getCurSelectCardIndx=function(){return this.curSelectCardIndx},e.prototype.selectCancle=function(){for(var t=0;t<this.allHandCard.length;t++)this.allHandCard[t].setUnTouch(!1)},e.prototype.upCardByIndxList=function(t,e,a,o,i){for(var r=0,n=t;r<n.length;r++){var s=n[r];this.allHandCard[s].setUp(e,a,o,i)}},e.prototype.greyCardsByIndxs=function(t,e){e&&this.CARD_GRAY_OPACITY},e.prototype.grayCardsAll=function(t){t&&this.CARD_GRAY_OPACITY},e.prototype.hideAllCards=function(){for(var t=0,e=this.allHandCard;t<e.length;t++)e[t].node.active=!1},e.prototype.orderHandCard=function(t,e){t&&this.sortHandCards();for(var a=this.allHandCardInfo,o=this.allHandCard.length,i=0;i<o;i++){var r=this.allHandCard[i];r&&(r.setFinalPos(a[i].pos,e),e&&r.moveToFinalPosition())}},e.prototype.sortHandCards=function(){},e.prototype.setHandCardCanTouch=function(){for(var t=0,e=this.allHandCard;t<e.length;t++)e[t].setUnTouch(!1)},e.prototype.clearCardFlag=function(){for(var t=0,e=this.allHandCard;t<e.length;t++)e[t].clearFlag()},e.prototype.clearHandCard=function(){for(var t=0,e=this.allHandCard;t<e.length;t++){var a=e[t];a.clear(),this.unuseCards.push(a)}this.allHandCard=[],this.curSendOverCardNum=0,this.hideCardLight()},e.prototype.getNewCard=function(){var t=this.unuseCards.shift();if(!t){var e=u.NodePoolMgr.getInstance().getPool(g.UIMyHandPoker.NAME).get();e||(e=cc.instantiate(this.pfMyHandCard)),(t=e.getComponent(g.UIMyHandPoker))||(t=e.addComponent(g.UIMyHandPoker))}return t.node.active=!0,t.node.parent||(t.node.parent=this.node),t},e.prototype.doSendCardAction=function(t){var e=this;this.initHandCardsPosition(!0);var a=cc.v3(t.fromPos);a.x+=60,a.y-=70,u.NodePoolMgr.getInstance().getPool(g.UIMyHandPoker.NAME);for(var o,i,r,n=this.ui.getCurHandCardDatas(),s=this.allHandCardInfo,d=(t.fromPos.y-425)*S.ScreenAdapter.getVScale(),l=[cc.v3(150,d),cc.v3(350,d),cc.v3(550,d)],p=0;p<n.length;p++){var h=s[p];(i=this.getNewCard()).init({meta:n[p],posInfo:h}),i.showBack(),(r=i.node).zIndex=h.zIndex,r.position=a,r.scale=.6,r.opacity=0,this.allHandCard.push(i)}var C=this.allHandCard[2];C&&(y.MathUtils.lookAt(l[2],a),o=0*t.spaceTime,cc.tween(C.node).delay(o).set({angle:48,opacity:255}).call(function(){e.dispatch(v.GameEvent.Voice.PLAY_EFFECT_OTHER,c.AudioFile.Game.SEND_CARD),e.dispatch(v.GameEvent.Desk.REDUCE_CARD_NUM,1)}).parallel(cc.tween().to(.1,{scaleX:1,scaleY:.8}).to(.1,{scaleX:.7,scaleY:.05}),cc.tween().delay(.13).to(.06,{opacity:76.5}),cc.tween().to(.2,{position:l[2],angle:42})).parallel(cc.tween().call(function(){C.showFront()}).to(.03,{scaleX:.5,scaleY:.05,angle:26}).to(.2,{scaleX:1,scaleY:1,angle:0}),cc.tween().to(.03,{opacity:76.5}).to(.1,{opacity:255}),cc.tween().to(.73,{x:this.allHandCardInfo[2].pos.x,y:this.allHandCardInfo[2].pos.y,angle:this.allHandCardInfo[2].angle},{easing:cc.easing.sineOut})).start());var f=this.allHandCard[1];f&&(y.MathUtils.lookAt(l[1],a),o=1*t.spaceTime,cc.tween(f.node).delay(o).set({angle:38,opacity:255}).call(function(){e.dispatch(v.GameEvent.Voice.PLAY_EFFECT_OTHER,c.AudioFile.Game.SEND_CARD),e.dispatch(v.GameEvent.Desk.REDUCE_CARD_NUM,1)}).parallel(cc.tween().to(.1,{scaleX:1,scaleY:.8}).to(.1,{scaleX:.7,scaleY:.05}),cc.tween().delay(.13).to(.06,{opacity:76.5}),cc.tween().to(.2,{position:l[1],angle:38})).parallel(cc.tween().call(function(){f.showFront()}).to(.03,{scaleX:.5,scaleY:.05,angle:26}).to(.2,{scaleX:1,scaleY:1,angle:0}),cc.tween().to(.03,{opacity:76.5}).to(.1,{opacity:255}),cc.tween().to(.73,{x:this.allHandCardInfo[1].pos.x,y:this.allHandCardInfo[1].pos.y,angle:this.allHandCardInfo[1].angle},{easing:cc.easing.sineOut})).start());var m=this.allHandCard[0];m&&(o=2*t.spaceTime,y.MathUtils.lookAt(l[0],a),cc.tween(m.node).delay(o).set({angle:12,opacity:255}).call(function(){e.dispatch(v.GameEvent.Voice.PLAY_EFFECT_OTHER,c.AudioFile.Game.SEND_CARD),e.dispatch(v.GameEvent.Desk.REDUCE_CARD_NUM,1)}).parallel(cc.tween().to(.1,{scaleX:1,scaleY:.8}).to(.1,{scaleX:.7,scaleY:.05}),cc.tween().delay(.13).to(.06,{opacity:76.5}),cc.tween().to(.2,{position:l[0]})).parallel(cc.tween().call(function(){m.showFront()}).to(.03,{scaleX:.5,scaleY:.05,angle:12}).to(.2,{scaleX:1,scaleY:1,angle:0}),cc.tween().to(.03,{opacity:76.5}).to(.1,{opacity:255}),cc.tween().to(.7,{x:this.allHandCardInfo[0].pos.x,y:this.allHandCardInfo[0].pos.y,angle:this.allHandCardInfo[0].angle},{easing:cc.easing.sineOut})).start())},e.prototype.initHandCardsPosition=function(t){var e;e=t?this.ui.getCurHandCardDatas().length:this.getCardNum(),this.initCardPosition(e),this.sortHandCards()},e.prototype.initCardPosition=function(t){var e=this;this.regCardPosition(t,function(t,a,o,i,r){var n=e.allHandCardInfo[t]||_.CardPosInfo.get();n.pos=y.MathUtils.pointAtCircle(e.circlePos.x,e.circlePos.y,o,a),n.angle=i,n.zIndex=r,e.allHandCardInfo[t]=n})},e.prototype.regCardPosition=function(t,e){if(e)for(var a,o=y.MathUtils.ANGLE_TO_RADIAN,i=0,r=0,s=0,c=0,d=0,l=[0,7,7,7,7,7,7],p=[0,7,7,7,7,7,7],h=t>4?2:1,u=this.RadiusOffset,C=0;C<h;C++){0===C?(r=0,c=90+(d=l[s=Math.min(4,t)-1])*s/2,i=this.Radius):(r=4,c=90+(d=p[s=t-4])*s/2,i=this.Radius+u);for(var f=0;f<=s;f++)e(f+r,i,(a=c-d*f)*o,a-90,100*(h-C)+f+n.CARD)}},e.prototype.upCardByIndex=function(t){var e=this.allHandCard[t];if(e){var a=this.allHandCard.length,o=y.MathUtils.ANGLE_TO_RADIAN,i=0,r=0,n=0,s=0,c=0;t>3?(r=t-4,n=a-4,i=this.Radius+this.RadiusOffset+50,s=90+(c=[0,7,7,7,7,7,7][n])*n/2):(r=t,n=Math.min(4,a)-1,i=this.Radius+50,s=90+(c=[0,7,7,7,7,7,7][n])*n/2);var d=s-c*r,l=d*o,p=this.allHandCardInfo[t];return p.pos=y.MathUtils.pointAtCircle(this.circlePos.x,this.circlePos.y,l,i),p.angle=d-90,p.zIndex=100+r,e.cardPosInfo=p,e.moveToUpPosition(m.ScopaConstant.UP_OUT_CARD_TIME),p}},e.prototype.initCardByLogicData=function(t){this.clear();for(var e,a=t.length,o=this.allHandCardInfo,i=0;i<a;i++){var r=o[i];(e=this.getNewCard()).init({meta:t[i],posInfo:r}),e.node.zIndex=r.zIndex,this.allHandCard.push(e)}},e.prototype.selectCardByIndx=function(t){var e=null,a=this.allHandCard,o=a.length;return t>=0&&t<o&&(e=a[t]),e},e.prototype.removeCardItemByIndx=function(t){var e=this.getCardItemByIndex(t);e&&(u.NodePoolMgr.getInstance().getPool(g.UIMyHandPoker.NAME).put(e.node),this.allHandCard.splice(t,1),this.hideCardLight(),this.initHandCardsPosition(!1),this.allCardMoveToFinalPos())},e.prototype.doOutCardAction=function(t,e,a,o){var i=this,r=this.getCardItemByIndex(t);if(r){var n=this.ui.getDataDelegate(),c=r.cardData.o;if(e&&(a=n.getThrowCardIndex(c,!0))===s.PosState.MergePos&&!1===n.isCardCanOut(c))return!1;(o=o||r.cardPosInfo.copy()).pos=cc.v2(r.node.parent.convertToWorldSpaceAR(o.pos));var d=0;return this.allHandCard.length>1&&(d=m.ScopaConstant.UP_CARD_STOP_TIME),cc.tween(this.node).delay(d).call(function(){i.removeCardItemByIndx(t),i.throwCard(c,o,e,a)}).start(),!0}},e.prototype.throwCard=function(t,e,a,o){this.dispatch(v.GameEvent.HandCard.DESK_CARD_THROW,{viewId:0,cardData:t,fromPos:e,isOutCardMySelf:a,throwCardIndex:o}),this.dispatch(l.Notify.Base.PLAY_EFFECT,{path:c.AudioFile.Game.OUT_CARD})},e.prototype.allCardMoveToUpPos=function(){var t=this,e=this.allHandCard.length;this.regCardPosition(e,function(e,a,o){var i=a+50,r=t.allHandCard[e];r&&(r.cardPosInfo.pos=y.MathUtils.pointAtCircle(t.circlePos.x,t.circlePos.y,o,i))});for(var a=0;a<e;a++)this.allHandCard[a].moveToUpPosition(m.ScopaConstant.UP_OUT_CARD_TIME);return e},e.prototype.allCardMoveToFinalPos=function(){for(var t=0;t<this.allHandCard.length;t++){var e=this.allHandCard[t];e.node.zIndex=this.allHandCardInfo[t].zIndex,e.setFinalPos(this.allHandCardInfo[t].pos,!0),e.setFinalAngle(this.allHandCardInfo[t].angle,!0),e.moveToFinalPosition()}},e.prototype.handCardRefreash=function(t){this.initHandCardsPosition(!0),this.initCardByLogicData(t)},e.prototype.showCardLight=function(){for(var t=this.allHandCard.length,e=0;e<t;e++){var a=this.allHandCard[e];a&&(this.cardLights[e]||(this.cardLights[e]=p.ComUI.createSprite("pk_front_light",d.gAssetBundleName.SCOPA_GOLD_RES),this.cardLights[e].node.parent=this.node,this.cardLights[e].node.zIndex=n.CARD_BG_LIGHT+e,this.cardLights[e].node.scale=a.node.scale),this.cardLights[e].node.active=!0,this.cardLights[e].node.angle=a.node.angle,this.cardLights[e].node.position=a.node.position,a.showNoShadowFront())}},e.prototype.hideCardLight=function(){for(var t=0;t<this.cardLights.length;t++){this.cardLights[t]&&(this.cardLights[t].node.active=!1);var e=this.allHandCard[t];e&&e.showShadowFront()}},e.prototype.clear=function(){this.curSendOverCardNum=0,this.clearHandCard()},e.prototype.cardBeHold=function(t,e){var a=this.getCardItemByIndex(t);return a&&a.setBeHold(e),a},e.prototype.holdCardOn=function(t,e){this.clearHoldCard();var a=this.cardBeHold(t,!0);if(a){var o=this.node.convertToNodeSpaceAR(e);this.createHoldCard(a,o),this.pHoldCard.holdOn()}},e.prototype.createHoldCard=function(t,e){var a=0;return this.pfMyHandCard?(this.pHoldCard=this.getNewCard(),this.pHoldCard?(this.pHoldCard.init({meta:t.cardData,posInfo:t.cardPosInfo}),this.pHoldCard.node.zIndex=n.HOLD_CARD,this.pHoldCard.node.x=e.x,this.pHoldCard.node.y=e.y):a=1):a=2,a>0&&f.Logger.error(" UITouchHandCard holdCardOn errorCode is "+a+" "+["this.pfMyHandCard is null "," can not instantiate this.holdCardPrefab  "][a]),this.pHoldCard},e.prototype.clearHoldCard=function(){this.pHoldCard&&(this.pHoldCard.clear(),this.unuseCards.push(this.pHoldCard),this.pHoldCard=null)},e.prototype.holdCardMove=function(t){if(this.pHoldCard){var e=this.pHoldCard.node.parent.convertToNodeSpace(t);this.pHoldCard.node.setPosition(e)}},e.prototype.holdCardOff=function(){this.clearHoldCard(),this.cardBeHold(this.curSelectCardIndx,!1)},e.prototype.getHoldCardPosInfo=function(){if(this.pHoldCard){var t=this.pHoldCard.cardPosInfo.copy();return t.pos=this.pHoldCard.node.parent.convertToWorldSpace(cc.v2(this.pHoldCard.node.position)),t}return null},e.prototype.doRedealCard=function(t){for(var e,a=cc.v3(t.pos),o=this.allHandCard,i=function(t){var i=o[t];i&&(e=.16*t,cc.tween(i.node).delay(e).parallel(cc.tween().to(.23,{scaleX:.1,scaleY:.6}).to(.03,{scaleX:.15,scaleY:.75}).call(function(){i.showBack()}).to(.23,{scaleX:.6,scaleY:.6}),cc.tween().to(.5,{x:a.x,y:a.y,angle:0})).set({active:!1}).start())},r=o.length-1;r>=0;r--)i(r)},r([D({type:cc.Prefab,tooltip:"\u624b\u724c"})],e.prototype,"pfMyHandCard",void 0),r([P],e)}(h.CxCompExt);a.UIMyHandCardList=b,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/const/Global":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/view/ComUI":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/manager/NodePoolMgr":void 0,"../../../../script/lib/utils/Display":void 0,"../../../../script/lib/utils/Logger":void 0,"../../../../script/lib/utils/MathUtils":void 0,"../../../../script/lib/utils/ScreenAdapter":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../../../gameBaseSrc/model/ScopaConstant":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0,"../poker/UIMyHandPoker":"UIMyHandPoker","./../../../gameBaseSrc/alg/ScopaLogic":void 0,"./UIMyHandPokerView":"UIMyHandPokerView"}],UIMyHandPokerView:[function(t,e,a){"use strict";cc._RF.push(e,"d26f92ib/5CL7C5knUODwO5","UIMyHandPokerView");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIMyHandPokerView=void 0;var n=t("../../../../script/lib/utils/Logger"),s=t("../../../gameBaseSrc/alg/ScopaLogic"),c=t("../../../gameBaseSrc/model/GameEvent"),d=t("../../../gameBaseSrc/view/base/BaseHandCardsView"),l=t("./UIMyHandCardList"),p=t("./UISingleCardTouchBehavior"),h=cc._decorator,u=h.ccclass,C=(h.property,function(t){function e(){var e=t.call(this)||this;return e._curSelectCardIndex=-1,e.isSelectOutCardAndWaitServer=!1,e._isSendingCard=!1,e.viewId=0,e.handCardLSDatas=[],e}return i(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.curDisplayMode=e.curDisplayMode},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.pCardList=this.getComponent(l.UIMyHandCardList),this.pCardList&&this.pCardList.init(),this._pTouchBehavior=this.getComponent(p.default),this._pTouchBehavior&&this._pTouchBehavior.init()},e.prototype.isSendingCard=function(){return this._isSendingCard},e.prototype.sortHandCards=function(){},e.prototype.onStartSendCard=function(){this.clear(),this._pTouchBehavior.setCanTouch(!1),this._pTouchBehavior.setMeCanOutCard(!1),this._isSendingCard=!0},e.prototype.onEndSendCard=function(){this.node.stopAllActions(),this.curSendOverCardNum=0,this._pTouchBehavior.setCanTouch(!0),this._isSendingCard=!1},e.prototype.onSendingCard=function(t){this.clear(),this._pTouchBehavior.setCanTouch(!1),s.LocalCardSt.put(this.handCardLSDatas),this.handCardLSDatas=null,this.handCardLSDatas=s.ScopaLogic.bytesToLocal(t.cardDatas),this.pCardList&&this.pCardList.doSendCardAction(t)},e.prototype.doOutCard=function(t,e){this.dispatch(c.GameEvent.OperateEvent.OUT_CARD_SELF,{outCard:t,eatCards:e}),this._pTouchBehavior.setCanTouch(!1),this._pTouchBehavior.setMeCanOutCard(!1)},e.prototype.outHandCardItemByIndex=function(t,e,a,o){var i=null;if(0==this.isSelectOutCardAndWaitServer&&this.pCardList){this.isSelectOutCardAndWaitServer=!0;var r=this.pCardList.getCardItemByIndex(t);r&&(i=r.cardData.o,this.pCardList.hideCardLight(),this.pCardList.doOutCardAction(t,a,e,o),this.pCardList.clearCardFlag())}return i},e.prototype.selectCancelAndResortCard=function(t,e){this._curSelectCardIndex=-1,this.pCardList&&(this.pCardList.initHandCardsPosition(!1),this.pCardList.orderHandCard(t,e),this.pCardList.selectCancle(),this.pCardList.hideCardLight()),this.dispatch(c.GameEvent.HandCard.MY_HAND_CARD_SELECT,{isSelect:!1}),this.dispatch(c.GameEvent.Com.CARD_HIGH_LIGHT_ORANGE,{isDisplay:!1})},e.prototype.checkHandCardCorrect=function(t){var e=!0,a=this.pCardList.allHandCard;if(a.length==t.length)for(var o=0;o<a.length;o++){var i=a[o],r=i.cardData;if(i&&r&&r.r!=t[o].r){e=!1;break}}else e=!1;return e},e.prototype.outCardByServerData=function(t,e){this.outHandCardItemByIndex(this.pCardList.getCardItemIndexByData(t),e,!1)},e.prototype.outCardByTouch=function(t,e){var a=this.outHandCardItemByIndex(t,-2,!0,e);a?this.doOutCard(a):n.Logger.error("not found cardIndx="+t+" carddata")},e.prototype.operateResult=function(){0==this.checkHandCardCorrect(this.handCardLSDatas)&&(n.Logger.error("UIMyHandCardView \u624b\u724c\u6570\u636e\u6709\u8bef\uff0c\u91cd\u7f6e\uff01\uff01\uff01"),this.handCardRefreash(),this.pCardList&&(this.pCardList.setCurSelectCardIndx(-1),this.pCardList.orderHandCard(!1,!1),this.pCardList.selectCancle(),this.pCardList.hideCardLight()))},e.prototype.updateData=function(t){this.handCardLSDatas=[],t.handCardDatas&&(s.LocalCardSt.put(this.handCardLSDatas),this.handCardLSDatas=null,this.handCardLSDatas=s.ScopaLogic.bytesToLocal(t.handCardDatas||[],!0,!0))},e.prototype.setCurSelectCardIndex=function(t){this._curSelectCardIndex=t},e.prototype.getCurSelectCardIndex=function(){return this._curSelectCardIndex},e.prototype.handCardRefreash=function(){this.pCardList&&this.pCardList.handCardRefreash(this.handCardLSDatas)},e.prototype.getCurHandCardDatas=function(){return this.handCardLSDatas},e.prototype.outCardResult=function(t){s.LocalCardSt.put(this.handCardLSDatas),this.handCardLSDatas=null,this.pCardList.holdCardOff(),this.handCardLSDatas=s.ScopaLogic.bytesToLocal(t.handCardDatas),0==this.isSelectOutCardAndWaitServer&&this.outCardByServerData(t.outCardData,t.throwCardIndex),this.isSelectOutCardAndWaitServer=!1,this._pTouchBehavior.setMeCanOutCard(!1),this._pTouchBehavior.setCanTouch(!1)},e.prototype.clearHandCard=function(){this.pCardList&&this.pCardList.clearHandCard()},e.prototype.clear=function(){t.prototype.clear.call(this),this.clearHandCard()},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(c.GameEvent.Base.GAME_RESULT,this.onGameEnd),this.bindEvent(c.GameEvent.HandCard.SET_CAN_TOUCH,this.onSetCanTouch),this.bindEvent(c.GameEvent.HandCard.UPDATE_DATA,this.onUpdateData),this.bindEvent(c.GameEvent.HandCard.PLAYER_OUT_CARD_RESULT,this.onGameOutCard),this.bindEvent(c.GameEvent.HandCard.PLAYER_OP_RESULT,this.onGameOpResult),this.bindEvent(c.GameEvent.HandCard.SCENE_PLAYING,this.doScenePlaying),this.bindEvent(c.GameEvent.Com.SET_DATA_DELEGATE,this.setDataDelegate)},e.prototype.onGameEnd=function(){this.pCardList&&(this.pCardList.selectCancle(),this.pCardList.clearCardFlag()),this.isSelectOutCardAndWaitServer=!1,this._pTouchBehavior.setCanTouch(!1),this.selectCancelAndResortCard(!1,!1)},e.prototype.onUpdateData=function(t){0==t.viewId&&this.updateData({handCardDatas:t.handCardDatas})},e.prototype.onSetCanTouch=function(t){this._pTouchBehavior.setCanTouch(t),this._pTouchBehavior.setMeCanOutCard(t)},e.prototype.getCanTouch=function(){return this._pTouchBehavior.getCanTouch()},e.prototype.onGameOutCard=function(t){void 0!==t&&null!=t&&t!=={}&&0==t.viewId&&this.outCardResult(t)},e.prototype.onGameOpResult=function(t){void 0!==t&&null!=t&&t!=={}&&t.viewId==this.viewId&&(s.LocalCardSt.put(this.handCardLSDatas),this.handCardLSDatas=null,this.handCardLSDatas=s.ScopaLogic.bytesToLocal(t.handCardDatas),this.operateResult())},e.prototype.doScenePlaying=function(t){this.updateData({handCardDatas:t.allHandCardDatas[0]}),this.pCardList.hideCardLight(),this.isSelectOutCardAndWaitServer=!1,this.handCardRefreash()},e.prototype.onInformPlayerOp=function(t){0===t.curOperateViewId?(this._pTouchBehavior.setCanTouch(!0),this._pTouchBehavior.setMeCanOutCard(!0),this.isSelectOutCardAndWaitServer=!1,this.pCardList&&this.pCardList.showCardLight()):this.pCardList&&(this.pCardList.hideCardLight(),this.pCardList.grayCardsAll(!1))},e.prototype.onRedealCard=function(t){this.pCardList.doRedealCard(t)},r([u],e)}(d.BaseHandCardsView));a.UIMyHandPokerView=C,cc._RF.pop()},{"../../../../script/lib/utils/Logger":void 0,"../../../gameBaseSrc/alg/ScopaLogic":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../../../gameBaseSrc/view/base/BaseHandCardsView":void 0,"./UIMyHandCardList":"UIMyHandCardList","./UISingleCardTouchBehavior":"UISingleCardTouchBehavior"}],UIMyHandPoker:[function(t,e,a){"use strict";cc._RF.push(e,"51d99egxPtAnaWZf8ezc1DJ","UIMyHandPoker");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIMyHandPoker=void 0;var n,s=t("../../../../script/app/const/Global"),c=t("../../../../script/lib/manager/ResManager"),d=t("../../../gameBaseSrc/model/ScopaConstant"),l=t("../../../gameBaseSrc/view/PokerCreator"),p=t("./UIPokerCardBase");(function(t){t[t.ZZ_N=255]="ZZ_N",t[t.ZZ_P=255]="ZZ_P",t[t.ZZ_S=0]="ZZ_S"})(n||(n={}));var h=cc._decorator,u=h.ccclass,C=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._unTouch=!1,e._selected=!1,e._preSelected=!1,e._canSelectd=!0,e}return i(e,t),e.prototype.setSelected=function(t,e){void 0===e&&(e=!1),this.canTouch()&&(t?this.spMask&&(this.spMask.node.active=!1):this.spMask&&this._canSelectd&&(this.spMask.node.opacity=n.ZZ_S,this.spMask.node.active=!0),this._selected!=t&&(this.node.stopAllActions(),this._selected=t,null==this.finalPos&&(this.finalPos=cc.v2(this.node.x,this.node.y)),t?e?this.node.setPosition(this.finalPos.x+this.getOffsetX(l.PokerCreator.POKER_SELECTED_OFF_Y),this.finalPos.y+this.getOffsetY(l.PokerCreator.POKER_SELECTED_OFF_Y)):this.node.runAction(cc.moveTo(.06,cc.v2(this.finalPos.x+this.getOffsetX(l.PokerCreator.POKER_SELECTED_OFF_Y),this.finalPos.y+this.getOffsetY(l.PokerCreator.POKER_SELECTED_OFF_Y)))):e?this.node.setPosition(this.finalPos):this.node.runAction(cc.moveTo(.06,this.finalPos))))},e.prototype.isSelected=function(){return this._selected},e.prototype.setPreSelected=function(t){this.canTouch()&&(this._preSelected=t,t?this.spMask&&(this.spMask.node.opacity=n.ZZ_P,this.spMask.node.active=!0):this.spMask&&this._canSelectd&&(this.isSelected()?(this.spMask.node.active=!1,this.spMask.node.opacity=n.ZZ_S):(this.spMask.node.active=!0,this.spMask.node.opacity=n.ZZ_S)))},e.prototype.isPreSelected=function(){return this._preSelected},e.prototype.setCanSelect=function(t){if(this._canSelectd=t,this.spMask){var e=c.default.getInstance().getAltas(this.pokerAtlasFile,s.gAssetBundleName.SCOPA_GOLD_RES);this.spMask.node.active=!t,this.spMask.spriteFrame=e.getSpriteFrame(t?"poker_mask_blue":"poker_mask"),this.spMask.node.opacity=t?n.ZZ_S:n.ZZ_N}},e.prototype.isCanSelect=function(){return this._canSelectd},e.prototype.clearPreSelected=function(){this._preSelected=!1,this.spMask&&this._canSelectd&&(this.isSelected()?(this.spMask.node.active=!1,this.spMask.node.opacity=n.ZZ_S):(this.spMask.node.active=!0,this.spMask.node.opacity=n.ZZ_S))},e.prototype.dealWithPreEvent=function(){return!(!this._preSelected||!this.isSelected()||(this.setSelected(!1),this.clearPreSelected(),0))},e.prototype.setUp=function(t,e,a,o){this.node.stopAllActions(),t?e?cc.tween(this.node).delay(o||0).to(a||.06,{position:cc.v3(this.finalPos.x+this.getOffsetX(56),this.finalPos.y+this.getOffsetY(56))}).to(.06,{position:cc.v3(this.finalPos.x+this.getOffsetX(50),this.finalPos.y+this.getOffsetY(50))}).start():(this.node.x=this.finalPos.x+this.getOffsetX(50),this.node.y=this.finalPos.y+this.getOffsetY(50)):e?cc.tween(this.node).delay(o||0).to(a||.1,{position:cc.v3(this.finalPos.x,this.finalPos.y)}).start():this.node.y=this.finalPos.y},e.prototype.setUnTouch=function(t){this._unTouch=t},e.prototype.canTouch=function(){return!this._unTouch},e.prototype.touch=function(t){return!0===this.node.getBoundingBoxToWorld().contains(t)&&this.canTouch()},e.prototype.moveToUpPosition=function(t){this.node.stopAllActions();var e=t||d.ScopaConstant.UP_OUT_CARD_TIME,a=this.cardPosInfo.pos,o=this.cardPosInfo.angle,i=this.cardPosInfo.scale;cc.tween(this.node).to(e,{position:cc.v3(a),angle:o,scale:i},{easing:cc.easing.quadOut}).start()},e.prototype.displayLightOrange=function(){},e.prototype.sendCardFlip=function(t){var e=this;cc.tween(this.node).delay(t||0).set({scaleX:.7,scaleY:.2}).call(function(){e.createPokerCard(e.cardData)}).to(.1,{scaleX:1,scaleY:1}).delay(.2).call(function(){e.moveToFinalPosition(.3)}).start()},e.prototype.setBeHold=function(t){this.node.opacity=t?0:255},e.prototype.holdOn=function(){},e.prototype.doCanNotOut=function(){cc.tween(this.node).set({scale:1}).to(.2,{scale:1.08}).to(.5,{scale:1.08}).to(.2,{scale:1}).start()},e.prototype.clearFlag=function(){},e.prototype.clear=function(){t.prototype.clear.call(this),this._unTouch=!1,this._selected=!1,this._canSelectd=!0,this._preSelected=!1},e.NAME="UIMyHandPoker",r([u],e)}(p.UIPokerCardBase));a.UIMyHandPoker=C,cc._RF.pop()},{"../../../../script/app/const/Global":void 0,"../../../../script/lib/manager/ResManager":void 0,"../../../gameBaseSrc/model/ScopaConstant":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0,"./UIPokerCardBase":"UIPokerCardBase"}],UIOthersHandCardsView:[function(t,e,a){"use strict";cc._RF.push(e,"318e1fmvMFIOqraB5OE0XZZ","UIOthersHandCardsView");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIOthersHandCardsView=void 0;var n=t("../../../../script/app/const/game/GameConstant"),s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../../script/lib/manager/NodePoolMgr"),d=t("../../../../script/lib/utils/Logger"),l=t("../../../gameBaseSrc/model/GameEvent"),p=t("../poker/UIPokerCardBase"),h=cc._decorator,u=h.ccclass,C=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfHandcards=null,e.playerCardsList=[],e}return i(e,t),e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(l.GameEvent.HandCard.PLAYER_OUT_CARD_RESULT,this.onGameOutCard),this.bindEvent(l.GameEvent.HandCard.PLAYER_OP_RESULT,this.onGameOpResult),this.bindEvent(l.GameEvent.HandCard.SCENE_PLAYING,this.doScenePlaying),this.bindEvent(l.GameEvent.HandCard.UPDATE_DATA,this.onUpdateData),this.bindEvent(l.GameEvent.Base.DESK_BASE_CONFIG,this.onDeskBaseConfig),this.bindEvent(l.GameEvent.Com.SET_DATA_DELEGATE,this.setDataDelegate)},e.prototype.setDataDelegate=function(t){this.playDataDelegate=t},e.prototype.getDataDelegate=function(){return this.playDataDelegate},e.prototype.start=function(){this.pfHandcards||d.Logger.error("UIOthersHandCardsView not found pfHandcards")},e.prototype.onDestroy=function(){this.playerCardsList&&(this.playerCardsList=null),c.NodePoolMgr.getInstance().clearPool(p.UIPokerCardBase.NAME),t.prototype.onDestroy.call(this)},e.prototype.onDeskBaseConfig=function(t){this.initPlayerCards(t)},e.prototype.removeAll=function(){this.clear(),this.playerCardsList&&(this.playerCardsList.forEach(function(t){t.node.destroy()}),this.playerCardsList=[])},e.prototype.initPlayerCards=function(t){var e=this;this.removeAll(),this.playerCardsList=[],(2===t.maxPlayerNum?["UIPlayerCardsView_2"]:3===t.maxPlayerNum?["UIPlayerCardsView_1","UIPlayerCardsView_3"]:["UIPlayerCardsView_1","UIPlayerCardsView_2","UIPlayerCardsView_3"]).forEach(function(a){var o=cc.instantiate(e.pfHandcards),i=null;(i=o.getComponent(a))||(i=o.addComponent(a)),i.init({curDisplayMode:t.curDisplayMode||n.GameConstant.HandCardMode.NORMAL}),i.setDataDelegate(e.getDataDelegate()),o.x=0,o.y=0,e.node.addChild(o),e.playerCardsList.push(i)})},e.prototype.getPlayerCardsByViewId=function(t){for(var e=0;e<this.playerCardsList.length;e++){var a=this.playerCardsList[e];if(a&&a.getViewId()==t)return a}return null},e.prototype.doScenePlaying=function(t){this.clear();for(var e=0,a=this.playerCardsList;e<a.length;e++){var o=a[e],i=o.getViewId();o.updateData({handCardDatas:t.allHandCardDatas[i]}),o.handCardRefreash()}},e.prototype.clear=function(){if(this.node.stopAllActions(),this.playerCardsList)for(var t=0,e=this.playerCardsList;t<e.length;t++)e[t].clear()},e.prototype.onGameMoCard=function(t){if(t.viewId>0){var e=this.getPlayerCardsByViewId(t.viewId);e&&e.updateData(t)}},e.prototype.onGameOutCard=function(t){if(t.viewId>0){var e=this.getPlayerCardsByViewId(t.viewId);e&&(e.updateData(t),e.outCardResult(t))}},e.prototype.onGameOpResult=function(t){if(t.viewId>0){var e=this.getPlayerCardsByViewId(t.viewId);e&&(e.updateData(t),e.operateResult(t))}},e.prototype.refreshHandCard=function(t){if(t>0){var e=this.getPlayerCardsByViewId(t);e&&e.handCardRefreash()}},e.prototype.onUpdateData=function(t){if(t.viewId>0){var e=this.getPlayerCardsByViewId(t.viewId);e&&e.updateData({handCardDatas:t.handCardDatas})}},r([C(cc.Prefab)],e.prototype,"pfHandcards",void 0),r([u],e)}(s.CxCompExt);a.UIOthersHandCardsView=f,cc._RF.pop()},{"../../../../script/app/const/game/GameConstant":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/manager/NodePoolMgr":void 0,"../../../../script/lib/utils/Logger":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../poker/UIPokerCardBase":"UIPokerCardBase"}],UIPlayerCardsViewBase:[function(t,e,a){"use strict";cc._RF.push(e,"f9b41u/q+1MPpCv6CJSuNQx","UIPlayerCardsViewBase");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIPlayerCardsViewBase=void 0;var n=t("../../../gameBaseSrc/alg/ScopaLogic"),s=t("../../../gameBaseSrc/view/base/BaseHandCardsView"),c=cc._decorator,d=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ZIndex={CARD_BG_LIGHT:0,CARD:1e3},e}return i(e,t),e.prototype.onStartSendCard=function(){this.clear()},e.prototype.onEndSendCard=function(){this.node.stopAllActions(),this.curSendOverCardNum=0},e.prototype.onSendingCard=function(t){t.viewId===this.viewId&&(this.clear(),n.LocalCardSt.put(this.handCardLSDatas),this.handCardLSDatas=null,this.handCardLSDatas=n.ScopaLogic.bytesToLocal(t.cardDatas),this.pCardList&&this.pCardList.doSendCardAction(t))},e.prototype.onRedealCard=function(t){this.pCardList.doRedealCard(t)},e.prototype.sendCardEnd=function(){},e.prototype.handCardRefreash=function(){this.pCardList&&this.pCardList.handCardRefreash(this.handCardLSDatas)},e.prototype.clearHandCard=function(){this.pCardList&&this.pCardList.clearHandCard()},e.prototype.clear=function(){t.prototype.clear.call(this),this.clearHandCard()},e.prototype.getCurHandCardDatas=function(){return this.handCardLSDatas},e.prototype.operateResult=function(){},e.prototype.updateData=function(t){n.LocalCardSt.put(this.handCardLSDatas),this.handCardLSDatas=null,this.handCardLSDatas=n.ScopaLogic.bytesToLocal(t.handCardDatas)},e.prototype.onInformPlayerOp=function(){},r([d],e)}(s.BaseHandCardsView));a.UIPlayerCardsViewBase=l,cc._RF.pop()},{"../../../gameBaseSrc/alg/ScopaLogic":void 0,"../../../gameBaseSrc/view/base/BaseHandCardsView":void 0}],UIPlayerCardsView_1:[function(t,e,a){"use strict";cc._RF.push(e,"77fb9I8vPpEZaD2A5oaquLp","UIPlayerCardsView_1");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIPlayerCardsView_1=void 0;var n=t("../../../../script/app/const/AudioFile"),s=t("../../../../script/app/const/game/GameConstant"),c=t("../../../../script/app/event/Notify"),d=t("../../../../script/lib/utils/Display"),l=t("../../../gameBaseSrc/model/GameEvent"),p=t("../../../gameBaseSrc/view/PokerCreator"),h=t("./UIPlayerCardsViewBase"),u=t("./UIPlayerHandCardList"),C=cc._decorator,f=C.ccclass,y=(C.property,function(t){function e(){var e=t.call(this)||this;return e.viewId=1,e.handCardLSDatas=[],e.curSendOverCardNum=0,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.pCardList=this.getComponent(u.UIPlayerHandCardList),this.startPos=cc.v2(d.Display.width,d.Display.cy)},e.prototype.regCardPosition=function(t){var e=p.PokerCreator.POKER_SMALL_CARD_WIDTH+(t-1)*p.PokerCreator.POKER_SMALL_CARD_OFF_X,a=cc.v2(this.startPos.x,this.startPos.y-e/2);this.allHandCardInfo=[];for(var o=0;o<t;o++){var i=cc.v2(a.x,a.y+(o-1)*p.PokerCreator.POKER_SMALL_CARD_OFF_X);this.allHandCardInfo[o]=this.allHandCardInfo[o]||p.CardPosInfo.get(),this.allHandCardInfo[o].pos=i,this.allHandCardInfo[o].angle=90,this.allHandCardInfo[o].zIndex=o+this.ZIndex.CARD}},e.prototype.outCardResult=function(t){var e=t.outCardData,a=e.throwCardIndex,o=null;if(null!=(o=this.curDisplayMode==s.GameConstant.HandCardMode.DISPLAY?this.pCardList.getCardItemByData(e):this.pCardList.getCardItemByIndex(this.pCardList.getCardNum()-1))){var i=o.node.parent,r=cc.Vec3.ZERO;null!=i&&(r=i.convertToWorldSpaceAR(o.node.position));var d=o.cardPosInfo.copy();d.pos=cc.v2(r).add(cc.v2(60,0)),d.scale=.64,this.dispatch(l.GameEvent.HandCard.DESK_CARD_THROW,{viewId:this.viewId,cardData:e,fromPos:d,isOutCardMySelf:!1,throwCardIndex:a}),this.dispatch(c.Notify.Base.PLAY_EFFECT,{path:n.AudioFile.Game.OUT_CARD})}this.curDisplayMode==s.GameConstant.HandCardMode.NORMAL?this.pCardList.removeCardItemByIndex(this.pCardList.getCardNum()-1):this.pCardList.removeCardItemByCardData(e)},r([f],e)}(h.UIPlayerCardsViewBase));a.UIPlayerCardsView_1=y,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/const/game/GameConstant":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/lib/utils/Display":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0,"./UIPlayerCardsViewBase":"UIPlayerCardsViewBase","./UIPlayerHandCardList":"UIPlayerHandCardList"}],UIPlayerCardsView_2:[function(t,e,a){"use strict";cc._RF.push(e,"f68b2ERgH1PcrcwhMoH6uW8","UIPlayerCardsView_2");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIPlayerCardsView_2=void 0;var n=t("../../../../script/app/const/AudioFile"),s=t("../../../../script/app/const/game/GameConstant"),c=t("../../../../script/app/event/Notify"),d=t("../../../../script/lib/utils/Display"),l=t("../../../gameBaseSrc/alg/ScopaLogic"),p=t("../../../gameBaseSrc/model/GameEvent"),h=t("../../../gameBaseSrc/view/PokerCreator"),u=t("./UIPlayerCardsViewBase"),C=t("./UIPlayerHandCardList"),f=cc._decorator,y=f.ccclass,S=(f.property,function(t){function e(){var e=t.call(this)||this;return e.viewId=2,e.handCardLSDatas=[],e.curSendOverCardNum=0,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.startPos=cc.v2(d.Display.cx,d.Display.height-161-h.PokerCreator.POKER_SMALL_CARD_HEIGHT/2-d.Display.paddingTop),this.pCardList=this.getComponent(C.UIPlayerHandCardList)},e.prototype.regCardPosition=function(t){var e=h.PokerCreator.POKER_SMALL_CARD_WIDTH+(t-1)*h.PokerCreator.POKER_SMALL_CARD_OFF_X,a=cc.v2(this.startPos.x+e/2,this.startPos.y);this.allHandCardInfo=[];for(var o=0;o<t;o++){var i=cc.v2(a.x-o*h.PokerCreator.POKER_SMALL_CARD_OFF_X,a.y);this.allHandCardInfo[o]=this.allHandCardInfo[o]||h.CardPosInfo.get(),this.allHandCardInfo[o].pos=i,this.allHandCardInfo[o].angle=0,this.allHandCardInfo[o].zIndex=o+this.ZIndex.CARD,this.allHandCardInfo[o].scale=.6}},e.prototype.outCardResult=function(t){var e=this,a=t.outCardData,o=t.throwCardIndex,i=null;if(null!=(i=this.curDisplayMode==s.GameConstant.HandCardMode.DISPLAY?this.pCardList.getCardItemByData(a):this.pCardList.getCardItemByIndex(this.pCardList.getCardNum()-1))){var r=i.node.parent,d=cc.Vec3.ZERO;null!=r&&(d=r.convertToWorldSpaceAR(i.node.position));var h=i.cardPosInfo.copy();h.pos=cc.v2(d).sub(cc.v2(0,150)),h.scale=.45,cc.tween(i.node).delay(.03).set({zIndex:this.pCardList.getCardNum()}).call(function(){i.createPokerCard(l.LocalCardSt.get(a)),e.pCardList.hideCardLight(),e.dispatch(p.GameEvent.HandCard.DESK_CARD_THROW,{viewId:e.viewId,cardData:a,fromPos:h,isOutCardMySelf:!1,throwCardIndex:o}),e.curDisplayMode==s.GameConstant.HandCardMode.NORMAL?e.pCardList.removeCardItemByIndex(e.pCardList.getCardNum()-1):e.pCardList.removeCardItemByCardData(a),e.dispatch(c.Notify.Base.PLAY_EFFECT,{path:n.AudioFile.Game.OUT_CARD})}).start()}},r([y],e)}(u.UIPlayerCardsViewBase));a.UIPlayerCardsView_2=S,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/const/game/GameConstant":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/lib/utils/Display":void 0,"../../../gameBaseSrc/alg/ScopaLogic":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0,"./UIPlayerCardsViewBase":"UIPlayerCardsViewBase","./UIPlayerHandCardList":"UIPlayerHandCardList"}],UIPlayerCardsView_3:[function(t,e,a){"use strict";cc._RF.push(e,"c5fe7sdKW5BBJxpVOn/sC6D","UIPlayerCardsView_3");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIPlayerCardsView_3=void 0;var n=t("../../../../script/app/const/AudioFile"),s=t("../../../../script/app/const/game/GameConstant"),c=t("../../../../script/app/event/Notify"),d=t("../../../../script/lib/utils/Display"),l=t("../../../gameBaseSrc/model/GameEvent"),p=t("../../../gameBaseSrc/view/PokerCreator"),h=t("./UIPlayerCardsViewBase"),u=t("./UIPlayerHandCardList"),C=cc._decorator,f=C.ccclass,y=(C.property,function(t){function e(){var e=t.call(this)||this;return e.viewId=3,e.handCardLSDatas=[],e.curSendOverCardNum=0,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.pCardList=this.getComponent(u.UIPlayerHandCardList),this.startPos=cc.v2(0,d.Display.cy)},e.prototype.regCardPosition=function(t){var e=p.PokerCreator.POKER_SMALL_CARD_WIDTH+(t-1)*p.PokerCreator.POKER_SMALL_CARD_OFF_X,a=cc.v2(this.startPos.x,this.startPos.y+e/2);this.allHandCardInfo=[];for(var o=0;o<t;o++){var i=cc.v2(a.x,a.y-(o-1)*p.PokerCreator.POKER_SMALL_CARD_OFF_X);this.allHandCardInfo[o]=this.allHandCardInfo[o]||p.CardPosInfo.get(),this.allHandCardInfo[o].pos=i,this.allHandCardInfo[o].angle=-90,this.allHandCardInfo[o].zIndex=t-o+this.ZIndex.CARD}},e.prototype.outCardResult=function(t){var e=t.outCardData,a=t.throwCardIndex,o=null;if(null!=(o=this.curDisplayMode==s.GameConstant.HandCardMode.DISPLAY?this.pCardList.getCardItemByData(e):this.pCardList.getCardItemByIndex(this.pCardList.getCardNum()-1))){var i=o.node.parent,r=cc.Vec3.ZERO;null!=i&&(r=i.convertToWorldSpaceAR(o.node.position));var d=o.cardPosInfo.copy();d.pos=cc.v2(r).sub(cc.v2(60,0)),d.scale=.64,this.dispatch(l.GameEvent.HandCard.DESK_CARD_THROW,{viewId:this.viewId,cardData:e,fromPos:d,isOutCardMySelf:!1,throwCardIndex:a}),this.dispatch(c.Notify.Base.PLAY_EFFECT,{path:n.AudioFile.Game.OUT_CARD})}this.curDisplayMode==s.GameConstant.HandCardMode.NORMAL?this.pCardList.removeCardItemByIndex(this.pCardList.getCardNum()-1):this.pCardList.removeCardItemByCardData(e)},r([f],e)}(h.UIPlayerCardsViewBase));a.UIPlayerCardsView_3=y,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/const/game/GameConstant":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/lib/utils/Display":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0,"./UIPlayerCardsViewBase":"UIPlayerCardsViewBase","./UIPlayerHandCardList":"UIPlayerHandCardList"}],UIPlayerHandCardList:[function(t,e,a){"use strict";cc._RF.push(e,"3ba3e6tu1dFNoHLjJCvO4YI","UIPlayerHandCardList");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIPlayerHandCardList=void 0;var n=t("../../../../script/app/const/AudioFile"),s=t("../../../../script/app/const/game/GameConstant"),c=t("../../../../script/app/const/Global"),d=t("../../../../script/app/view/ComUI"),l=t("../../../../script/lib/base/CxCompExt"),p=t("../../../../script/lib/manager/NodePoolMgr"),h=t("../../../../script/lib/utils/MathUtils"),u=t("../../../gameBaseSrc/alg/ScopaLogic"),C=t("../../../gameBaseSrc/model/GameEvent"),f=t("../poker/UIPokerCardBase"),y=t("./UIPlayerCardsViewBase"),S=cc._decorator,v=S.ccclass,m=S.property,_=function(t){function e(){var e=t.call(this)||this;return e.pfHandCard=null,e.cardLights=[],e.allHandCard=[],e.unuseCards=[],e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.ui=this.getComponent(y.UIPlayerCardsViewBase)},e.prototype.onDestroy=function(){this.ui&&(this.ui=null),p.NodePoolMgr.getInstance().clearPool(f.UIPokerCardBase.NAME),t.prototype.onDestroy.call(this),this.cardLights=null,this.allHandCard=null},e.prototype.getCardNum=function(){return this.allHandCard.length},e.prototype.hideAllCards=function(){for(var t=0,e=this.allHandCard;t<e.length;t++)e[t].node.active=!1},e.prototype.initCardPosition=function(t){var e;e=t?this.ui.getCurHandCardDatas().length:this.getCardNum(),this.ui.regCardPosition(e)},e.prototype.initCardByLogicData=function(t){var e;this.clear();for(var a=this.ui.allHandCardInfo,o=u.LocalCardSt.get(0),i=0;i<t.length;i++)this.ui.getCurDisplayMode()===s.GameConstant.HandCardMode.DISPLAY&&(o=t[i]),(e=this.getNewCard()).init({meta:o,posInfo:a[i]}),this.allHandCard.push(e)},e.prototype.clearHandCard=function(){for(var t=0,e=this.allHandCard;t<e.length;t++){var a=e[t];a.clear(),this.unuseCards.push(a)}this.allHandCard=[]},e.prototype.getCardItemByIndex=function(t){return t>=0&&t<this.allHandCard.length?this.allHandCard[t]:null},e.prototype.getCardItemIndexByData=function(t){for(var e=-1,a=this.allHandCard.length-1;a>=0;a--)if(this.allHandCard[a].cardData.r==t){e=a;break}return e},e.prototype.removeCardItemByIndex=function(t){var e=this.getCardItemByIndex(t);e&&(e.clear(),this.unuseCards.push(e),this.allHandCard.splice(t,1),this.initCardPosition(!1),this.allCardMoveToFinalPos())},e.prototype.doSendCardAction=function(t){var e=this;this.initCardPosition(!0),this.hideCardLight();var a=cc.v3(t.fromPos);a.x+=34,a.y+=100;for(var o,i,r=this.ui.getCurHandCardDatas(),s=this.ui.allHandCardInfo,c=[],d=null,l=0;l<r.length;l++){var p=s[l];c[l]=cc.v3(p.pos.x-15,p.pos.y),(d=this.getNewCard()).init({meta:u.LocalCardSt.get(0),posInfo:p}),d.node.position=a,d.node.scale=.6,d.node.opacity=0,this.allHandCard.push(d)}var f=this.allHandCard[0];f&&(o=h.MathUtils.lookAt(a,c[0]),i=0*t.spaceTime,cc.tween(f.node).delay(i).set({angle:o,opacity:255}).call(function(){e.dispatch(C.GameEvent.Voice.PLAY_EFFECT_OTHER,n.AudioFile.Game.SEND_CARD),e.dispatch(C.GameEvent.Desk.REDUCE_CARD_NUM,1)}).to(.47,{position:c[0],angle:0}).to(.33,{x:s[0].pos.x,y:s[0].pos.y,angle:s[0].angle},{easing:cc.easing.quadOut}).start());var y=this.allHandCard[1];y&&(o=h.MathUtils.lookAt(a,c[1]),i=1*t.spaceTime,cc.tween(y.node).delay(i).set({angle:o,opacity:255}).call(function(){e.dispatch(C.GameEvent.Voice.PLAY_EFFECT_OTHER,n.AudioFile.Game.SEND_CARD),e.dispatch(C.GameEvent.Desk.REDUCE_CARD_NUM,1)}).to(.47,{position:c[1],angle:0}).to(.33,{x:s[1].pos.x,y:s[1].pos.y,angle:s[1].angle},{easing:cc.easing.quadOut}).start());var S=this.allHandCard[2];S&&(o=h.MathUtils.lookAt(a,c[2]),i=2*t.spaceTime,cc.tween(S.node).delay(i).set({angle:o,opacity:255}).call(function(){e.dispatch(C.GameEvent.Voice.PLAY_EFFECT_OTHER,n.AudioFile.Game.SEND_CARD),e.dispatch(C.GameEvent.Desk.REDUCE_CARD_NUM,1)}).to(.47,{position:c[2],angle:0}).to(.33,{x:s[2].pos.x,y:s[2].pos.y,angle:s[2].angle},{easing:cc.easing.quadOut}).start())},e.prototype.allCardMoveToFinalPos=function(){for(var t=this.ui.allHandCardInfo,e=0;e<this.allHandCard.length;e++){var a=this.allHandCard[e];a.node.zIndex=this.ui.ZIndex.CARD+e,a.setFinalPos(t[e].pos,!0),a.moveToFinalPosition()}},e.prototype.handCardRefreash=function(t){this.initCardPosition(!0),this.initCardByLogicData(t)},e.prototype.clear=function(){this.clearHandCard()},e.prototype.getCardItemByData=function(t){for(var e=0;e<this.allHandCard.length;e++)if(this.allHandCard[e].cardData.r===t)return this.allHandCard[e];return null},e.prototype.removeCardItemByCardData=function(t){var e=this.getCardItemIndexByData(t);this.removeCardItemByIndex(e)},e.prototype.doRedealCard=function(t){for(var e,a=cc.v3(t.pos),o=this.allHandCard,i=0;i<o.length;i++){var r=o[i];r&&(e=.16*i,cc.tween(r.node).delay(e).to(.5,{x:a.x,y:a.y,scaleX:.6,scaleY:.6}).set({active:!1}).start())}},e.prototype.showCardLight=function(){for(var t=this.allHandCard.length,e=0;e<t;e++){var a=this.allHandCard[e];this.cardLights[e]||(this.cardLights[e]=d.ComUI.createSprite("pk_back_light",c.gAssetBundleName.SCOPA_GOLD_RES),this.cardLights[e].node.parent=this.node,this.cardLights[e].node.zIndex=this.ui.ZIndex.CARD_BG_LIGHT+e,this.cardLights[e].node.scale=a.node.scale),this.cardLights[e].node.active=!0,this.cardLights[e].node.angle=a.node.angle,this.cardLights[e].node.position=a.node.position}},e.prototype.hideCardLight=function(){for(var t=0;t<this.cardLights.length;t++)this.cardLights[t]&&(this.cardLights[t].node.active=!1)},e.prototype.getNewCard=function(){var t=this.unuseCards.shift();if(!t){var e=p.NodePoolMgr.getInstance().getPool(f.UIPokerCardBase.NAME).get();e||(e=cc.instantiate(this.pfHandCard)),(t=e.getComponent(f.UIPokerCardBase))||(t=e.addComponent(f.UIPokerCardBase))}return t.node.parent||(t.node.parent=this.node),t.node.active=!0,t},r([m({type:cc.Prefab,tooltip:"\u624b\u724c"})],e.prototype,"pfHandCard",void 0),r([v],e)}(l.CxCompExt);a.UIPlayerHandCardList=_,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/const/Global":void 0,"../../../../script/app/const/game/GameConstant":void 0,"../../../../script/app/view/ComUI":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/manager/NodePoolMgr":void 0,"../../../../script/lib/utils/MathUtils":void 0,"../../../gameBaseSrc/alg/ScopaLogic":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"../poker/UIPokerCardBase":"UIPokerCardBase","./UIPlayerCardsViewBase":"UIPlayerCardsViewBase"}],UIPokerCardBase:[function(t,e,a){"use strict";cc._RF.push(e,"028dfQpaxlCTrLo5FbaHkQQ","UIPokerCardBase");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIPokerCardBase=void 0;var n=t("../../../gameBaseSrc/view/PokerCreator"),s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../../script/lib/utils/ComUtils"),d=t("../../../../script/lib/utils/MathUtils"),l=t("../../../gameBaseSrc/alg/ScopaLogic"),p=t("../../../gameBaseSrc/model/ScopaConstant"),h=t("../../../gameBaseSrc/view/PokerCreator"),u=cc._decorator,C=u.ccclass,f=(u.property,function(t){function e(){var e=t.call(this)||this;return e.cardData=null,e.pokerAtlasFile="ScopaPoker",e.isShowBack=!1,a.spAltas||(n.PokerCreator.init(),a.spAltas=n.PokerCreator.sPokerAltas),e.cardData=null,e.finalScale=1,e.finalAngle=0,e.cardPosInfo=h.CardPosInfo.get(),e}var a;return i(e,t),a=e,e.prototype.reuse=function(){this.node.active=!0},e.prototype.unuse=function(){this.clear()},e.prototype.init=function(e){this.buildCard(),this.clear(),this.cardPosInfo=h.CardPosInfo.get(),e.posInfo&&(this.cardPosInfo=this.cardPosInfo.parse(e.posInfo)),null!=this.cardPosInfo.pos&&(this.finalPos=this.cardPosInfo.pos,this.node.position=cc.v3(this.finalPos)),null!=this.cardPosInfo.angle&&(this.finalAngle=this.cardPosInfo.angle,this.node.angle=this.finalAngle),null!=this.cardPosInfo.scale&&(this.finalScale=this.cardPosInfo.scale,this.node.scale=this.finalScale),null!=this.cardPosInfo.zIndex&&(this.node.zIndex=this.cardPosInfo.zIndex),t.prototype.init.call(this),this.createPokerCard(e.meta)},e.prototype.buildCard=function(){this.spCardBg=this.node.getComponent(cc.Sprite);var t=this.node.getChildByName("sp_color");t&&(this.spColor=t.getComponent(cc.Sprite));var e=this.node.getChildByName("sp_num");e&&(this.spCardNum=e.getComponent(cc.Sprite));var a=this.node.getChildByName("sp_mask");a&&(this.spMask=a.getComponent(cc.Sprite),this.spMask.node.active=!1);var o=this.node.getChildByName("sp_text");o&&(this.spText=o.getComponent(cc.Sprite));var i=this.node.getChildByName("sp_tag");i&&(this.spTag=i.getComponent(cc.Sprite))},e.prototype.createPokerCard=function(t){this.cardData=c.ComUtils.clone(t),null!=this.cardData&&null!=this.cardData&&(this.node.active=!0,this.initBg(),this.initFront(),0==t.r&&this.showBack())},e.prototype.initBg=function(){this.spCardBg&&(this.spCardBg.node.active=!0)},e.prototype.initFront=function(){var t=this.cardData.c,e=this.cardData.l;if(this.spCardBg){this.spCardBg.node.active=!0;var o=n.PokerCreator.isA(this.cardData.o);o?n.PokerCreator.setPokerAFront(this.spCardBg):n.PokerCreator.setPokerFront(this.spCardBg,!0),this.setTagA(o)}this.spColor&&(this.spColor.node.active=!0,this.spColor.spriteFrame=a.spAltas.getSpriteFrame("poker_color_"+t)),this.spCardNum&&(this.spCardNum.node.active=!0,this.spCardNum.spriteFrame=a.spAltas.getSpriteFrame("poker_num_"+t%2+"_"+e)),this.spText&&(this.spText.node.active=!0,this.spText.spriteFrame=a.spAltas.getSpriteFrame("pk0"+t+"_"+e))},e.prototype.setAnchorPoint=function(t,e){this.node.anchorX=t,this.node.anchorY=e,this.spCardBg&&(this.spCardBg.node.anchorX=t,this.spCardBg.node.anchorY=e),this.spText&&(this.spText.node.anchorX=t,this.spText.node.anchorY=e)},e.prototype.showBack=function(){this.isShowBack||(this.isShowBack=!0,this.spCardBg&&n.PokerCreator.setPokerBack(this.spCardBg),this.spColor&&(this.spColor.node.active=!1),this.spCardNum&&(this.spCardNum.node.active=!1),this.spText&&(this.spText.node.active=!1),this.spTag&&(this.spTag.node.active=!1))},e.prototype.showFront=function(){if(this.isShowBack){if(this.isShowBack=!1,this.spCardBg){var t=n.PokerCreator.isA(this.cardData.o);t?n.PokerCreator.setPokerAFront(this.spCardBg):n.PokerCreator.setPokerFront(this.spCardBg,!0),this.setTagA(t)}this.spColor&&(this.spColor.node.active=!0),this.spCardNum&&(this.spCardNum.node.active=!0),this.spText&&(this.spText.node.active=!0)}},e.prototype.getCardColor=function(){return this.cardData.c},e.prototype.getCardValue=function(){return this.cardData.l},e.prototype.setCardData=function(t){this.cardData=t},e.prototype.getCardData=function(){return this.cardData},e.prototype.setFinalInfo=function(t){this.finalAngle=t.angle,this.finalScale=t.scale,this.finalPos=t.pos},e.prototype.setFinalScale=function(t,e){this.finalScale=t,this.cardPosInfo.scale=t,0==e&&this.directMoveEnd()},e.prototype.setFinalPos=function(t,e){this.finalPos=t,this.cardPosInfo.pos=t,0==e&&this.directMoveEnd()},e.prototype.setFinalAngle=function(t,e){this.finalAngle=t,this.cardPosInfo.angle=t,0==e&&this.directMoveEnd()},e.prototype.directMoveEnd=function(){this.node.stopAllActions(),this.node.x=this.finalPos.x,this.node.y=this.finalPos.y,this.node.angle=this.finalAngle,this.node.scale=this.finalScale},e.prototype.moveToFinalPosition=function(t){this.node.stopAllActions();var e=t||p.ScopaConstant.THROW_OUT_CARD_TIME;cc.tween(this.node).to(e,{position:cc.v3(this.finalPos),angle:this.finalAngle,scale:this.finalScale},{easing:cc.easing.quadOut}).start()},e.prototype.containsInRect=function(t){return this.node.getBoundingBoxToWorld().intersects(t)},e.prototype.hitPos=function(t){return this.node.getBoundingBoxToWorld().contains(t)},e.prototype.getOffsetX=function(t){return d.MathUtils.getPosX(90+this.node.angle,t)},e.prototype.getOffsetY=function(t){return d.MathUtils.getPosY(90-this.node.angle,t)},e.prototype.flipToFront=function(t){var e=this;cc.tween(this.node).delay(t||0).to(.2,{scaleX:.1,scaleY:.47}).delay(.03).call(function(){e.showFront()}).to(.17,{scaleX:.3,scaleY:.3}).start()},e.prototype.flipToBack=function(t){var e=this;cc.tween(this.node).delay(t||0).to(.2,{scaleX:.1,scaleY:.47}).delay(.03).call(function(){e.showBack()}).to(.17,{scaleX:.4,scaleY:.4}).start()},e.prototype.showShadowFront=function(){if(this.spCardBg){var t=n.PokerCreator.isA(this.cardData.o);t?n.PokerCreator.setPokerAFront(this.spCardBg):n.PokerCreator.setPokerFront(this.spCardBg,!1),this.setTagA(t)}},e.prototype.showNoShadowFront=function(){if(this.spCardBg){var t=n.PokerCreator.isA(this.cardData.o);t?n.PokerCreator.setPokerAFront(this.spCardBg):n.PokerCreator.setPokerFront(this.spCardBg,!0),this.setTagA(t)}},e.prototype.setTagA=function(t){this.spTag&&(this.spTag.node.active=t)},e.prototype.clear=function(){t.prototype.clear.call(this),l.LocalCardSt.put(this.cardData),h.CardPosInfo.put(this.cardPosInfo),this.spMask&&(this.spMask.node.active=!1),this.spText&&(this.spText.node.active=!1),this.spColor&&(this.spColor.node.active=!1),this.spCardNum&&(this.spCardNum.node.active=!1),this.spTag&&(this.spTag.node.active=!1),this.node.x=0,this.node.y=0,this.node.anchorX=0,this.node.scale=1,this.node.opacity=255,this.node.angle=0,this.node.active=!1,this.cardData=null,this.finalPos=cc.v2(0,0),this.cardPosInfo=null,this.node.stopAllActions(),this.setAnchorPoint(.5,.5),this.isShowBack=!1},e.NAME="UIPokerCardBase",a=r([C],e)}(s.CxCompExt));a.UIPokerCardBase=f,cc._RF.pop()},{"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/utils/ComUtils":void 0,"../../../../script/lib/utils/MathUtils":void 0,"../../../gameBaseSrc/alg/ScopaLogic":void 0,"../../../gameBaseSrc/model/ScopaConstant":void 0,"../../../gameBaseSrc/view/PokerCreator":void 0}],UIScopaAnim:[function(t,e,a){"use strict";cc._RF.push(e,"12c842Cg9lDtoSUxd6BTn/z","UIScopaAnim");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIScopaAnim=void 0;var n=t("../../../../script/app/module/tables/TableSkinMgr"),s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../gameBaseSrc/model/GameEvent"),d=cc._decorator,l=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skeleton=null,e.skltBS=null,e.ndBeiShu=null,e.labScopaBS=null,e}return i(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.clear()},e.prototype.start=function(){this.skltBS&&(this.skltBS.node.y=this.skeleton.node.y+300)},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(c.GameEvent.GameTips.CLEAR,this.clear),this.bindEvent(c.GameEvent.GameTips.SCOPA,this.onPlayScopa),this.bindEvent(c.GameEvent.Desk.BEI_SHU_POS,this.onGetBeiShuPos)},e.prototype.playScopa=function(t,e){var a=this;this.skeleton&&(this.arrSkeletonData[e]?(this.skeleton.clearTracks(),this.skeleton.setToSetupPose(),this.skeleton.skeletonData=this.arrSkeletonData[e],this.skeleton.node.active=!0,this.skeleton.enabled=!0,this.skeleton.paused=!1,this.skeleton.animation="scopa"):n.TableSkinMgr.getSkeleton("effect/scopa",e).then(function(t){t&&(a.skeleton.enabled=!1,a.skeleton.clearTracks(),a.skeleton.setToSetupPose(),a.skeleton.skeletonData=t,a.skeleton.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.REALTIME),a.skeleton.loop=!1,a.skeleton.paused=!1,a.skeleton.premultipliedAlpha=!1,a.skeleton.node.active=!0,a.skeleton.enabled=!0,a.skeleton.animation="scopa",a.arrSkeletonData[e]=t)})),this.skltBS&&(this.skltBS.enabled=!0,this.skltBS.paused=!1,this.skltBS.node.active=!0,this.skltBS.animation=t>1?"scopa_jiabei":"scopa_jia1")},e.prototype.playWave=function(){this.skeleton&&(this.skeleton.node.parent.active=!0,this.skeleton.enabled=!0,this.skeleton.paused=!1,this.skeleton.animation="bowen")},e.prototype.playBeiShuAnim=function(t){t<=1||!this.posBeishu||(this.labScopaBS.node.active=!0,cc.tween(this.labScopaBS.node).set({x:this.skeleton.node.x,y:this.skeleton.node.y+300,scale:.3,opacity:0}).delay(.23).to(.07,{scale:1.5,opacity:255}).to(.13,{scale:1}).to(.13,{scale:1.2}).delay(.24).to(.06,{scale:1.5}).to(.34,{x:this.posBeishu.x,y:this.posBeishu.y,scale:.15}).set({active:!1}).start())},e.prototype.clear=function(){t.prototype.clear.call(this),this.skeleton&&(this.skeleton.node.active=!1,this.skeleton.paused=!0),this.labScopaBS&&(this.labScopaBS.node.active=!1),this.skltBS&&(this.skltBS.node.active=!1,this.skltBS.paused=!0),this.arrSkeletonData=[]},e.prototype.onGetBeiShuPos=function(t){this.posBeishu=this.labScopaBS.node.parent.convertToNodeSpaceAR(t)},e.prototype.onPlayScopa=function(t){this.skeleton&&(this.skeleton.node.active=!0),t.playScopa?this.playScopa(t.beishu,t.tableId):t.playWave&&this.playWave(),t.beishu&&t.beishu>1&&this.playBeiShuAnim(t.beishu)},r([p({type:sp.Skeleton,tooltip:"scopa"})],e.prototype,"skeleton",void 0),r([p({type:sp.Skeleton,tooltip:"\u52a0\u500d\u52a8\u753b"})],e.prototype,"skltBS",void 0),r([p(cc.Node)],e.prototype,"ndBeiShu",void 0),r([p(cc.Label)],e.prototype,"labScopaBS",void 0),r([l],e)}(s.CxCompExt);a.UIScopaAnim=h,cc._RF.pop()},{"../../../../script/app/module/tables/TableSkinMgr":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../gameBaseSrc/model/GameEvent":void 0}],UIScopaCountView:[function(t,e,a){"use strict";cc._RF.push(e,"eb12anmoFpAEJsXAsW2Dtlu","UIScopaCountView");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UIScopaCountView=void 0;var n=t("../../../../script/app/event/Notify"),s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../gameBaseSrc/model/GameEvent"),d=t("../../../../script/app/view/ComUI"),l=t("../../../../script/app/module/tables/TableSkinMgr"),p=cc._decorator,h=p.ccclass,u=p.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labOurScopaCnt=null,e.labOtherScopaCnt=null,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.clear(),this.changeSkin(l.TableSkinMgr.getCfg())},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.bindEvent(c.GameEvent.Com.GAME_SCENE_CLEAR,this.clear),this.bindEvent(c.GameEvent.Com.READY_NEXT_CLEAR,this.clear),this.bindEvent(c.GameEvent.EatCard.CLEAR,this.clear),this.bindEvent(c.GameEvent.Base.GAME_RESULT,this.clear),this.bindEvent(c.GameEvent.EatCard.SCOPA_COUNT,this.onSetScopaCount),this.bindEvent(c.GameEvent.EatCard.PUT_POINTS,this.onGetEatCardPoints),this.bindEvent(n.Notify.Base.CHANGE_SKIN,this.changeSkin)},e.prototype.changeSkin=function(t){t&&(this.labOurScopaCnt&&d.ComUI.changeLabel(this.labOurScopaCnt,t.font_scopa_count),this.labOtherScopaCnt&&d.ComUI.changeLabel(this.labOtherScopaCnt,t.font_scopa_count))},e.prototype.clear=function(){t.prototype.clear.call(this),this.labOurScopaCnt.string="",this.labOurScopaCnt.node.parent.active=!1,this.labOtherScopaCnt.string="",this.labOtherScopaCnt.node.parent.active=!1},e.prototype.onGetEatCardPoints=function(t){if(t&&t[0]instanceof cc.Vec2){if(this.labOurScopaCnt){var e=this.node.convertToNodeSpace(t[0]);this.labOurScopaCnt.node.parent.x=e.x,this.labOurScopaCnt.node.parent.y=e.y}this.labOtherScopaCnt&&(e=this.node.convertToNodeSpace(t[1]),this.labOtherScopaCnt.node.parent.x=e.x,this.labOtherScopaCnt.node.parent.y=e.y)}},e.prototype.onSetScopaCount=function(t){this.setScopaCount(t.bOurSide,t.count)},e.prototype.setScopaCount=function(t,e){var a;(a=t?this.labOurScopaCnt:this.labOtherScopaCnt)&&(a.string=""+e,a.node.parent.active=e>0)},r([u(cc.Label)],e.prototype,"labOurScopaCnt",void 0),r([u(cc.Label)],e.prototype,"labOtherScopaCnt",void 0),r([h],e)}(s.CxCompExt);a.UIScopaCountView=C,cc._RF.pop()},{"../../../../script/app/event/Notify":void 0,"../../../../script/app/module/tables/TableSkinMgr":void 0,"../../../../script/app/view/ComUI":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../gameBaseSrc/model/GameEvent":void 0}],UISettebelloAnim:[function(t,e,a){"use strict";cc._RF.push(e,"c835e9v3KlBzK+CeETuO1sB","UISettebelloAnim");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UISettebelloAnim=void 0;var n=t("./../../../../script/app/module/tables/TablesConfig"),s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../../script/app/module/tables/TableSkinMgr"),d=cc._decorator,l=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skeleton=null,e.skltGold=null,e}return i(e,t),e.prototype.init=function(t){t.settebello&&this.playSettebello(t.tableId),t.bScopa?(this.skeleton.node.scale=.8,this.skeleton.node.y=180):(this.skeleton.node.scale=1,this.skeleton.node.y=0,this.playGold(t.tableId))},e.prototype.playSettebello=function(t){var e=this;c.TableSkinMgr.getSkeleton("effect/scopa",t).then(function(t){t&&cc.isValid(e)&&e.skeleton&&(e.skeleton.enabled=!1,e.skeleton.clearTracks(),e.skeleton.setToSetupPose(),e.skeleton.skeletonData=t,e.skeleton.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.REALTIME),e.skeleton.loop=!1,e.skeleton.premultipliedAlpha=!1,e.skeleton.node.active=!0,e.skeleton.paused=!1,e.skeleton.enabled=!0,e.skeleton.animation="settebello")}),this.delayCall(function(){e.close()},1.1)},e.prototype.playGold=function(t){if(this.skltGold){var e=c.TableSkinMgr.getTableCfgById(t);e.id!==n.TableID.def&&e.id!==n.TableID.lydxc&&e.id!==n.TableID.hdcz||(this.skltGold.node.active=!0,this.skltGold.enabled=!0,this.skltGold.animation="fjb_g")}},e.prototype.close=function(){this.clear(),t.prototype.close.call(this)},e.prototype.clear=function(){t.prototype.clear.call(this),this.skeleton&&(this.skeleton.node.parent.active=!1,this.skeleton.paused=!0)},r([p(sp.Skeleton)],e.prototype,"skeleton",void 0),r([p(sp.Skeleton)],e.prototype,"skltGold",void 0),r([l],e)}(s.CxCompExt);a.UISettebelloAnim=h,cc._RF.pop()},{"../../../../script/app/module/tables/TableSkinMgr":void 0,"../../../../script/lib/base/CxCompExt":void 0,"./../../../../script/app/module/tables/TablesConfig":void 0}],UISingleCardTouchBehavior:[function(t,e,a){"use strict";cc._RF.push(e,"b5fbfPTg4hGLJ6L+oNDhFLl","UISingleCardTouchBehavior");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0});var n,s=t("../../../../script/lib/base/CxCompExt"),c=t("../../../../script/lib/utils/Logger"),d=t("../../../gameBaseSrc/model/GameEvent"),l=t("./UIMyHandCardList"),p=t("./UIMyHandPokerView");(function(t){t[t.NONE=0]="NONE",t[t.SELECT=1]="SELECT",t[t.HOLD=2]="HOLD"})(n||(n={}));var h=function(){this.isSelected=!1,this.isNewCard=!1},u=cc._decorator,C=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui=null,e.isCardCanTouch=!1,e.isPressing=!1,e.isDoublePressMode=!1,e.isDoublePressed=!1,e.cardSelectStatus=0,e.curSelectCardIndx=-1,e.iTouchId=-1,e.isCanOutCard=!0,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.ui=this.node.getComponent(p.UIMyHandPokerView),this.ui||(this.ui=this.node.addComponent(p.UIMyHandPokerView)),this.pCardList=this.getComponent(l.UIMyHandCardList),this.setCanTouch(!0),this.TouchRect=new cc.Rect(167,130,765,400),this.addTouchEventListener()},e.prototype.onDestroy=function(){this.ui&&(this.ui=null),this.pCardList&&(this.pCardList=null),this.removeEventAtTouchEnd(),t.prototype.onDestroy.call(this)},e.prototype.checkCardCanOut=function(){return!0},e.prototype.isMeCanOutCard=function(){return this.isCanOutCard},e.prototype.setMeCanOutCard=function(t){this.isCanOutCard=t},e.prototype.setDoublePressMode=function(t){this.isDoublePressMode=t},e.prototype.getDoublePressMode=function(){return this.isDoublePressMode},e.prototype.setDoublePressed=function(t){this.isDoublePressed=t},e.prototype.getDoublePressed=function(){return this.isDoublePressed},e.prototype.setCardSelectStatus=function(t){this.cardSelectStatus=t},e.prototype.getCardSelectStatus=function(){return this.cardSelectStatus},e.prototype.setPressing=function(t){this.isPressing=t},e.prototype.getPressing=function(){return this.isPressing},e.prototype.getCanTouch=function(){return this.isCardCanTouch},e.prototype.addTouchEventListener=function(){this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.addEventAtTouchBegan()},e.prototype.setCanTouch=function(t){this.isCardCanTouch=t,t?(this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1),this.addEventAtTouchBegan()):(this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.removeEventAtTouchEnd())},e.prototype.addEventAtTouchBegan=function(){this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.removeEventAtTouchEnd=function(){this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},e.prototype.onTouchBegan=function(t){if(-1===this.iTouchId&&this.ui&&!this.ui.isSendingCard()){this.iTouchId=t.getID();var e=t.getLocation(),a=this.node.convertToNodeSpaceAR(e),o=this.TouchRect.contains(a);if(this.getCanTouch()&&1==o)if(this.setPressing(!0),!0===o){var i=this.getTouchCardIndex(e);if(i>=0){var r=this.touchHandCard(i);1==r.isSelected?(this.setCardSelectStatus(n.SELECT),this.setPressing(!0),1==r.isNewCard?this.setDoublePressed(!1):this.setDoublePressed(!0)):(this.setCardSelectStatus(n.NONE),this.setDoublePressed(!1))}else this.selectCancelAndResortCard(!1,!1)}else this.selectCancelAndResortCard(!1,!1)}},e.prototype.onTouchMoved=function(t){if(this.iTouchId===t.getID()&&this.pCardList)if(this.ui&&this.ui.isSendingCard())this.onTouchCancel(t);else{var e=t.getLocation(),a=this.node.convertToNodeSpaceAR(e),o=this.TouchRect.contains(a);if(1==this.getPressing())if(0==this.getDoublePressMode())this.getCardSelectStatus()===n.NONE?(i=this.getTouchCardIndex(e))>=0&&(this.setCardSelectStatus(n.SELECT),this.touchHandCard(i)):this.getCardSelectStatus()===n.SELECT?!0===o?(i=this.getTouchCardIndex(e))>=0&&this.touchHandCard(i):this.curSelectCardIndx>=0?(this.setCardSelectStatus(n.HOLD),this.holdCardOn(this.curSelectCardIndx,e)):(this.setCardSelectStatus(n.NONE),this.selectCancelAndResortCard(!1,!0)):this.getCardSelectStatus()===n.HOLD&&this.holdCardMove(e);else if(this.getCardSelectStatus()===n.NONE)(i=this.getTouchCardIndex(e))>=0&&(1==(r=this.touchHandCard(i)).isSelected?(this.setCardSelectStatus(n.SELECT),!0===r.isNewCard&&this.setDoublePressed(!1)):(this.setCardSelectStatus(n.NONE),this.selectCancelAndResortCard(!1,!0)));else if(this.getCardSelectStatus()===n.SELECT){var i,r;!0===o?(i=this.getTouchCardIndex(e))>=0&&(1==(r=this.touchHandCard(i)).isSelected?(this.setCardSelectStatus(n.SELECT),!0===r.isNewCard&&this.setDoublePressed(!1)):(this.setCardSelectStatus(n.NONE),this.selectCancelAndResortCard(!1,!0))):this.curSelectCardIndx>=0&&(this.setCardSelectStatus(n.HOLD),this.holdCardOn(this.curSelectCardIndx,e))}else this.getCardSelectStatus()===n.HOLD&&this.holdCardMove(e)}},e.prototype.onTouchEnd=function(t){if(this.iTouchId===t.getID()&&this.pCardList)if(this.ui&&this.ui.isSendingCard())this.onTouchCancel(t);else{var e=t.getLocation(),a=this.node.convertToNodeSpaceAR(e),o=this.TouchRect.contains(a);if(this.getCanTouch()&&1==this.getPressing())if(0==this.getDoublePressMode()){if(this.getCardSelectStatus()===n.SELECT)!0===o&&(r=this.getTouchCardIndex(e))>=0&&this.selectCardOut(r);else if(this.getCardSelectStatus()===n.HOLD){var i=this.getHoldCardPosition();this.holdCardOff(),!0===o?this.setCardSelectStatus(n.SELECT):(this.setDoublePressed(!1),this.selectCardOut(this.curSelectCardIndx,i))}this.setCardSelectStatus(n.NONE)}else{var r;this.getCardSelectStatus()===n.SELECT?!0===o&&(r=this.getTouchCardIndex(e))>=0&&this.getDoublePressed()&&(this.setDoublePressed(!1),this.selectCardOut(r)):this.getCardSelectStatus()===n.HOLD&&(i=this.getHoldCardPosition(),this.holdCardOff(),!0===o?this.setCardSelectStatus(n.SELECT):(this.setDoublePressed(!1),this.selectCardOut(this.curSelectCardIndx,i)))}else this.clearHandCardSelectedStatus(),this.curTipIndx=0;this.setPressing(!1),this.clearHandCardPreSelectedStatus(),this.iTouchId=-1,this.setCardSelectStatus(n.NONE)}},e.prototype.onTouchCancel=function(t){this.getPressing()&&this.getCardSelectStatus()===n.HOLD&&this.onTouchEnd(t),this.iTouchId=-1,this.setCardSelectStatus(n.NONE),this.selectCancelAndResortCard(!1,!0),this.setDoublePressed(!1)},e.prototype.selectCancelAndResortCard=function(t,e){this.setDoublePressed(!1),this.curSelectCardIndx=-1,this.pCardList.setCurSelectCardIndx(this.curSelectCardIndx),this.ui.selectCancelAndResortCard(t,e)},e.prototype.selectCardOut=function(t,e){1==this.isMeCanOutCard()&&t>=0&&(this.setMeCanOutCard(!1),this.ui.outCardByTouch(t,e),this.curSelectCardIndx=-1)},e.prototype.touchHandCard=function(t){var e=new h,a=this.pCardList.allHandCard;if(t>=0&&t<a.length){var o=a[t];if(!o)return void c.Logger.info("touchHandCard touchIndx is error ");var i=o.cardData.r;1==this.checkCardCanOut(i)?(e.isSelected=!0,this.curSelectCardIndx!==t&&(this.curSelectCardIndx=t,e.isNewCard=!0,this.pCardList.setCurSelectCardIndx(this.curSelectCardIndx),this.pCardList.initHandCardsPosition(!1),this.pCardList.selectCardByIndx(t),this.dispatch(d.GameEvent.HandCard.MY_HAND_CARD_SELECT,{isSelect:!0,cardData:i}),this.dispatch(d.GameEvent.Com.CARD_HIGH_LIGHT_ORANGE,{isDisplay:!0,cardDatas:[i]}))):(this.dispatch(d.GameEvent.HandCard.MY_HAND_CARD_TOUCH,{}),this.dispatch(d.GameEvent.Com.CARD_HIGH_LIGHT_ORANGE,{isDisplay:!1}),c.Logger.info("unSelect, touchCard can not out"))}return e},e.prototype.getTouchCardIndex=function(t){for(var e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=e[a];if(o&&!0===o.hitPos(t))return a}return-1},e.prototype.clearHandCardSelectedStatus=function(){for(var t=this.pCardList.allHandCard,e=0;e<t.length;e++){var a=t[e];a&&a.setSelected(!1)}},e.prototype.clearHandCardPreSelectedStatus=function(){for(var t=this.pCardList.allHandCard,e=0;e<t.length;e++){var a=t[e];a&&a.clearPreSelected()}},e.prototype.getSelectedCardData=function(){for(var t=[],e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=e[a];o&&o.isSelected()&&t.push(o.cardData)}return t},e.prototype.getPreSelectedCard=function(){for(var t=[],e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=e[a];o&&o.isPreSelected()&&t.push(o.cardData)}return t},e.prototype.setHandCardCanSelect=function(t){for(var e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=(n=e[a]).cardData;if(n&&o){n.setCanSelect(!1);for(var i=0;i<t.length;i++){var r=t[i];if(r&&o.l==r.l){n.setCanSelect(!0),n.setUnTouch(!1);break}}}}for(a=0;a<e.length;a++){var n;(n=e[a]).isCanSelect()||(n.setSelected(!1),n.setUnTouch(!0))}},e.prototype.setHandCardAllCanSelect=function(t){for(var e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=e[a];o&&(o.setCanSelect(t),o.setUnTouch(!t))}},e.prototype.selectCards=function(t){for(var e=this.pCardList.allHandCard,a=e.length-1;a>=0;a--){var o=!1,i=e[a];if(i&&i.cardData){for(var r=0;r<t.length;r++){var n=t[r];if(i.cardData.r===n.r){o=!0,i.setSelected(!0);break}}o||i.setSelected(!1)}}},e.prototype.checkTipCardAndPop=function(t){if(void 0===t&&(t=!1),this.tipCards&&this.tipCards.length>=1){this.curTipIndx=0;var e=this.tipCards[this.curTipIndx];e?(this.tipCards.length>1&&this.curTipIndx++,this.selectCards(e),t?this.checkCardValid(e):this.setOutMenuStatus(!0)):this.setOutMenuStatus(!1)}},e.prototype.checkCardValid=function(){},e.prototype.setOutMenuStatus=function(){},e.prototype.holdCardOn=function(t,e){this.pCardList.holdCardOn(t,e)},e.prototype.holdCardMove=function(t){this.pCardList.holdCardMove(t)},e.prototype.holdCardOff=function(){this.pCardList.holdCardOff()},e.prototype.getHoldCardPosition=function(){return this.pCardList.getHoldCardPosInfo()},r([C],e)}(s.CxCompExt));a.default=f,cc._RF.pop()},{"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/utils/Logger":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"./UIMyHandCardList":"UIMyHandCardList","./UIMyHandPokerView":"UIMyHandPokerView"}],UISkinAnim:[function(t,e,a){"use strict";cc._RF.push(e,"98889j3dtRMS4+dDg/cSHSP","UISkinAnim");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=this&&this.__decorate||function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};Object.defineProperty(a,"__esModule",{value:!0}),a.UISkinAnim=void 0;var n=t("./../../../../script/lib/utils/Display"),s=t("./../../../../script/lib/base/CxComponent"),c=t("../../../../script/app/event/Notify"),d=t("../../../gameBaseSrc/model/GameEvent"),l=cc._decorator,p=l.ccclass,h=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.arrHeadFinalPos=[],e}return i(e,t),e.prototype.listEvent=function(){return new Map([[c.Notify.Base.REQ_SCREEN_SHOT,this.onReqScreenShot],[c.Notify.Base.SCREEN_SHOT_RESULT,this.onScreenShotResult],[d.GameEvent.Player.PUT_HEADS_POS,this.onGetPlayersPos]])},e.prototype.onGetPlayersPos=function(t){if(t&&t[0]instanceof cc.Vec2)for(var e=0;e<t.length;e++){var a=this.node.convertToNodeSpace(t[e]);this.arrHeadFinalPos[e]=a}},e.prototype.onReqScreenShot=function(t){"skin"===t&&this.dispatch(c.Notify.Base.SCREEN_SHOT_START,{requestKey:"UISkinAnim"})},e.prototype.onScreenShotResult=function(t){if(t&&"UISkinAnim"===t.requestKey){var e=t.node;if(e){e.x=this.arrHeadFinalPos[2].x-n.Display.cx+50,e.y=this.arrHeadFinalPos[2].y-n.Display.cy,e.parent=this.node,e.zIndex=cc.macro.MAX_ZINDEX,e.anchorX=1,e.anchorY=1;var a=e.y+100;e.x,cc.tween(e).to(.6,{scale:.1}).delay(.5).to(.5,{opacity:0,scale:.03,y:a}).delay(.5).removeSelf().start()}}},r([p],e)}(s.CxComponent));a.UISkinAnim=h,cc._RF.pop()},{"../../../../script/app/event/Notify":void 0,"../../../gameBaseSrc/model/GameEvent":void 0,"./../../../../script/lib/base/CxComponent":void 0,"./../../../../script/lib/utils/Display":void 0}]},{},["ScopaGDFlow","ScopaGDLogicHandler","ScopaVoice","CMD_ScopaMsgDefine","ScopaGDGameMsg","ScopaGDPlayData","ScopaGDUIConfig","ScopaRoomData","ScopaGDScene","UIGameDeskMenu","UIGameInfo","UIGameRealTimeScore","UIGameUserInfoBg","UIEatCardDetails","UIEatCardOnDesk","UIScopaCountView","UIScopaAnim","UISettebelloAnim","UISkinAnim","UIMultCardTouchBehavior","UIMyHandCardList","UIMyHandPokerView","UISingleCardTouchBehavior","UIGameChooseEatCardView","UIGameEatCardGroup","UIOthersHandCardsView","UIPlayerCardsViewBase","UIPlayerCardsView_1","UIPlayerCardsView_2","UIPlayerCardsView_3","UIPlayerHandCardList","UIDeskOutCardView","UIDeskOutPoker","UIMyHandPoker","UIPokerCardBase","UIGameResultBattle","UIGameResultItem","UIGameResultList","UIGameResultMenu","UIGameResultPlayer","UIGameResultTitle","UIGameResultView"]);