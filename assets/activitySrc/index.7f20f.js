window.__require=function t(e,o,i){function n(s,r){if(!o[s]){if(!e[s]){var p=s.split("/");if(p=p[p.length-1],!e[p]){var c="function"==typeof __require&&__require;if(!r&&c)return c(p,!0);if(a)return a(p,!0);throw new Error("Cannot find module '"+s+"'")}s=p}var l=o[s]={exports:{}};e[s][0].call(l.exports,function(t){return n(e[s][1][t]||t)},l,l.exports,t,e,o,i)}return o[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({GoldenPassDailyReward:[function(t,e,o){"use strict";cc._RF.push(e,"1019fr6131JU61oeSZUAsX2","GoldenPassDailyReward");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../../script/app/const/Global"),r=t("../../../../script/app/event/GuiEvent"),p=t("../../../../script/app/event/Notify"),c=t("../../../../script/app/language/LanguageCfg"),l=t("../../../../script/lib/base/BottomBarView"),d=t("../../../../script/lib/base/CxComponent"),u=t("../../../../script/lib/base/PopupView"),h=t("../../../../script/lib/i18n/i18nHelper"),y=t("../../../../script/lib/utils/ComUtils"),g=t("./GoldenPassGrid"),f=cc._decorator,v=f.ccclass,_=f.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeRewards=null,e.labTips=null,e.powerFrame=null,e.goldFrame=null,e._isVip=!1,e._isRecved=!1,e}return n(e,t),e.prototype.init=function(t){this._isRecved=t.bGet,this._isVip=t.bVip,this.showRewards(t.reward)},e.prototype.listEvent=function(){return new Map([[p.Notify.GoldenPass.RESP_RECV_DAILY_REWARD,this.onRecvReward],[p.Notify.GoldenPass.SUBSCRIBE_SUCC,this.onActiveSucc]])},e.prototype.start=function(){var t=this.getComponent(u.PopupView);if(t){var e=h.i18nHelper.makeLanguage(c.LangKey.goldenpass_daily_reward).toString();t.setTitle(e)}this.showTips(),this.showButton(!this._isRecved)},e.prototype.onConfirmClicked=function(){this._isRecved?cc.log("\u5956\u52b1\u5df2\u9886\u53d6"):this._isVip?this.dispatch(p.Notify.GoldenPass.REQ_RECV_DAILY_REWARD):this.dispatch(r.GuiEvent.PopMsg.DISPLAY_GOLDEN_PASS_SHOP)},e.prototype.onRecvReward=function(t){t.body.bError&&(this._isRecved=!0,this.showButton(!1),this.showTips(),this.playRecvAnimation(t.parseData))},e.prototype.onActiveSucc=function(t){t.succ&&(this._isVip=!0,this.showTips())},e.prototype.showRewards=function(t){var e=this;this.nodeRewards&&t.forEach(function(t,o){var i=e.nodeRewards.getChildByName("NodeReward"+(o+1));i&&(t.dwNum<=0?i.active=!1:(i.getChildByName("SpIcon").getComponent(cc.Sprite).spriteFrame=e.getRewardIcon(t.dwType),i.getChildByName("LabelDesc").getComponent(cc.Label).string="x"+t.dwNum))})},e.prototype.showTips=function(){this.labTips&&(this._isRecved?this.labTips.node.active=!1:this._isVip?this.labTips.string="":this.labTips.string=h.i18nHelper.getLanguage(c.LangKey.goldenpass_daily_buy_tips))},e.prototype.showButton=function(t){if(t){var e;e=this._isVip?c.LangKey.text_collect:c.LangKey.goldenpass_get_reward,l.BottomBarView.setBottomBar(this.node,[{style:s.gColorStyle.GREEN,text:y.ComUtils.makeLang(e),callback:this.onConfirmClicked.bind(this)}])}else{var o=this.getComponent(l.BottomBarView);o&&o.hideBottomBar()}},e.prototype.getRewardIcon=function(t){return t==g.eGPRewardType.gold?this.goldFrame:t==g.eGPRewardType.power?this.powerFrame:void 0},e.prototype.playRecvAnimation=function(t){cc.log("\u52a8\u753b\u6570\u636e",t),this.dispatch(r.GuiEvent.PopMsg.SHOW_TABLE_BOX_REWARD,t)},a([_({type:cc.Node,tooltip:"layout\u8282\u70b9"})],e.prototype,"nodeRewards",void 0),a([_({type:cc.Label,tooltip:"\u63d0\u793a\u6587\u5b57"})],e.prototype,"labTips",void 0),a([_({type:cc.SpriteFrame,tooltip:"\u4f53\u529b\u56fe\u7247\u5e27"})],e.prototype,"powerFrame",void 0),a([_({type:cc.SpriteFrame,tooltip:"\u91d1\u5e01\u56fe\u7247\u5e27"})],e.prototype,"goldFrame",void 0),a([v],e)}(d.CxComponent);o.default=b,cc._RF.pop()},{"../../../../script/app/const/Global":void 0,"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/language/LanguageCfg":void 0,"../../../../script/lib/base/BottomBarView":void 0,"../../../../script/lib/base/CxComponent":void 0,"../../../../script/lib/base/PopupView":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../../script/lib/utils/ComUtils":void 0,"./GoldenPassGrid":"GoldenPassGrid"}],GoldenPassGrid:[function(t,e,o){"use strict";cc._RF.push(e,"945d0y8acNAX6vu2UF43+mi","GoldenPassGrid");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.GoldenPassGrid=o.eGPGridType=o.eGPRewardType=void 0;var s,r,p=t("../../../../script/app/const/Global"),c=t("../../../../script/app/event/GuiEvent"),l=t("../../../../script/app/event/Notify"),d=t("../../../../script/app/language/LanguageCfg"),u=t("../../../../script/app/model/DataProxy"),h=t("../../../../script/app/view/ComUI"),y=t("../../../../script/lib/base/CxComponent"),g=t("../../../../script/lib/i18n/i18nHelper"),f=t("../../../../script/lib/utils/ComUtils"),v=cc._decorator,_=v.ccclass,b=v.property;(function(t){t[t.gold=p.gShopHBType.GOLD]="gold",t[t.power=p.gShopHBType.POWER]="power",t[t.piece=p.gShopHBType.CHIPS]="piece",t[t.box=p.gShopHBType.BOX]="box"})(s=o.eGPRewardType||(o.eGPRewardType={})),function(t){t[t.silver=0]="silver",t[t.gold=1]="gold"}(r=o.eGPGridType||(o.eGPGridType={}));var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._unLock=!1,e._recved=!1,e._finished=!1,e._index=0,e._dwType=0,e._dwId=0,e._isBox=!1,e._extraData=null,e._gridType=r.silver,e._actPlayed=!1,e.spBg=null,e.spLock=null,e.spFinishTag=null,e.spFinishTag1=null,e.spRecvTag=null,e.spIcon=null,e.spStar=null,e.spStarLayout=null,e.labDesc=null,e.labRecv=null,e.recvedSpFrame=null,e.lockSpFrame=null,e.bgGoldSpFrame=null,e.bgSilverFrame=null,e.finishGoldFrame=null,e.finishSilverFrame=null,e.iconGold=null,e.iconPower=null,e.iconPiece=null,e.iconBox=[],e.labDefaultPos=cc.v2(0,0),e.labTipsPosOfStar=cc.v2(0,0),e.iconDefault=null,e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.multiLanguage(),this.spBg.node.on("click",this.onClick,this),this.spFinishTag.node.on("click",this.onClick,this)},e.prototype.start=function(){},e.prototype.listEvent=function(){return new Map([[l.Notify.GoldenPass.RESP_RECV_REWARD,this.onRecvReward],[l.Notify.GoldenPass.RESP_UPDATE_VIEW,this.onUpdateInfo]])},e.prototype.multiLanguage=function(){this.labRecv&&(this.labRecv.language=g.i18nHelper.getLanguage(d.LangKey.goldenpass_recv)),this.labRecv&&this.labRecv.node.active&&h.ComUI.getLabelSize(this.labRecv).width>this.labRecv.node.parent.width-20&&(this.labRecv.overflow=cc.Label.Overflow.SHRINK,this.labRecv.enableWrapText=!1,this.labRecv.node.width=this.labRecv.node.parent.width-20)},e.prototype.playRecvTagAnimation=function(t,e){null!=t&&null!=e&&(this._gridType==r.gold?(this.spFinishTag.spriteFrame=this.finishGoldFrame,this.spFinishTag1.spriteFrame=this.finishGoldFrame):(this.spFinishTag.spriteFrame=this.finishSilverFrame,this.spFinishTag1.spriteFrame=this.finishSilverFrame),cc.Tween.stopAllByTarget(t),cc.Tween.stopAllByTarget(e),cc.tween(t).repeatForever(cc.tween(t).to(.2,{scale:1.05,position:cc.v3(0,120)},{easing:cc.easing.sineIn}).to(.2,{scale:.95,position:cc.v3(0,105)},{easing:cc.easing.sineIn}).to(.2,{scale:1,position:cc.v3(0,110)},{easing:cc.easing.sineIn}).delay(.4)).start(),e.opacity=0,cc.tween(e).repeatForever(cc.tween(e).to(.2,{opacity:255},{easing:cc.easing.sineIn}).to(.2,{opacity:0},{easing:cc.easing.sineIn}).delay(.6)).start())},e.prototype.setIndex=function(t){this._index=t},e.prototype.setState=function(t,e,o){this._unLock=t,this._finished=e,this._recved=o,this.spFinishTag.node.active=!1,this.spLock.node.active=!1,this.spRecvTag.node.active=!1,o?(this.spRecvTag.node.active=!0,this.spRecvTag.spriteFrame=this.recvedSpFrame):e?(this.spFinishTag.node.active=!0,this.spLock.node.active=!this._unLock,this.playRecvTagAnimation(this.spFinishTag.node,this.spFinishTag1.node)):this._unLock||(this.spRecvTag.node.active=!0,this.spRecvTag.spriteFrame=this.lockSpFrame)},e.prototype.updateRecvState=function(t){this._recved=t,t&&(this.spFinishTag.node.active=!1,this.spLock.node.active=!1,this.spRecvTag.node.active=!0,this.spRecvTag.spriteFrame=this.recvedSpFrame)},e.prototype.setGridGrade=function(t){this._gridType=t,t==r.gold?this.spBg.spriteFrame=this.bgGoldSpFrame:this.spBg.spriteFrame=this.bgSilverFrame},e.prototype.playAction=function(t){this._actPlayed||(cc.Tween.stopAllByTarget(this.node),this.node.setPosition(cc.v2(0,0)),cc.tween(this.node).set({position:cc.v3(t,0)}).by(.25,{position:cc.v3(-t,0)},{easing:cc.easing.sineOut}).start(),this._actPlayed=!0)},e.prototype.setID=function(t){this._dwId=t},e.prototype.setGridType=function(t){this._dwType=t},e.prototype.setReward=function(t,e,o){var i,n="",a=null,s=null;this.node.getChildByName("SpStarBg").active=!1,this._isBox=!1,o&&o.length>0&&(a=JSON.parse(f.ComUtils.u8ToUTF8Str(o)),this._extraData=a,a.level&&(s=a.level,this._isBox=!0)),i=this.getRewardIconFrame(t,s),e>0&&(n="x"+f.ComUtils.formatGoldStr(e));var r=!1;if(a&&(a.endnum&&a.upunm&&(n=a.endnum+"-"+a.upunm),a.star)){this.spStarLayout.removeAllChildren(),this.spStar.node.active=!1;for(var p=a.star,c=0;c<p;++c){var l=cc.instantiate(this.spStar.node);l.parent=this.spStarLayout,l.active=!0}this.node.getChildByName("SpStarBg").active=!0,r=!0}this.setRewardIcon(i),this.setRewardDescription(n,r)},e.prototype.getRewardIconFrame=function(t,e){var o=null;switch(t){case s.gold:o=this.iconGold;break;case s.power:o=this.iconPower;break;case s.piece:o=this.iconPiece}return e&&(o=this.iconBox[e-1]),o},e.prototype.setRewardIcon=function(t){if(t){this.spIcon.node.active=!0;var e=Math.max(this.iconDefault.getOriginalSize().width,this.iconDefault.getOriginalSize().height);this.spIcon.spriteFrame=t;var o=e/Math.max(this.spIcon.node.getContentSize().width,this.spIcon.node.getContentSize().height);this.spIcon.node.scale=o}else this.spIcon.node.active=!1},e.prototype.setRewardDescription=function(t,e){this.labDesc.string=t,e?(this.labDesc.node.anchorX=1,this.labDesc.node.setPosition(this.labTipsPosOfStar)):(this.labDesc.node.anchorX=.5,this.labDesc.node.setPosition(this.labDefaultPos))},e.prototype.onClick=function(){if(cc.log("\u70b9\u51fb\u4e86"+this._dwId+"-"+this._dwType+"\u7c7b\u578b\u683c\u5b50"),cc.log("\u72b6\u6001: unlock = "+this._unLock+", recvd = "+this._recved+", finished = "+this._finished),this._unLock)this._recved||(this._finished?this.dispatch(l.Notify.GoldenPass.REQ_RECV_REWARD,{id:this._dwId,tp:this._dwType}):this._isBox?this.openBuyLayer():h.ComUI.showToast(g.i18nHelper.getLanguage(d.LangKey.goldenpass_crown_to_unlock).toString(),3,2));else{if(this._gridType==r.gold){var t=u.DataProxy.getInstance().glodenPassData.getCanRecvCountOfGoldenPass();return void this.dispatch(c.GuiEvent.PopMsg.DISPLAY_GOLDEN_PASS_SIMPLE_BUY,{rewardType:p.SubscGuide.FINISH_REWARD,recvCount:t})}this._isBox?this.openBuyLayer():h.ComUI.showToast(g.i18nHelper.getLanguage(d.LangKey.goldenpass_buy_to_unlock).toString(),3,2)}},e.prototype.openBuyLayer=function(){cc.log("\u989d\u5916\u6570\u636e",this._extraData),this.dispatch(c.GuiEvent.PopMsg.DISPLAY_GOLDEN_PASS_REWARD_PREVIEW,{extraData:this._extraData,gridType:this._gridType,gridIndex:this._index})},e.prototype.onRecvReward=function(t){var e=t.body;e.bError&&this._dwType==e.dwType&&this._dwId==e.dwId&&this.updateRecvState(!0)},e.prototype.onUpdateInfo=function(t){var e=t;if(e.bGet&&e.tabReward.dwId==this._dwId){var o=e.tabReward.dwNormalReward;o.dwType==this._dwType?this.updateGridState(o):(o=e.tabReward.dwSubscribeReward).dwType==this._dwType&&this.updateGridState(o)}},e.prototype.updateGridState=function(t){t.dwType==this._dwType&&this.setState(t.bUnlock,t.bFinishNew,t.bGetReward)},a([b(cc.Sprite)],e.prototype,"spBg",void 0),a([b(cc.Sprite)],e.prototype,"spLock",void 0),a([b(cc.Sprite)],e.prototype,"spFinishTag",void 0),a([b(cc.Sprite)],e.prototype,"spFinishTag1",void 0),a([b(cc.Sprite)],e.prototype,"spRecvTag",void 0),a([b(cc.Sprite)],e.prototype,"spIcon",void 0),a([b(cc.Sprite)],e.prototype,"spStar",void 0),a([b(cc.Node)],e.prototype,"spStarLayout",void 0),a([b(cc.Label)],e.prototype,"labDesc",void 0),a([b(cc.Label)],e.prototype,"labRecv",void 0),a([b(cc.SpriteFrame)],e.prototype,"recvedSpFrame",void 0),a([b(cc.SpriteFrame)],e.prototype,"lockSpFrame",void 0),a([b(cc.SpriteFrame)],e.prototype,"bgGoldSpFrame",void 0),a([b(cc.SpriteFrame)],e.prototype,"bgSilverFrame",void 0),a([b(cc.SpriteFrame)],e.prototype,"finishGoldFrame",void 0),a([b(cc.SpriteFrame)],e.prototype,"finishSilverFrame",void 0),a([b(cc.SpriteFrame)],e.prototype,"iconGold",void 0),a([b(cc.SpriteFrame)],e.prototype,"iconPower",void 0),a([b(cc.SpriteFrame)],e.prototype,"iconPiece",void 0),a([b(cc.SpriteFrame)],e.prototype,"iconBox",void 0),a([b(cc.Vec2)],e.prototype,"labDefaultPos",void 0),a([b(cc.Vec2)],e.prototype,"labTipsPosOfStar",void 0),a([b(cc.SpriteFrame)],e.prototype,"iconDefault",void 0),a([_],e)}(y.CxComponent);o.GoldenPassGrid=w,cc._RF.pop()},{"../../../../script/app/const/Global":void 0,"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/language/LanguageCfg":void 0,"../../../../script/app/model/DataProxy":void 0,"../../../../script/app/view/ComUI":void 0,"../../../../script/lib/base/CxComponent":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../../script/lib/utils/ComUtils":void 0}],GoldenPassItem:[function(t,e,o){"use strict";cc._RF.push(e,"ab30et2WUVPU6SXig6txLbY","GoldenPassItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../../script/app/event/Notify"),r=t("../../../../script/app/model/DataProxy"),p=t("../../../../script/lib/base/CxComponent"),c=t("./GoldenPassGrid"),l=cc._decorator,d=l.ccclass,u=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._index=0,e._gridArr=[],e._maxItemCount=9,e.pfGrid=null,e.gridNode=[],e.spIndex=null,e.labIndex=null,e.frameGoldIndex=null,e.frameSilverIndex=null,e.spTagLight=null,e.spItemLight=null,e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.listEvent=function(){return new Map([[s.Notify.GoldenPass.RESP_UPDATE_VIEW,this.onUpdateInfo]])},e.prototype.initItem=function(t,e,o,i){this.setIndex(t);var n=this.createGrid(c.eGPGridType.silver,e.dwNormalReward,e.dwId,!0),a=this.createGrid(c.eGPGridType.gold,e.dwSubscribeReward,e.dwId,o);this.spTagLight.node.active=!1,this.spItemLight.node.active=!1,i-1==t&&(e.dwNormalReward.bFinishNew&&!e.dwNormalReward.bGetReward||e.dwSubscribeReward.bFinishNew&&!e.dwSubscribeReward.bGetReward)&&this.playAnimation(),a.getComponent(c.GoldenPassGrid).playAction(-500),n.getComponent(c.GoldenPassGrid).playAction(500)},e.prototype.playAnimation=function(){if(this.spTagLight&&(this.spTagLight.node.active=!0,cc.tween(this.spTagLight.node).repeatForever(cc.tween(this.spTagLight.node).to(.5,{opacity:106}).to(.5,{opacity:255})).start()),this.spItemLight){this.spItemLight.node.active=!0;var t=this.spItemLight.node.getContentSize().width+cc.winSize.width,e=.5*t,o=cc.v3(-e,0,0);cc.tween(this.spItemLight.node).repeatForever(cc.tween(this.spItemLight.node).set({position:o}).by(1.5,{position:cc.v3(t,0)},{easing:cc.easing.sineInOut})).start()}},e.prototype.stopAnimation=function(){this.spTagLight&&(this.spTagLight.node.active=!1,cc.Tween.stopAllByTarget(this.spTagLight.node)),this.spItemLight&&(this.spItemLight.node.active=!1,cc.Tween.stopAllByTarget(this.spItemLight.node))},e.prototype.createGrid=function(t,e,o,i){var n=this._gridArr[t];n||((n=cc.instantiate(this.pfGrid)).parent=this.gridNode[t],this._gridArr.push(n));var a=n.getComponent(c.GoldenPassGrid);return a.setIndex(this._index),a.setGridGrade(t),a.setGridType(e.dwType),a.setID(o),a.setState(i,e.bFinishNew,e.bGetReward),a.setReward(e.tabGoods.dwGoodsType,e.tabGoods.dwNum,e.tabGoods.strExData),n},e.prototype.setIndex=function(t){this._index=t,this.labIndex.string=(t+1).toString()},e.prototype.updateItem=function(t,e,o){this.initItem(t,e,r.DataProxy.getInstance().glodenPassData.isVip(),o.curRecvLvl)},e.prototype.onUpdateInfo=function(t){var e=t;e.bGet&&e.tabReward.dwId==this._index+1?this.playAnimation():this.stopAnimation()},a([u(cc.Prefab)],e.prototype,"pfGrid",void 0),a([u(cc.Node)],e.prototype,"gridNode",void 0),a([u(cc.Sprite)],e.prototype,"spIndex",void 0),a([u(cc.Label)],e.prototype,"labIndex",void 0),a([u(cc.SpriteFrame)],e.prototype,"frameGoldIndex",void 0),a([u(cc.SpriteFrame)],e.prototype,"frameSilverIndex",void 0),a([u(cc.Sprite)],e.prototype,"spTagLight",void 0),a([u(cc.Sprite)],e.prototype,"spItemLight",void 0),a([d],e)}(p.CxComponent);o.default=h,cc._RF.pop()},{"../../../../script/app/event/Notify":void 0,"../../../../script/app/model/DataProxy":void 0,"../../../../script/lib/base/CxComponent":void 0,"./GoldenPassGrid":"GoldenPassGrid"}],GoldenPassListView:[function(t,e,o){"use strict";cc._RF.push(e,"6feb5r9LadHfq+xGWU6Pgn+","GoldenPassListView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.GoldenPassListView=void 0;var s=t("../../../../script/app/base/component/ComListView"),r=t("../../../../script/app/const/Global"),p=t("../../../../script/app/event/GuiEvent"),c=t("../../../../script/app/event/Notify"),l=t("../../../../script/app/language/LanguageCfg"),d=t("../../../../script/app/model/DataProxy"),u=t("../../../../script/lib/base/CxComponent"),h=t("../../../../script/lib/i18n/i18nHelper"),y=t("./GoldenPassGrid"),g=t("./GoldenPassItem"),f=cc._decorator,v=f.ccclass,_=f.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollview=null,e.pfItem=null,e.spLineH=null,e.nodeNextLvl=null,e.labTitleGoldenPass=null,e.labTitleFree=null,e.btnUnlock=null,e.ndFreeCanRecvCount=null,e.ndVipCanRecvCount=null,e._listData=null,e}var o;return n(e,t),o=e,e.prototype.listEvent=function(){return new Map([[c.Notify.GoldenPass.RESP_RECV_REWARD,this.onRecvReward],[c.Notify.GoldenPass.RESP_UPDATE_VIEW,this.onUpdateScrollView]])},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.multiLang()},e.prototype.initScrollView=function(t,e,o){this._listData=t.slice(),this.updateCanRecvCount();var i={curRecvLvl:e},n={scrollView:this.scrollview,content:this.scrollview.content,itemPrefab:this.pfItem,itemClass:g.default,dataList:t,dataEx:i,space:0,top:30,bottom:this.pfItem.data.height,createInterval:.05,scrollToIndex:e-2},a=this.node.getComponent(s.ComListView);null==a&&(a=this.node.addComponent(s.ComListView)),a.initParams(n),a.initScrollView(!0),this.spLineH.node.getChildByName("SpGray").height=this.scrollview.content.getContentSize().height,this.spLineH.node.zIndex=t.length+10,this.setListMaskPos(this.pfItem.data.height,o,-n.top);var r=this.getLvlNextTime(t,o+1);this.setLevelLeftTimeTips(o,r,t.length)},e.prototype.multiLang=function(){this.labTitleGoldenPass&&(this.labTitleGoldenPass.string=h.i18nHelper.getLanguage(l.LangKey.goldenpass_golden_pass)),this.labTitleFree&&(this.labTitleFree.string=h.i18nHelper.getLanguage(l.LangKey.goldenpass_free))},e.prototype.setListMaskPos=function(t,e,o){this.spLineH.node.y=-t*e+o},e.prototype.setLevelLeftTimeTips=function(t,e,i){if(i==t)return this.nodeNextLvl.active=!1,void(this.btnUnlock.node.active=!1);var n=this.nodeNextLvl.getChildByName("LabelPart1"),a=this.nodeNextLvl.getChildByName("LabelPart2");n.getComponent(cc.Label).string=h.i18nHelper.getLanguage([l.LangKey.goldenpass_unlock_next_lvl,t+1]),a.getComponent(cc.Label).string=o.getFormatTime(e)},e.prototype.onUpdateScrollView=function(t){var e=t;if(e.bGet){var o=this.node.getComponent(s.ComListView);if(o){for(var i=0;i<this._listData.length;i++){var n=this._listData[i];if(n.dwId==e.tabReward.dwId){n.dwNormalReward=e.tabReward.dwNormalReward,n.dwSubscribeReward=e.tabReward.dwSubscribeReward;break}}o.resetExterndData({curRecvLvl:e.tabReward.dwId}),o.resetListData(this._listData),o.ScrollTo(e.tabReward.dwId-2)}}},e.prototype.onRecvReward=function(t){var e=t.body;if(e.bError){var o=this.node.getComponent(s.ComListView);if(o){for(var i=0;i<this._listData.length;i++){var n=this._listData[i];if(n.dwId==e.dwId){n.dwNormalReward.dwType==e.dwType&&(n.dwNormalReward.bGetReward=!0),n.dwSubscribeReward.dwType==e.dwType&&(n.dwSubscribeReward.bGetReward=!0);break}}o.resetListData(this._listData)}}this.updateCanRecvCount()},e.getFormatTime=function(t){var e=Math.floor(t/86400),o=Math.floor(t%86400/3600);return e>0?e+"d "+o+"h":o+"h"},e.prototype.getLvlNextTime=function(t,e){for(var o=0;o<t.length;o++){var i=t[o];if(i.dwId==e)return i.dwTime}return 0},e.prototype.onClickActive=function(){var t=d.DataProxy.getInstance().glodenPassData.getCanRecvCountOfGoldenPass();this.dispatch(p.GuiEvent.PopMsg.DISPLAY_GOLDEN_PASS_SIMPLE_BUY,{rewardType:r.SubscGuide.FINISH_REWARD_ALL,recvCount:t})},e.prototype.getCanRecvCount=function(t){var e=0;return this._listData.forEach(function(o){t==y.eGPGridType.silver?o.dwNormalReward.bFinishNew&&e++:o.dwSubscribeReward.bFinishNew&&e++}),e},e.prototype.updateCanRecvCount=function(){var t=0,e=0;this._listData.forEach(function(o){o.dwNormalReward.bFinishNew&&!o.dwNormalReward.bGetReward&&t++,o.dwSubscribeReward.bFinishNew&&!o.dwSubscribeReward.bGetReward&&e++}),t>0?(this.ndFreeCanRecvCount.active=!0,this.ndFreeCanRecvCount.getComponentInChildren(cc.Label).string=t.toString()):this.ndFreeCanRecvCount.active=!1,e>0?(this.ndVipCanRecvCount.active=!0,this.ndVipCanRecvCount.getComponentInChildren(cc.Label).string=e.toString()):this.ndVipCanRecvCount.active=!1},a([_(cc.ScrollView)],e.prototype,"scrollview",void 0),a([_(cc.Prefab)],e.prototype,"pfItem",void 0),a([_(cc.Sprite)],e.prototype,"spLineH",void 0),a([_(cc.Node)],e.prototype,"nodeNextLvl",void 0),a([_(cc.Label)],e.prototype,"labTitleGoldenPass",void 0),a([_(cc.Label)],e.prototype,"labTitleFree",void 0),a([_(cc.Button)],e.prototype,"btnUnlock",void 0),a([_(cc.Node)],e.prototype,"ndFreeCanRecvCount",void 0),a([_(cc.Node)],e.prototype,"ndVipCanRecvCount",void 0),o=a([v],e)}(u.CxComponent);o.GoldenPassListView=b,cc._RF.pop()},{"../../../../script/app/base/component/ComListView":void 0,"../../../../script/app/const/Global":void 0,"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/language/LanguageCfg":void 0,"../../../../script/app/model/DataProxy":void 0,"../../../../script/lib/base/CxComponent":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"./GoldenPassGrid":"GoldenPassGrid","./GoldenPassItem":"GoldenPassItem"}],GoldenPassMainView:[function(t,e,o){"use strict";cc._RF.push(e,"a13a8d3x2RH6IUFCJ+kJWBg","GoldenPassMainView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.GoldenPassMainView=void 0;var s=t("../../../../script/app/const/AudioFile"),r=t("../../../../script/app/event/GuiEvent"),p=t("../../../../script/app/event/Notify"),c=t("../../../../script/lib/base/CxCompExt"),l=t("./GoldenPassTheme"),d=t("../../../../script/lib/i18n/i18nHelper"),u=t("../../../../script/app/language/LanguageCfg"),h=t("../../../../script/app/view/ComFunctions"),y=t("../../../../script/lib/utils/ScreenAdapter"),g=t("../../../../script/app/model/DataProxy"),f=t("./GoldenPassListView"),v=t("../../../../script/app/view/ComUI"),_=new Map([["SpTheme",cc.v2(0,2e3)],["SpMask",cc.v2(0,2e3)],["NodeListView",cc.v2(0,-2e3)],["SpriteProgress",cc.v2(0,-2e3)],["SpriteBottom",cc.v2(0,-2e3)]]),b=cc._decorator,w=b.ccclass,m=b.property,R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pfListView=null,e.spActive=null,e.progressBar=null,e.titleBg=null,e.bigBg=null,e.nodeListView=null,e.btnActive=null,e.btnDailyReward=null,e.labMonth=null,e.labSeason=null,e.labLeftTime=null,e.labProgress=null,e.labCurUnlockLvl=null,e.labGetCup=null,e.labPlayNow=null,e.labActive=null,e.labActiveTitle=null,e.labDailyReward=null,e._vipState=!1,e._isFromGame=!1,e._themeId=null,e}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),e&&(this._isFromGame=e.isFromGame)},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.dispatch(p.Notify.Base.HIDE_LOBBY_SOME_LAYER,!0),this.refreshLabel(),this.btnActive.node.on("click",this.onClickActive,this),this.btnDailyReward.node.on("click",this.onClickDailyReward,this),y.ScreenAdapter.paddingTop(this.labMonth.node),y.ScreenAdapter.paddingTop(this.btnDailyReward.node),this.adaptScreen(this.titleBg,!0),this.adaptScreen(this.bigBg,!1),this.multiLang()},e.prototype.start=function(){this.dispatch(p.Notify.AD.HIDE_BANNER);var t=g.DataProxy.getInstance().glodenPassData.getBaseInfo(),e=g.DataProxy.getInstance().glodenPassData.getCompleteData();!this._isFromGame&&t&&e?(this.onRespInfo(t),this.onRespListInfo(e)):this.dispatch(p.Notify.GoldenPass.REQ_INFO)},e.prototype.initEvent=function(){this.bindEvent(p.Notify.GoldenPass.RESP_INFO,this.onRespInfo),this.bindEvent(p.Notify.GoldenPass.RESP_LIST_INFO,this.onRespListInfo),this.bindEvent(p.Notify.GoldenPass.RESP_RECV_REWARD,this.onRecvReward),this.bindEvent(p.Notify.GoldenPass.SUBSCRIBE_SUCC,this.onActiveSucc)},e.prototype.displayLabelBatch=function(t,e){var o=this,i=t.getComponent(cc.LabelOutline);i&&(i.enabled=e),t.children.forEach(function(t){o.displayLabelBatch(t,e)})},e.prototype.refreshLabel=function(){var t=this;h.ComFunctions.performWithDelay(this.node,function(){t.displayLabelBatch(t.node,!0)},.25)},e.prototype.multiLang=function(){this.labSeason&&(this.labSeason.string=d.i18nHelper.getLanguage(u.LangKey.goldenpass_season_left_time)),this.labGetCup&&(this.labGetCup.string=d.i18nHelper.getLanguage(u.LangKey.goldenpass_play_scopa)),this.labPlayNow&&(this.labPlayNow.string=d.i18nHelper.getLanguage(u.LangKey.text_play_now)),this.labActive&&(this.labActive.string=d.i18nHelper.getLanguage(u.LangKey.goldenpass_active)),this.labActiveTitle&&(this.labActiveTitle.string=d.i18nHelper.getLanguage(u.LangKey.goldenpass_golden_pass)),this.labDailyReward&&(this.labDailyReward.string=d.i18nHelper.getLanguage(u.LangKey.goldenpass_daily_reward))},e.prototype.onRespInfo=function(t){t||(t=g.DataProxy.getInstance().glodenPassData.getBaseInfo()),cc.log("\u5c55\u793a\u9875\u9762\u4fe1\u606f");var e=t;this._themeId=e.dwTopicalId,this.themeMonth(e.dwMonth),this.setProgress(e.dwNowCup,e.dwNeedCup),this.setVipStatus(e.bGoldenPass),this.setThemeLeftTime(e.dwTime),this.setCurUnLock(e.dwLevel)},e.prototype.onRespListInfo=function(t){var e=this;t||(t=g.DataProxy.getInstance().glodenPassData.getCompleteData()),cc.log("\u5c55\u793a\u5217\u8868");var o=this.getUnlockLvlIndex(t),i=this.getCurRecvLvl(t,o);this.addScrollView(t,i,o),v.ComUI.rmLoading(),h.ComFunctions.performWithDelay(this.node,function(){e.applyTheme(e._themeId)},.1)},e.prototype.addScrollView=function(t,e,o){if(this.pfListView){this.nodeListView.removeAllChildren();var i=cc.instantiate(this.pfListView),n=i.getComponent(f.GoldenPassListView);n||(n=i.addComponent(f.GoldenPassListView)),this.nodeListView.addChild(i),h.ComFunctions.performWithDelay(this.node,function(){n.initScrollView(t,e,o)},0)}},e.prototype.adaptScreen=function(t,e){var o=t.getContentSize(),i=cc.winSize.width/o.width,n=cc.winSize.height/o.height;e?t.setScale(Math.min(i,n)):t.setScale(Math.max(i,n))},e.prototype.hideNodes=function(){var t=this;_.forEach(function(e,o){var i=t.node.getChildByName(o);i&&(i.active=!1)})},e.prototype.playNodeAction=function(t,e){t.active=!0,cc.tween(t).set({position:cc.v3(e.x,e.y),active:!0}).to(.75,{position:cc.v3(t.getPosition().x,t.getPosition().y)},{easing:cc.easing.sineOut}).start()},e.prototype.applyTheme=function(t){(new l.GoldenPassTheme).apply(this.node,t)},e.prototype.getUnlockLvlIndex=function(t){for(var e=0;e<t.length;e++){var o=t[e];if(!o.dwNormalReward.bUnlock)return o.dwId-1}return t.length},e.prototype.getCurRecvLvl=function(t,e){for(var o=-1,i=-1,n=t.length-1;n>=0;n--){var a=t[n];if((a.dwNormalReward.bGetReward||a.dwSubscribeReward.bGetReward)&&a.dwId>i&&(i=a.dwId),a.dwNormalReward.bFinishNew&&!a.dwNormalReward.bGetReward){o=a.dwId;break}if(a.dwSubscribeReward.bUnlock&&a.dwSubscribeReward.bFinishNew&&!a.dwSubscribeReward.bGetReward){o=a.dwId;break}}return-1==o&&(o=-1!=i?i:1),Math.min(o,e)},e.prototype.themeMonth=function(t){this.labMonth.string=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"][t-1]||"--"},e.prototype.setVipStatus=function(t){this._vipState=t,this.spActive.node.active=t},e.prototype.setThemeLeftTime=function(t){this.labLeftTime.string=f.GoldenPassListView.getFormatTime(t)},e.prototype.setProgress=function(t,e){this.labProgress.string=t+"/"+e,this.progressBar.progress=t/e},e.prototype.setCurUnLock=function(t){this.labCurUnlockLvl.string=t.toString()},e.prototype.onRecvReward=function(t){var e=t.body;e.bError&&(this.playRecvAnimation(t.parseData),this.setProgress(e.dwNowCup,e.dwNeedCup),this.dispatch(p.Notify.GoldenPass.REQ_ACT_ENTRY_INFO))},e.prototype.onClickBack=function(){this._isFromGame&&this.dispatch(p.Notify.Game.EXIT_SCENE),this.node.destroy()},e.prototype.onClickQuickGame=function(){this.dispatch(p.Notify.Base.PLAY_EFFECT,{path:s.AudioFile.Com.GO}),this.dispatch(p.Notify.MatchGame.MATCH_QUICK_GAME),this.node.destroy()},e.prototype.onClickDailyReward=function(){this.dispatch(p.Notify.GoldenPass.REQ_DAILY_REWARD)},e.prototype.onClickActive=function(){this._vipState||this.dispatch(r.GuiEvent.PopMsg.DISPLAY_GOLDEN_PASS_SHOP)},e.prototype.onActiveSucc=function(t){t.succ&&this.refreshLabel()},e.prototype.playRecvAnimation=function(t){this.dispatch(r.GuiEvent.PopMsg.SHOW_TABLE_BOX_REWARD,t)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.dispatch(p.Notify.AD.RESHOW_BANNER),this.dispatch(p.Notify.Base.HIDE_LOBBY_SOME_LAYER,!1)},a([m(cc.Prefab)],e.prototype,"pfListView",void 0),a([m(cc.Sprite)],e.prototype,"spActive",void 0),a([m(cc.ProgressBar)],e.prototype,"progressBar",void 0),a([m(cc.Node)],e.prototype,"titleBg",void 0),a([m(cc.Node)],e.prototype,"bigBg",void 0),a([m(cc.Node)],e.prototype,"nodeListView",void 0),a([m(cc.Button)],e.prototype,"btnActive",void 0),a([m(cc.Button)],e.prototype,"btnDailyReward",void 0),a([m(cc.Label)],e.prototype,"labMonth",void 0),a([m(cc.Label)],e.prototype,"labSeason",void 0),a([m(cc.Label)],e.prototype,"labLeftTime",void 0),a([m(cc.Label)],e.prototype,"labProgress",void 0),a([m(cc.Label)],e.prototype,"labCurUnlockLvl",void 0),a([m(cc.Label)],e.prototype,"labGetCup",void 0),a([m(cc.Label)],e.prototype,"labPlayNow",void 0),a([m(cc.Label)],e.prototype,"labActive",void 0),a([m(cc.Label)],e.prototype,"labActiveTitle",void 0),a([m(cc.Label)],e.prototype,"labDailyReward",void 0),a([w],e)}(c.CxCompExt);o.GoldenPassMainView=R,cc._RF.pop()},{"../../../../script/app/const/AudioFile":void 0,"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/language/LanguageCfg":void 0,"../../../../script/app/model/DataProxy":void 0,"../../../../script/app/view/ComFunctions":void 0,"../../../../script/app/view/ComUI":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../../script/lib/utils/ScreenAdapter":void 0,"./GoldenPassListView":"GoldenPassListView","./GoldenPassTheme":"GoldenPassTheme"}],GoldenPassPaySucc:[function(t,e,o){"use strict";cc._RF.push(e,"45abe9Cc05GFLJSvOMh9ZMw","GoldenPassPaySucc");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../../script/app/language/LanguageCfg"),r=t("../../../../script/lib/base/CxComponent"),p=t("../../../../script/lib/utils/ComUtils"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labCongrat=null,e.labGoldTips=null,e.labGold=null,e.btnIsee=null,e.viewData=null,e}return n(e,t),e.prototype.init=function(t){if(this.viewData=t||{},this.viewData.reward){var e=this.viewData.reward[0].dwNum;this.labGold.string=p.ComUtils.formatGoldStr(e,1e5,0)}},e.prototype.start=function(){this.multiLanuage()},e.prototype.multiLanuage=function(){this.labCongrat.string=p.ComUtils.getLang(s.LangKey.goldenPass_congratulation),this.btnIsee.node.getComponentInChildren(cc.Label).string=p.ComUtils.getLang(s.LangKey.txt_i_see);var t=String.format(p.ComUtils.getLang(s.LangKey.goldenPass_extra_reward),this.viewData.reward[0].dwNum);this.labGoldTips.string=t},a([d({type:cc.Label,tooltip:"\u795d\u8d3a\u8bed"})],e.prototype,"labCongrat",void 0),a([d({type:cc.Label,tooltip:"\u8d60\u9001\u91d1\u5e01\u63d0\u793a"})],e.prototype,"labGoldTips",void 0),a([d({type:cc.Label,tooltip:"\u8d60\u9001\u91d1\u5e01\u6570\u91cf"})],e.prototype,"labGold",void 0),a([d({type:cc.Button,tooltip:"i see"})],e.prototype,"btnIsee",void 0),a([l],e)}(r.CxComponent);o.default=u,cc._RF.pop()},{"../../../../script/app/language/LanguageCfg":void 0,"../../../../script/lib/base/CxComponent":void 0,"../../../../script/lib/utils/ComUtils":void 0}],GoldenPassRewardPreview:[function(t,e,o){"use strict";cc._RF.push(e,"ab52a7ohCpBqrFAspYnFP8t","GoldenPassRewardPreview");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.GoldenPassRewardPreview=void 0;var s=t("../../../../script/app/event/GuiEvent"),r=t("../../../../script/app/language/LanguageCfg"),p=t("../../../../script/app/model/DataProxy"),c=t("../../../../script/lib/base/CxCompExt"),l=t("../../../../script/lib/i18n/i18nHelper"),d=t("./GoldenPassGrid"),u=t("../../../../script/app/event/Notify"),h=t("../../../../script/lib/base/Language"),y=t("../../../../script/lib/utils/ComUtils"),g=cc._decorator,f=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spIcon=null,e.ndNormalRwd=null,e.ndExtraRwd=null,e.ndBottom=null,e.btnBuy=null,e.labBuy=null,e.labPower=null,e.labPiece=null,e.labGold=null,e.labTips=null,e.labAtleast=null,e.iconBox=[],e._gridType=d.eGPGridType.silver,e._gridIndex=0,e}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this._gridType=e.gridType,this._gridIndex=e.gridIndex;var o=e.extraData,i=o.boxreward;this.setRewardIcon(o.level);var n=this.analyseNormalRewardDesc(i);this.setNormalRewards(n[d.eGPRewardType.power],n[d.eGPRewardType.piece],n[d.eGPRewardType.gold]);var a=this.analyseExtraRewardDesc(i);this.setExtarRewards(a),this.showButtonAndTips(),this.adaptViewSize()},e.prototype.initEvent=function(){this.bindEvent(u.Notify.GoldenPass.SUBSCRIBE_SUCC,this.onActiveSucc)},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.multiLanguage(),this.btnBuy&&this.btnBuy.node.on("click",this.onClickActive,this)},e.prototype.multiLanguage=function(){this.labBuy&&(this.labBuy.language=l.i18nHelper.getLanguage(r.LangKey.goldenpass_btn_get_goldenPass)),this.labAtleast&&(this.labAtleast.language=l.i18nHelper.getLanguage(r.LangKey.shopBox_at_least_txt)),this._gridType==d.eGPGridType.silver?this.labTips&&(this.labTips.language=l.i18nHelper.getLanguage(r.LangKey.goldenpass_tips_to_finish)):p.DataProxy.getInstance().glodenPassData.isVip()?this.labTips&&(this.labTips.language=l.i18nHelper.getLanguage(r.LangKey.goldenpass_tips_to_finish)):this.labTips&&(this.labTips.language=l.i18nHelper.getLanguage(r.LangKey.goldenpass_tips_active))},e.prototype.setRewardIcon=function(t){if(t){var e=this.iconBox[t-1];e&&(this.spIcon.spriteFrame=e)}},e.prototype.setNormalRewards=function(t,e,o){void 0===o&&(o=null),this.labPower.string=t,this.labPiece.string=e,o?this.labGold.string=o:this.labGold.node.parent.active=!1},e.prototype.setExtarRewards=function(t){var e=this;if(null!=t&&0!=t.length){this.ndExtraRwd.active=!0;for(var o=this.ndExtraRwd.getChildByName("nd_label"),i=1;i<=2;++i)this.ndExtraRwd.getChildByName("ndLayout").getChildByName("piece_"+i).active=!1,o.getChildByName("info"+i).active=!1;t.forEach(function(t,i){for(var n=0;n<t.num&&e.showOnePiece(i+1,t.star,t.num);++n);var a=o.getChildByName("info"+(i+1)).getComponent(cc.Label);a.node.active=!0,e.setPieceLabel(a,t)})}else this.ndExtraRwd.active=!1},e.prototype.showOnePiece=function(t,e,o){var i=!1,n=this.ndExtraRwd.getChildByName("ndLayout").getChildByName("piece_"+t);if(n){i=!0,n.active=!0;for(var a=n.getChildByName("star_bg").getChildByName("layout"),s=0;s<5;++s){a.getChildByName("star"+(s+1)).active=s<e}n.getChildByName("lab_num").getComponent(cc.Label).string="x"+o}return i},e.prototype.showButtonAndTips=function(){this._gridType==d.eGPGridType.silver?this.btnBuy.node.active=!1:p.DataProxy.getInstance().glodenPassData.isVip()?this.btnBuy.node.active=!1:this.btnBuy.node.active=!0,this._gridIndex<p.DataProxy.getInstance().glodenPassData.getBaseInfo().dwLevel-1&&(this.labTips.node.active=!1)},e.prototype.adaptViewSize=function(){var t=0;if(!this.labGold.node.parent.active){var e=this.ndNormalRwd.getChildByName("nodeLayout");this.ndExtraRwd.y+=.5*e.height,t+=.5*e.height}this.ndExtraRwd.active||(t+=this.ndExtraRwd.height),this.node.height-=t,this.ndBottom.y+=.5*t},e.prototype.setPieceLabel=function(t,e){if(t&&e){var o=e.num,i=e.star;if(o>0&&i>0){var n=h.Language.getInstance().getLanguage(),a=y.ComUtils.numberToLan(o,n);a&&(t.language=l.i18nHelper.makeLanguage([r.LangKey.shopBox_min_piece_txt,o,a]))}}},e.prototype.analyseNormalRewardDesc=function(t){var e=[];return t.forEach(function(t){var o=null,i=t.exdata;switch(t.type){case d.eGPRewardType.gold:case d.eGPRewardType.power:o=0==i.num?i.num.toString():i.endnum+"-"+i.upunm;break;case d.eGPRewardType.piece:o=""+t.num}e[t.type]=o}),e},e.prototype.analyseExtraRewardDesc=function(t){var e=null;return t.some(function(t){if(t.type==d.eGPRewardType.piece)return e=t.bichu,!0}),e},e.prototype.onClickActive=function(){p.DataProxy.getInstance().glodenPassData.isVip()||this.dispatch(s.GuiEvent.PopMsg.DISPLAY_GOLDEN_PASS_SHOP)},e.prototype.onActiveSucc=function(t){t.succ&&(cc.log("\u5566\u5566\u5566\uff0c\u6fc0\u6d3b\u6210\u529f"),this.btnBuy.node.active=!1,this.labTips.node.active=!1)},e.prototype.hideExtarReward=function(){this.ndExtraRwd.active=!1},a([v(cc.Sprite)],e.prototype,"spIcon",void 0),a([v(cc.Node)],e.prototype,"ndNormalRwd",void 0),a([v(cc.Node)],e.prototype,"ndExtraRwd",void 0),a([v(cc.Node)],e.prototype,"ndBottom",void 0),a([v(cc.Button)],e.prototype,"btnBuy",void 0),a([v(cc.Label)],e.prototype,"labBuy",void 0),a([v(cc.Label)],e.prototype,"labPower",void 0),a([v(cc.Label)],e.prototype,"labPiece",void 0),a([v(cc.Label)],e.prototype,"labGold",void 0),a([v(cc.Label)],e.prototype,"labTips",void 0),a([v(cc.Label)],e.prototype,"labAtleast",void 0),a([v(cc.SpriteFrame)],e.prototype,"iconBox",void 0),a([f],e)}(c.CxCompExt);o.GoldenPassRewardPreview=_,cc._RF.pop()},{"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/language/LanguageCfg":void 0,"../../../../script/app/model/DataProxy":void 0,"../../../../script/lib/base/CxCompExt":void 0,"../../../../script/lib/base/Language":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../../script/lib/utils/ComUtils":void 0,"./GoldenPassGrid":"GoldenPassGrid"}],GoldenPassShopCell:[function(t,e,o){"use strict";cc._RF.push(e,"bbfacJGX/5Mi7rmXBUVFqOH","GoldenPassShopCell");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../../script/lib/base/CxComponent"),r=t("../../../../script/lib/base/Language"),p=cc._decorator,c=p.ccclass,l=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.subsciptNodes=[],e.spFrameOfRights=[],e}return n(e,t),e.prototype.updateItem=function(t,e){for(var o=0;o<2;++o)this.showGrid(o,e[o])},e.prototype.showGrid=function(t,e){var o=this.subsciptNodes[t];if(o)if(e){o.active=!0;var i=o.getComponentInChildren(cc.Label),n=r.Language.getInstance().getLanguage();i.language=e[n];var a=o.getComponentInChildren(cc.Sprite),s=this.iconFrame(e.idx);s&&(a.spriteFrame=s)}else o.active=!1},e.prototype.iconFrame=function(t){return this.spFrameOfRights[t]},a([l({type:cc.Node,tooltip:"\u7279\u6743"})],e.prototype,"subsciptNodes",void 0),a([l({type:cc.SpriteFrame,tooltip:"\u6743\u76caICON"})],e.prototype,"spFrameOfRights",void 0),a([c],e)}(s.CxComponent);o.default=d,cc._RF.pop()},{"../../../../script/lib/base/CxComponent":void 0,"../../../../script/lib/base/Language":void 0}],GoldenPassShop:[function(t,e,o){"use strict";cc._RF.push(e,"d48aejWDftLm4DPpdwyEqvK","GoldenPassShop");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../../script/app/base/component/ComListView"),r=t("../../../../script/app/const/Global"),p=t("../../../../script/app/event/Notify"),c=t("../../../../script/app/language/LanguageCfg"),l=t("../../../../script/lib/base/CxComponent"),d=t("../../../../script/lib/base/PopupView"),u=t("../../../../script/lib/i18n/i18nHelper"),h=t("../../../../script/lib/utils/ComUtils"),y=t("./GoldenPassShopCell"),g=cc._decorator,f=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labRewardEx=null,e.labLeftTime=null,e.btnSubByMonth=null,e.btnSubByYear=null,e.scrollview=null,e.pfItem=null,e.mSubscType=r.SubscType.MONTH,e.mViewData=null,e.delayLock=!0,e}return n(e,t),e.prototype.init=function(t){t?this.onUpdateViewData(t):this.dispatch(p.Notify.Shop.REQ_GOLDEN_PASS_INFO),this.dispatch(p.Notify.Shop.REQ_GOLDEN_PASS_INFO)},e.prototype.listEvent=function(){return new Map([[p.Notify.Shop.RTN_GOLDEN_PASS_INFO,this.onUpdateViewData],[p.Notify.GoldenPass.SUBSCRIBE_SUCC,this.onActiveSucc]])},e.prototype.start=function(){var t=this.getComponent(d.PopupView);if(t){var e=u.i18nHelper.makeLanguage(c.LangKey.goldenpass_golden_pass).toString();t.setTitle(e)}this.btnSubByMonth&&this.btnSubByMonth.node.on("click",this.onSubscriptionByMonthClicked,this),this.btnSubByYear&&this.btnSubByYear.node.on("click",this.onSubscriptionByYearClicked,this)},e.prototype.onUpdateViewData=function(t){this.mViewData=t,this.extraReward(),this.monthPrice(),this.yearPrice(),this.leftTime(),this.initListView(t.rightsInfo)},e.prototype.extraReward=function(){this.labRewardEx.string=h.ComUtils.formatGoldStr(this.mViewData.goldReward,1e5,0)},e.prototype.leftTime=function(){var t;t=this.mViewData.leftTime>=86400?Math.floor(this.mViewData.leftTime/86400)+"d "+Math.floor(this.mViewData.leftTime%86400/3600)+"h":h.ComUtils.formatTimeString(this.mViewData.leftTime,"00:00:00"),this.labLeftTime.string=String.format(h.ComUtils.getLang(c.LangKey.goldenPass_left_time),t)},e.prototype.monthPrice=function(){var t=this.btnSubByMonth.getComponentInChildren(cc.Layout),e=t.node.getChildByName("lab_price"),o=t.node.getChildByName("lab_desc");e&&(e.getComponent(cc.Label).string=this.getPrice(r.SubscType.MONTH)+"/"),o&&(o.getComponent(cc.Label).string="Month")},e.prototype.yearPrice=function(){var t=this.btnSubByYear.getComponentInChildren(cc.Layout),e=t.node.getChildByName("lab_price"),o=t.node.getChildByName("lab_desc");e&&(e.getComponent(cc.Label).string=this.getPrice(r.SubscType.YEAR)+"/"),o&&(o.getComponent(cc.Label).string="Year")},e.prototype.getPrice=function(t){if(!this.mViewData.goodsInfo||!this.mViewData.goodsInfo[t])return"";var e=this.mViewData.goodsInfo[t],o=e.dwSrcNum/100;return h.ComUtils.getCurrencySymbol(e.dwCurrencyType)+""+o},e.prototype.onConfirmClicked=function(){this.delayLock&&(h.ComUtils.delayLimit(this,2e3),this.dispatch(p.Notify.Shop.REQ_BUY_GOLDEN_PASS,this.mSubscType))},e.prototype.onSubscriptionByMonthClicked=function(){this.mSubscType=r.SubscType.MONTH,cc.log("\u70b9\u51fb\u8d2d\u4e70\u6708\u5361"),this.onConfirmClicked()},e.prototype.onSubscriptionByYearClicked=function(){this.mSubscType=r.SubscType.YEAR,cc.log("\u70b9\u51fb\u8d2d\u4e70\u5e74\u5361"),this.onConfirmClicked()},e.prototype.initListView=function(t){for(var e=JSON.parse(t),o=[],i=0;i<5;++i){var n=e["vip"+(i+1)];if(n&&(null==n.enable||null==n.enable||1==n.enable)){n.idx=i;var a=Math.floor(i/2);o[a]||(o[a]=[]),o[a].push(n)}}var r={scrollView:this.scrollview,content:this.scrollview.content,itemPrefab:this.pfItem,itemClass:y.default,dataList:o,dataEx:null,space:10,top:0,bottom:0,createInterval:.05},p=this.node.getComponent(s.ComListView);null==p&&(p=this.node.addComponent(s.ComListView)),p.initParams(r),p.initScrollView()},e.prototype.onActiveSucc=function(t){t.succ&&this.node.destroy()},a([v({type:cc.Label,tooltip:"\u989d\u5916\u91d1\u5e01\u5956\u52b1"})],e.prototype,"labRewardEx",void 0),a([v({type:cc.Label,tooltip:"\u672c\u6708\u5269\u4f59\u65f6\u95f4"})],e.prototype,"labLeftTime",void 0),a([v({type:cc.Button,tooltip:"\u6309\u6708\u8ba2\u9605"})],e.prototype,"btnSubByMonth",void 0),a([v({type:cc.Button,tooltip:"\u6309\u5e74\u8ba2\u9605"})],e.prototype,"btnSubByYear",void 0),a([v({type:cc.ScrollView,tooltip:"\u6eda\u52a8\u5217\u8868"})],e.prototype,"scrollview",void 0),a([v({type:cc.Prefab,tooltip:"\u5217\u8868\u5143\u7d20\u9884\u5236\u4f53"})],e.prototype,"pfItem",void 0),a([f],e)}(l.CxComponent);o.default=_,cc._RF.pop()},{"../../../../script/app/base/component/ComListView":void 0,"../../../../script/app/const/Global":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/language/LanguageCfg":void 0,"../../../../script/lib/base/CxComponent":void 0,"../../../../script/lib/base/PopupView":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../../script/lib/utils/ComUtils":void 0,"./GoldenPassShopCell":"GoldenPassShopCell"}],GoldenPassSimplePay:[function(t,e,o){"use strict";cc._RF.push(e,"57b9dsaFYBL45Xc9j/Yx996","GoldenPassSimplePay");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../../script/app/const/Global"),r=t("../../../../script/app/event/GuiEvent"),p=t("../../../../script/app/event/Notify"),c=t("../../../../script/app/language/LanguageCfg"),l=t("../../../../script/app/model/DataProxy"),d=t("../../../../script/lib/base/CxComponent"),u=t("../../../../script/lib/i18n/i18nHelper"),h=t("../../../../script/lib/utils/ComUtils"),y=cc._decorator,g=y.ccclass,f=y.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBuy=null,e.ndRewards=[],e.richTxtDesc=null,e.moreAbout=null,e.viewData=null,e}return n(e,t),e.prototype.init=function(t){this.viewData=t,this.simpleGoodsPrice(),this.moreAboutGoldePass(),this.showRewards()},e.prototype.listEvent=function(){return new Map([[p.Notify.GoldenPass.SUBSCRIBE_SUCC,this.onActiveSucc]])},e.prototype.showRewards=function(){var t=this.ndRewards[this.viewData.rewardType];t?(t.active=!0,this.viewData.rewardType==s.SubscGuide.GOLDEN_NAME?this.showGoldenNameReward(t):this.viewData.rewardType==s.SubscGuide.REWARD_REVIEW?this.showPreviewReward(t):this.viewData.rewardType==s.SubscGuide.FINISH_REWARD?this.showUnlockSingelTaskFinishReward():this.showUnlockAllTaskFinishReward(t)):this.richTxtDesc.node.active=!1},e.prototype.showGoldenNameReward=function(){this.richTxtDesc.string=h.ComUtils.getLang(c.LangKey.goldenPass_buy_to_golden_name)},e.prototype.showPreviewReward=function(t){var e=l.DataProxy.getInstance().glodenPassData.getGoldenBonusData(),o=e.tabReward[0],i=t.getChildByName("RewardExtra").getComponentInChildren(cc.Label);i&&(i.string=h.ComUtils.formatGoldStr(o.dwNum));var n=e.tabDailyReward[0],a=t.getChildByName("RewardDaily").getComponentInChildren(cc.Layout),s=a.node.getChildByName("LabelNum");if(s){var r=h.ComUtils.formatGoldStr(n.dwNum);s.getComponent(cc.Label).string=r}var p=a.node.getChildByName("LabelDesc");p&&(p.getComponent(cc.Label).string="/DAY"),this.richTxtDesc.string="<color=#FFFFFF>Get </c><color=#ffe92b>Golden Pass </c><color=#FFFFFF>to Claim Golden Bonus EveryDay</color>",this.richTxtDesc.string=h.ComUtils.getLang(c.LangKey.goldenPass_preview_reward)},e.prototype.showUnlockAllTaskFinishReward=function(t){var e=t.getChildByName("SpriteRedpoint").getComponentInChildren(cc.Label);e&&(e.string=this.viewData.recvCount);var o=t.getChildByName("SpriteRecv").getComponentInChildren(cc.Label);o&&(o.language=u.i18nHelper.getLanguage(c.LangKey.goldenpass_recv)),this.richTxtDesc.string=h.ComUtils.getLang(c.LangKey.goldenPass_buy_to_unlock_all)},e.prototype.showUnlockSingelTaskFinishReward=function(){this.richTxtDesc.string=h.ComUtils.getLang(c.LangKey.goldenPass_buy_to_unlock)},e.prototype.moreAboutGoldePass=function(){this.moreAbout.string=h.ComUtils.getLang(c.LangKey.more_about_goldenPass)},e.prototype.simpleGoodsPrice=function(){var t=l.DataProxy.getInstance().shopData.getSubsciptGoodsInfo();if(t){var e=this.btnBuy.getComponentInChildren(cc.Layout),o=e.node.getChildByName("lab_price"),i=e.node.getChildByName("lab_desc");o&&(o.getComponent(cc.Label).string=this.getPrice(t[0])+"/"),i&&(i.getComponent(cc.Label).string="Month")}},e.prototype.getPrice=function(t){if(t){var e=t.dwSrcNum/100;return h.ComUtils.getCurrencySymbol(t.dwCurrencyType)+""+e}return""},e.prototype.onClickBuy=function(){cc.log("\u8d2d\u4e70"),this.dispatch(p.Notify.Shop.REQ_BUY_GOLDEN_PASS,s.SubscType.MONTH)},e.prototype.onClickMore=function(){cc.log("\u66f4\u591a"),this.dispatch(r.GuiEvent.PopMsg.DISPLAY_GOLDEN_PASS_SHOP)},e.prototype.onActiveSucc=function(t){t.succ&&this.node.destroy()},a([f({type:cc.Button,tooltip:"\u8d2d\u4e70\u6309\u94ae"})],e.prototype,"btnBuy",void 0),a([f({type:cc.Node,tooltip:"\u5956\u52b1\u7c7b\u578b\u8282\u70b9"})],e.prototype,"ndRewards",void 0),a([f({type:cc.RichText,tooltip:"\u5956\u52b1\u63cf\u8ff0"})],e.prototype,"richTxtDesc",void 0),a([f({type:cc.Label,tooltip:"\u5956\u52b1\u63cf\u8ff0"})],e.prototype,"moreAbout",void 0),a([g],e)}(d.CxComponent);o.default=v,cc._RF.pop()},{"../../../../script/app/const/Global":void 0,"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/language/LanguageCfg":void 0,"../../../../script/app/model/DataProxy":void 0,"../../../../script/lib/base/CxComponent":void 0,"../../../../script/lib/i18n/i18nHelper":void 0,"../../../../script/lib/utils/ComUtils":void 0}],GoldenPassTheme:[function(t,e,o){"use strict";var i;cc._RF.push(e,"6153bw2lDlAAoGIavr+ykRI","GoldenPassTheme"),Object.defineProperty(o,"__esModule",{value:!0}),o.GoldenPassTheme=o.eTheme=void 0;var n,a=t("../../../../script/app/const/Global"),s=t("../../../../script/lib/utils/Logger");(function(t){t[t.default=1]="default",t[t.dining=2]="dining",t[t.olympic=3]="olympic",t[t.boatRace=4]="boatRace",t[t.max=5]="max"})(n=o.eTheme||(o.eTheme={}));var r=((i={})[n.default]="altas/themeDefault/",i[n.dining]="altas/themeDining/",i[n.olympic]="altas/themeOlympic/",i[n.boatRace]="altas/themeBoatRace/",i),p=function(){function t(){this.themeDefaultName="theme",this.init()}return t.prototype.init=function(){},t.prototype.resetSprite=function(t,e,o){var i=this;this.loadSpriteFrameWithAtlas(t,e)||this.loadSpriteFrameWithImage(t,o);var n=t.children;n&&n.length>0&&n.forEach(function(t){i.resetSprite(t,e,o)})},t.prototype.loadSpriteFrameWithAtlas=function(t,e){var o=!1,i=this.getSpriteFrame(t);if(i){var n=i.name,a=e.getSpriteFrame(n);a&&(t.getComponent(cc.Sprite).spriteFrame=a,o=!0)}return o},t.prototype.loadSpriteFrameWithImage=function(t,e){var o=this.getSpriteFrame(t);if(o){var i=o.name;cc.assetManager.loadBundle(a.gAssetBundleName.ACTIVITY_RES,function(o,n){if(o)return cc.error(o);var a=""+e+i;n.load(a,cc.SpriteFrame,function(e,o){o&&cc.isValid(t)&&(cc.log(i+"=======> \u4f7f\u7528\u6563\u56fe"),t.getComponent(cc.Sprite).spriteFrame=o)})})}},t.prototype.getSpriteFrame=function(t){var e=t.getComponent(cc.Sprite);return e&&e.spriteFrame?e.spriteFrame:null},t.prototype.apply=function(t,e,o){if(void 0===o&&(o=this.themeDefaultName),e<n.default||e>=n.max)s.Logger.error("\u672a\u627e\u5230\u76f8\u5e94\u7684\u4e3b\u9898\uff1a"+e);else{var i=r[e],p=""+i+o;cc.log("\u6b63\u5728\u5e94\u7528\u4e3b\u9898"+p);var c=this;cc.assetManager.loadBundle(a.gAssetBundleName.ACTIVITY_RES,function(e,o){if(e)return cc.error(e);o.load(p,cc.SpriteAtlas,function(e,o){o&&cc.isValid(t)?(c.resetSprite(t,o,i),cc.log("\u5e94\u7528\u4e3b\u9898"+p+"\u6210\u529f")):s.Logger.error("[\u52a0\u8f7datlas\u5931\u8d25] atlasPath = "+p)})})}},t}();o.GoldenPassTheme=p,cc._RF.pop()},{"../../../../script/app/const/Global":void 0,"../../../../script/lib/utils/Logger":void 0}],MainActUIConfig:[function(t,e,o){"use strict";cc._RF.push(e,"6e2c3K34gBNZp0CSkzrtoaf","MainActUIConfig");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.MainActResConfig=o.MainActUIConfig=void 0;var a=t("../../../script/app/config/ResConfig"),s=t("../../../script/app/const/Global"),r=t("../../../script/lib/manager/ResManager");o.MainActUIConfig={prefab:{},popup:{GoldenPassShop:new a.PrefabItem("GoldenPassShop","goldenPass/prefabs/GoldenPassShop",s.gLayerLevel.Popup,0),GoldenPassMainView:new a.PrefabItem("GoldenPassMainView","goldenPass/prefabs/GoldenPassMainView",s.gLayerLevel.Popup,0),GoldenPassDailyReward:new a.PrefabItem("GoldenPassDailyReward","goldenPass/prefabs/GoldenPassDailyReward",s.gLayerLevel.Popup,0),GoldenPassRewardPreview:new a.PrefabItem("GoldenPassRewardPreview","goldenPass/prefabs/GoldenPassRewardPreview",s.gLayerLevel.Popup,0),GoldenPassPaySucc:new a.PrefabItem("GoldenPassPaySucc","goldenPass/prefabs/GoldenPassPaySucc",s.gLayerLevel.Popup,0),GoldenPassSimplePay:new a.PrefabItem("GoldenPassSimplePay","goldenPass/prefabs/GoldenPassSimplePay",s.gLayerLevel.Popup,0)},altas:[]};var p=function(t){function e(){var e=t.call(this)||this;return e.name=s.gAssetBundleName.ACTIVITY_RES,e.tips="\u6d3b\u52a8",e.dependency=[],e}return n(e,t),e.prototype.getRes=function(){return o.MainActUIConfig},e}(r.BundleConfig);o.MainActResConfig=p,r.default.getInstance().addBundleCfg(new p),cc._RF.pop()},{"../../../script/app/config/ResConfig":void 0,"../../../script/app/const/Global":void 0,"../../../script/lib/manager/ResManager":void 0}],MianActHandler:[function(t,e){"use strict";cc._RF.push(e,"4a3eaSIbiBODqh0MxuoZ8Mj","MianActHandler"),cc._RF.pop()},{}],SubScribeHandler:[function(t,e,o){"use strict";cc._RF.push(e,"f566c8SKiBI3IKkLbMLGHjb","SubScribeHandler");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.SubScribeHandler=void 0;var a=t("../../../../script/app/base/handler/ProxyHandler"),s=t("../../../../script/plugin/pb/protofile/CMD_SubscribeMsg"),r=t("../../../../script/plugin/pb/protofile/GlobalMsgDef"),p=t("../../../../script/app/event/Notify"),c=t("../../../../script/app/event/GuiEvent"),l=t("../../../../script/app/base/handler/HandlerMgr"),d=t("../../../../script/app/model/DataProxy"),u=t("../../../../script/app/view/ComFunctions"),h=t("../../../../script/app/const/Global"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SERVER_ID=190,e._isRecvFinish=!0,e}return n(e,t),e.prototype.getName=function(){return"SubScribeHandler"},e.prototype.protocolConfig=function(){return[{protocol:s.MSG_SC_RtnRewardList,subid:s.SUBSCRIBE_SUB_MSG.MSG_SC_RTN_REWARD_LIST,cb:this.onRtnBaseInfo},{protocol:s.MSG_SC_RtnRewardListXH,subid:s.SUBSCRIBE_SUB_MSG.MSG_SC_RTN_REWARD_XH_LIST,cb:this.onRtnRewardList},{protocol:s.MSG_SC_ReceiveAward,subid:s.SUBSCRIBE_SUB_MSG.MSG_SC_RECEIVE_AWARD,cb:this.onRtnRecvReward},{protocol:s.MSG_SC_ReceiveAwardUpdate,subid:s.SUBSCRIBE_SUB_MSG.MSG_SC_RECEIVE_AWARD_UPDATE,cb:this.onRtnUpdateView},{protocol:s.MSG_SC_RtnGolenDailyInfo,subid:s.SUBSCRIBE_SUB_MSG.MSG_SC_RTN_GOLDEN_DAILY_INFO,cb:this.onRtnGoldenDailyInfo},{protocol:s.MSG_SC_RtnGolenDailyReward,subid:s.SUBSCRIBE_SUB_MSG.MSG_SC_RTN_GOLDEN_DAILY_REWARD,cb:this.onRtnRecvDailyReward},{protocol:s.MSG_SC_RtnGolenPassInfo,subid:s.SUBSCRIBE_SUB_MSG.MSG_SC_RTN_GOLENPASS_INFO,cb:this.onRtnCupInfo},{protocol:s.MSG_SC_RtnGolenBounsInfo,subid:s.SUBSCRIBE_SUB_MSG.MSG_SC_GET_GOLDEN_BOUNS_INFO,cb:this.onRtnGoldenBonusInfo},{protocol:s.MSG_SC_ResponseRedpoint,subid:s.SUBSCRIBE_SUB_MSG.MSGID_SC_RESPONSE_REDPOINT,cb:this.onRtnGoldenBonusRedpoint}]},e.prototype.initEvent=function(){t.prototype.initEvent.call(this),this.addEvent(p.Notify.Gate.GATE_LOGIN_SUCCESS,this.onGateLoginSucc),this.addEvent(p.Notify.GoldenPass.REQ_INFO,this.sendReqInfo),this.addEvent(p.Notify.GoldenPass.REQ_RECV_REWARD,this.sendRecvReward),this.addEvent(p.Notify.GoldenPass.REQ_DAILY_REWARD,this.sendGetDailyRewardInfo),this.addEvent(p.Notify.GoldenPass.REQ_RECV_DAILY_REWARD,this.sendRecvDailyReward),this.addEvent(p.Notify.GoldenPass.REQ_ACT_ENTRY_INFO,this.sendEntryInfo),this.addEvent(p.Notify.GoldenPass.REQ_GOLDEN_BONUS,this.sendGoldenBonusInfo),this.addEvent(p.Notify.GoldenPass.REQ_GOLDEN_BONUS_REDPOINT,this.sendRedPoint)},e.prototype.onGateLoginSucc=function(){this.requestBaseCfg()},e.prototype.requestBaseCfg=function(){this.dispatch(p.Notify.GoldenPass.REQ_DAILY_REWARD),this.dispatch(p.Notify.GoldenPass.REQ_GOLDEN_BONUS),this.dispatch(p.Notify.GoldenPass.REQ_GOLDEN_BONUS_REDPOINT)},e.prototype.getMainID=function(){return r.MAIN_MSG_ID.MAIN_MSG_SUBSCRIBE_ID},e.prototype.clear=function(){this.removeEvent()},e.prototype.getOtherHead=function(t,e){var o=t,i=void 0===e?o:e,n=new r.Msg_OtherServerHead;return n.dwGameID=o,n.dwGameTypeID=i,n.strUUID=this.userData.sessionId,n},e.prototype.sendReqInfo=function(){cc.log("\u8bf7\u6c42 golden pass \u4fe1\u606f"),this.sendRequest(null,this.getMainID(),s.SUBSCRIBE_SUB_MSG.MSG_CS_GET_REWARD_LIST,this.getOtherHead(this.SERVER_ID))},e.prototype.sendRecvReward=function(t){var e=this;if(this._isRecvFinish){this._isRecvFinish=!1,setTimeout(function(){cc.isValid(e)&&(e._isRecvFinish=!0)},1e3);var o=new s.MSG_CS_ReceiveAward;o.dwId=t.id,o.dwType=t.tp,cc.log("\u8bf7\u6c42\u9886\u53d6\u5956\u52b1",o),this.sendRequest(o,this.getMainID(),s.SUBSCRIBE_SUB_MSG.MSG_CS_RECEIVE_AWARD,this.getOtherHead(this.SERVER_ID))}},e.prototype.sendRecvDailyReward=function(){this.sendRequest(null,this.getMainID(),s.SUBSCRIBE_SUB_MSG.MSG_CS_GET_GOLDEN_DAILY_REWARD,this.getOtherHead(this.SERVER_ID))},e.prototype.sendGetDailyRewardInfo=function(){this.sendRequest(null,this.getMainID(),s.SUBSCRIBE_SUB_MSG.MSG_CS_GET_GOLDEN_DAILY_INFO,this.getOtherHead(this.SERVER_ID))},e.prototype.sendEntryInfo=function(){this.sendRequest(null,this.getMainID(),s.SUBSCRIBE_SUB_MSG.MSG_CS_GET_GOLENPASS_INFO,this.getOtherHead(this.SERVER_ID))},e.prototype.sendGoldenBonusInfo=function(){cc.log("\u8bf7\u6c42golden bonus \u6570\u636e"),this.sendRequest(null,this.getMainID(),s.SUBSCRIBE_SUB_MSG.MSG_CS_GET_GOLDEN_BOUNS_INFO,this.getOtherHead(this.SERVER_ID))},e.prototype.sendRedPoint=function(){cc.log("\u8bf7\u6c42golden bonus \u7ea2\u70b9");var t=new s.MSG_CS_RedPoint;t.dwId=s.RedPointType.GOLDEN_BONUS,this.sendRequest(t,this.getMainID(),s.SUBSCRIBE_SUB_MSG.MSGID_CS_SHOWT_REDPOINT,this.getOtherHead(this.SERVER_ID))},e.prototype.onRtnBaseInfo=function(t){var e=t.data;cc.log("goldpass \u57fa\u672c\u6570\u636e",e),d.DataProxy.getInstance().glodenPassData.setBaseInfo(e),this.dispatch(p.Notify.GoldenPass.RESP_INFO,e)},e.prototype.onRtnRewardList=function(t){var e=t.data;if(cc.log("goldpass \u5217\u8868\u6570\u636e",e),e.tabReward.forEach(function(t){d.DataProxy.getInstance().glodenPassData.pushTempData(t)}),e.bEnd){var o=d.DataProxy.getInstance().glodenPassData.toCompleteData();this.dispatch(p.Notify.GoldenPass.RESP_LIST_INFO,o)}},e.prototype.onRtnRecvReward=function(t){this._isRecvFinish=!0;var e=t.data;cc.log("goldpass \u9886\u53d6\u6570\u636e",e);var o={};o.dwError=e.bError,o.rewardList=u.ComFunctions.parseTableReward(e.reward),o.chipList=u.ComFunctions.parseChipArray(e.tabChips),this.dispatch(p.Notify.GoldenPass.RESP_RECV_REWARD,{body:e,parseData:o})},e.prototype.onRtnUpdateView=function(){},e.prototype.onRtnGoldenDailyInfo=function(t){var e=t.data;cc.log("\u6bcf\u65e5\u5956\u52b1\u4fe1\u606f",e),d.DataProxy.getInstance().glodenPassData.setDailyReward(e),this.dispatch(c.GuiEvent.PopMsg.DISPLAY_GOLDEN_PASS_DAILY_REWARD,e)},e.prototype.onRtnRecvDailyReward=function(t){var e=t.data;cc.log("\u9886\u53d6\u6bcf\u65e5\u5956\u52b1",e);var o={};if(o.dwError=e.bError,o.rewardList=u.ComFunctions.parseTableReward(e.reward),this.dispatch(p.Notify.GoldenPass.RESP_RECV_DAILY_REWARD,{body:e,parseData:o}),this.dispatch(p.Notify.GoldenPass.REQ_GOLDEN_BONUS),e.reward&&e.reward[0]){var i=e.reward[0].dwNum;cc.log("\u64ad\u653e\u6bcf\u65e5\u5956\u52b1\u52a8\u753b",i),i&&this.dispatch(c.GuiEvent.Anim.COM_AWARD_ANIM,{awardNum:i,scene:h.gSceneType.Lobby,mask:!0})}},e.prototype.onRtnCupInfo=function(t){var e=t.data;cc.log("\u5165\u53e3\u4fe1\u606f",e),d.DataProxy.getInstance().glodenPassData.setEntryData(e),this.dispatch(p.Notify.GoldenPass.RESP_GOLDENPASS_ENTRY_INFO,e)},e.prototype.onRtnGoldenBonusInfo=function(t){var e=t.data;cc.log("\u8fd4\u56degolden bonus\u4fe1\u606f",e),d.DataProxy.getInstance().glodenPassData.setGoldenBonusData(e),this.dispatch(p.Notify.GoldenPass.RESP_GOLDEN_BONUS,e)},e.prototype.onRtnGoldenBonusRedpoint=function(t){var e=t.data;cc.log("\u8fd4\u56degolden bonus \u7ea2\u70b9",e),d.DataProxy.getInstance().glodenPassData.setRedPoint(e),this.dispatch(p.Notify.GoldenPass.RESP_GOLDEN_BONUS_REDPOINT,e)},e}(a.ProxyHandler);o.SubScribeHandler=y,l.HandlerMgr.getInstance().addSubHandler(new y),cc._RF.pop()},{"../../../../script/app/base/handler/HandlerMgr":void 0,"../../../../script/app/base/handler/ProxyHandler":void 0,"../../../../script/app/const/Global":void 0,"../../../../script/app/event/GuiEvent":void 0,"../../../../script/app/event/Notify":void 0,"../../../../script/app/model/DataProxy":void 0,"../../../../script/app/view/ComFunctions":void 0,"../../../../script/plugin/pb/protofile/CMD_SubscribeMsg":void 0,"../../../../script/plugin/pb/protofile/GlobalMsgDef":void 0}]},{},["MianActHandler","MainActUIConfig","SubScribeHandler","GoldenPassDailyReward","GoldenPassGrid","GoldenPassItem","GoldenPassListView","GoldenPassMainView","GoldenPassPaySucc","GoldenPassRewardPreview","GoldenPassShop","GoldenPassShopCell","GoldenPassSimplePay","GoldenPassTheme"]);